<?xml version="1.0" encoding="utf-8" ?>
<SqlConfig>
  <Contents>
    <Content Key="GetReportList" Desc="获取报表列表" DataBaseType="SqlServer">
      SELECT distinct R.ID,R.PARENTID,R.REPORTNAME
      from AC_User U WITH (NOLOCK) INNER JOIN AC_RoleUser RU WITH (NOLOCK) ON U.ID = RU.UserID
      INNER JOIN AC_RolePrivilege RP WITH (NOLOCK) ON RU.RoleID = RP.RoleID
      INNER JOIN AC_Privilege P WITH (NOLOCK) ON RP.PrivilegeID = P.ID
      INNER JOIN ReportList R WITH (NOLOCK) ON (R.PermissionCode = P.Code or R.PermissionCode is null)
      WHERE U.ID = '{0}'
    </Content>
    <Content Key="GetReportList" Desc="获取报表列表" DataBaseType="Oracle">
      SELECT distinct R.ID,R.PARENTID,R.REPORTNAME
      from AC_User U  INNER JOIN AC_RoleUser RU ON U.ID = RU.UserID
      INNER JOIN AC_RolePrivilege RP  ON RU.RoleID = RP.RoleID
      INNER JOIN AC_Privilege P  ON RP.PrivilegeID = P.ID
      INNER JOIN ReportList R  ON (R.PermissionCode = P.Code or R.PermissionCode is null)
      WHERE U.ID = '{0}'
    </Content>
	  <Content Key="ReportTotalStorageQueryForProvide" Desc="查询库存统计" DataBaseType="SqlServer">
      SELECT
      '总库存' as CARGOTYPETEXT,
      SUM(QUANTITY) AS  QTY -- 数量
      FROM View_StorageList AS StorageList with (nolock)
      LEFT JOIN CargoType AS CargoType with (nolock)
      ON StorageList.CargoTypeID = CargoType.CargoTypeID
      WHERE Quantity>0
      AND (CargoType.CargoTopType = 16 AND STATUS in (50,60))
      {0}
    </Content>
	  <Content Key="ReportTotalStorageQueryForProvide" Desc="查询库存统计" DataBaseType="Oracle">
      SELECT
      '总库存' as CARGOTYPETEXT,
      SUM(QUANTITY) AS  QTY -- 数量
      FROM View_StorageList   StorageList
      LEFT JOIN CargoType  CargoType
      ON StorageList.CargoTypeID = CargoType.CargoTypeID
      WHERE Quantity>0
      AND (CargoType.CargoTopType = 16 AND STATUS in (50,60))
      {0}
    </Content>
	  <Content Key="ReportCurStorageQueryForProvide" Desc="查询库存统计" DataBaseType="SqlServer">
      SELECT
      '当前库存' as CARGOTYPETEXT,
      SUM(QUANTITY) AS  QTY -- 数量
      FROM View_StorageList AS StorageList with (nolock)
      LEFT JOIN CargoType AS CargoType with (nolock)
      ON StorageList.CargoTypeID = CargoType.CargoTypeID
      WHERE Quantity>0
      AND (CargoType.CargoTopType = 16 AND STATUS in (50,60))
      {0}
    </Content>
	  <Content Key="ReportCurStorageQueryForProvide" Desc="查询库存统计" DataBaseType="Oracle">
      SELECT
      '当前库存' as CARGOTYPETEXT,
      SUM(QUANTITY) AS  QTY -- 数量
      FROM View_StorageList   StorageList
      LEFT JOIN CargoType  CargoType
      ON StorageList.CargoTypeID = CargoType.CargoTypeID
      WHERE Quantity>0
      AND (CargoType.CargoTopType = 16 AND STATUS in (50,60))
      {0}
    </Content>
    <Content Key="ReportRecycleSummary" Desc="回收统计" DataBaseType="SqlServer">
      --回收统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      case when ISNULL(fpi.ApplianceQty,0)>0 then fpi.ApplianceQty else CargoType.InstrumentsNumber end AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      left join FlowPackageIn fpi on FlowPackageList.FPackageID=fpi.FPackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
    </Content>
    <Content Key="ReportRecycleSummary" Desc="回收统计" DataBaseType="Oracle">
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      case when nvl(fpi.ApplianceQty,0)>0 then fpi.ApplianceQty else CargoType.InstrumentsNumber end AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      left join FlowPackageIn fpi on FlowPackageList.FPackageID=fpi.FPackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org   RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup   RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup  SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
    </Content>
    <Content Key="ReportRecycleSummary_BDYY" Desc="北大医院回收统计" DataBaseType="SqlServer">
      --回收统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecyclePreOrg.Name AS RECYCLEPREORGTEXT,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      case when ISNULL(fpi.ApplianceQty,0)>0 then fpi.ApplianceQty else CargoType.InstrumentsNumber end AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      left join FlowPackageIn fpi on FlowPackageList.FPackageID=fpi.FPackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_Org AS RecyclePreOrg ON RecycleOrg.PrevID = RecyclePreOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
    </Content>
	  <Content Key="ReportRecycleLostInstrumentSummary" Desc="回收统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      RecycleUser.FNAMES as RECYCLEUSERNAME,
      SenderUser.FNAMES as SENDERUSERNAME,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      ct.CargoTypeName as QXCARGOTYPETEXT,
      SUM(FlowRecycleLostList.Quantity) as QTY,
      ct.amount as PRICE,
      SUM(FlowRecycleLostList.Quantity)*ct.amount as TOTALPRICE
      FROM FlowRecycleLostList inner join FlowRecycle
      on FlowRecycleLostList.FRecycleID=FlowRecycle.FRecycleID
      inner join  FlowRecycleList
      on FlowRecycleLostList.FRecycleID=FlowRecycleList.FRecycleID   and FlowRecycleLostList.PackageID=FlowRecycleList.PackageID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org   RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup   RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup  SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      left join CargoType ct on ct.CargoTypeID=FlowRecycleLostList.CargoTypeID
      WHERE 1 = 1 {0}
      group by Warehouse.OrgID,RecycleOrg.Name,RecycleUser.FNAMES,
      SenderUser.FNAMES,
      FlowPackageList.CargoTypeID,
      ct.amount,
      CK.KindName,
      CargoType.CargoTypeName,
      ct.CargoTypeName
    </Content>
	  <Content Key="ReportRecycleLostInstrumentSummary" Desc="回收统计" DataBaseType="Oracle">
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      RecycleUser.FNAMES as RECYCLEUSERNAME,
      SenderUser.FNAMES as SENDERUSERNAME,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      ct.CargoTypeName as QXCARGOTYPETEXT,
      SUM(FlowRecycleLostList.Quantity) as QTY,
      ct.amount as PRICE,
      SUM(FlowRecycleLostList.Quantity)*ct.amount as TOTALPRICE
      FROM FlowRecycleLostList inner join FlowRecycle
      on FlowRecycleLostList.FRecycleID=FlowRecycle.FRecycleID
      inner join  FlowRecycleList
      on FlowRecycleLostList.FRecycleID=FlowRecycleList.FRecycleID   and FlowRecycleLostList.PackageID=FlowRecycleList.PackageID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org   RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup   RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup  SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      left join CargoType ct on ct.CargoTypeID=FlowRecycleLostList.CargoTypeID
      WHERE 1 = 1 {0}
      group by Warehouse.OrgID,RecycleOrg.Name,RecycleUser.FNAMES,
      SenderUser.FNAMES,
      FlowPackageList.CargoTypeID,
      ct.amount,
      CK.KindName,
      CargoType.CargoTypeName,
      ct.CargoTypeName
    </Content>
    <Content Key="ReportDisinfectSummary" Desc="清洗统计" DataBaseType="SqlServer">
      --清洗统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      case DEVICENAME when '人工清洗' then '人工清洗'  else '自动清洗' end as DISINFECTTYPE,
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT, --种类
      CK.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品、器械包
      OpUser.name OPNAME,
      SUM(1) AS RECYCLEQTY,
      isnull(CargoType.InstrumentsNumber,0) * sum(1) AS INSTRUMENTSNUMBER
      ,Devices.DeviceName DEVICENAME
      FROM
      FlowDisinfect fd
      LEFT JOIN FlowDisinfectContainerList fdc on fd.FDisinfectID=fdc.FDisinfectID
      LEFT JOIN FlowRecycleList ON fdc.FRecycleID=FlowRecycleList.FRecycleID
      LEFT JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      LEFT JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN DEVICESUSELOG  ON DevicesUseLog.LOGID=fd.LogID
      LEFT JOIN Devices ON DevicesUseLog.DeviceID=Devices.DeviceID
      LEFT JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      LEFT JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org  RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup  RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      left join ac_user  OpUser on opuser.ID=DEVICESUSELOG.UserID
      WHERE 1 = 1 {0}
      GROUP BY
      Devices.DeviceName,
      RecycleOrg.Name,Warehouse.OrgID,CST.TypeName
      ,CK.KindName,CargoType.CargoTypeName,FlowPackageList.CargoTypeID,OpUser.name,CargoType.InstrumentsNumber
    </Content>

    <Content Key="ReportDisinfectSummary" Desc="清洗统计" DataBaseType="Oracle">
      SELECT
      case DEVICENAME when '人工清洗' then '人工清洗'  else '自动清洗' end as DISINFECTTYPE,
      Warehouse.OrgID  RECYCLEORG,
      RecycleOrg.Name  RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT, --种类
      CK.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品、器械包
      OpUser.name OPNAME,
      SUM(1)  RECYCLEQTY,
      nvl(CargoType.InstrumentsNumber,0) * sum(1) AS INSTRUMENTSNUMBER
      ,Devices.DeviceName DEVICENAME
      FROM
      FlowDisinfect fd
      left join FlowDisinfectContainerList fdc on fd.FDisinfectID=fdc.FDisinfectID
      LEFT JOIN FlowRecycleList ON fdc.FRecycleID=FlowRecycleList.FRecycleID
      LEFT JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      LEFT JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN DEVICESUSELOG  ON DevicesUseLog.LOGID=fd.LogID
      LEFT JOIN Devices ON DevicesUseLog.DeviceID=Devices.DeviceID
      LEFT JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      LEFT JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      LEFT JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org  RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup  RecycleUser  ON FlowRecycle.OPID = RecycleUser.FID
      left join ac_user  OpUser on opuser.ID=DEVICESUSELOG.UserID
      WHERE 1 = 1 {0}
      GROUP BY
      Devices.DeviceName,
      RecycleOrg.Name,Warehouse.OrgID,CST.TypeName
      ,CK.KindName,CargoType.CargoTypeName,FlowPackageList.CargoTypeID,OpUser.name,CargoType.InstrumentsNumber
    </Content>

    <Content Key="ReportPackageSummary" Desc="配包统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      FlowPackage.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT, --种类
      CK.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品、器械包
      PackageType.PName AS OUTPACKING,--外包装
      PackageUser.FNames OPNAME,
      COUNT(FlowPackageList.StorageID) AS PACKAGEQTY
      ,pcl.FName as PackageFLevel
      ,stp.TypeName SterilizationMethod
      FROM FlowPackageList WITH (NOLOCK)
      INNER JOIN
      (
      select FPackageID,CargoTypeID,PackageDate,opid,FlowOrgID from FLOWPACKAGE
      /*union all
      select FPackageID,CargoTypeID,PackageInDate,opid,FlowOrgID from FLOWPACKAGEin*/
      ) as FlowPackage
      on FlowPackageList.FPackageID = FlowPackage.FPackageID
      left JOIN PackageType on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN CargoType ON FlowPackage.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      LEFT JOIN AC_WorkGroup  PackageUser ON FlowPackage.OPID = PackageUser.FID
      LEFT JOIN AC_WorkGroup  CheckUser ON FlowPackageList.CheckID = CheckUser.FID

      left join PackageCostLevel pcl on CargoType.FLevel=pcl.FID
      left join FlowSterilizationList fsl on FlowPackageList.PackageID=fsl.PackageID
      left join DevicesUseLog dul on fsl.SterilizationLogID=dul.LogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join SystemTypeParameter stp on d.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
      WHERE 1 = 1
      {0}
      GROUP BY
      CST.TypeName
      ,CK.KindName,CargoType.CargoTypeName
      ,FlowPackage.CargoTypeID,PackageType.PName
      ,pcl.FName
      ,stp.TypeName,PackageUser.FNames
    </Content>
    <Content Key="ReportPackageSummary" Desc="配包统计" DataBaseType="Oracle">
      SELECT
      FlowPackage.CargoTypeID CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT, --种类
      CK.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品、器械包
      PackageType.PName  OUTPACKING,
      PackageUser.FNames OPNAME,
      COUNT(FlowPackageList.StorageID)  PACKAGEQTY
      ,pcl.FName as PackageFLevel
      ,stp.TypeName SterilizationMethod
      FROM FlowPackageList
      INNER JOIN
      (
      select FPackageID,CargoTypeID,PackageDate,opid,FlowOrgID from FLOWPACKAGE
      /*union all
      select FPackageID,CargoTypeID,PackageInDate,opid,FlowOrgID from FLOWPACKAGEin*/
      )   FlowPackage
      on FlowPackageList.FPackageID = FlowPackage.FPackageID
      left JOIN PackageType on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN CargoType ON FlowPackage.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      LEFT JOIN AC_WorkGroup  PackageUser ON FlowPackage.OPID = PackageUser.FID
      LEFT JOIN AC_WorkGroup  CheckUser ON FlowPackageList.CheckID = CheckUser.FID

      left join PackageCostLevel pcl on CargoType.FLevel=pcl.FID
      left join FlowSterilizationList fsl on FlowPackageList.PackageID=fsl.PackageID
      left join DevicesUseLog dul on fsl.SterilizationLogID=dul.LogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join SystemTypeParameter stp on d.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
      WHERE 1 = 1
      {0}
      GROUP BY
      CST.TypeName
      ,CK.KindName,CargoType.CargoTypeName
      ,FlowPackage.CargoTypeID,PackageType.PName
      ,pcl.FName
      ,stp.TypeName,PackageUser.FNames
    </Content>

    <Content Key="ReportPackageTotal" Desc="配包统计报表" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      FlowPackage.CargoTypeID AS CARGOTYPEID,
      CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
      CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
      isnull(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      PackageType.PName AS OUTPACKING,--外包装
      COUNT(1) AS PACKAGEQTY,
      0 AS CHECKQTY,
      isnull(CargoType.InstrumentsNumber,0) * COUNT(1) AS PACKAGEINSTRUMENTSNUMBER,
      0 AS CHECKINSTRUMENTSNUMBER,
      PackageUser.FNames AS NAME
      FROM FlowPackageList WITH (NOLOCK)
      INNER JOIN
      (
      select FPackageID,CargoTypeID,PackageDate,opid,FlowOrgID from FLOWPACKAGE
      /*union all
      select FPackageID,CargoTypeID,PackageInDate,opid,FlowOrgID from FLOWPACKAGEin*/
      ) as FlowPackage on FlowPackageList.FPackageID = FlowPackage.FPackageID
      left JOIN PackageType WITH (NOLOCK)  on FlowPackageList.packagetypeid = PackageType.PTypeID
      left JOIN view_CargoType AS CargoType WITH (NOLOCK) ON FlowPackage.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN AC_WorkGroup AS PackageUser WITH (NOLOCK) ON FlowPackage.OPID = PackageUser.FID
      WHERE 1 = 1
      {0}
      GROUP BY
      CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,FlowPackage.CargoTypeID,PackageType.PName,CargoType.InstrumentsNumber,PackageUser.FNames
      Union ALL
      SELECT
      FlowPackage.CargoTypeID AS CARGOTYPEID,
      CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
      CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
      isnull(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      PackageType.PName AS OUTPACKING,--外包装
      0 AS PACKAGEQTY,
      COUNT(1) AS CHECKQTY,
      0 AS PACKAGEINSTRUMENTSNUMBER,
      isnull(CargoType.InstrumentsNumber,0) * COUNT(1) AS CHECKINSTRUMENTSNUMBER,
      CheckUser.FNames AS NAME
      FROM FlowPackageList WITH (NOLOCK)
      INNER JOIN
      (
      select FPackageID,CargoTypeID,PackageDate,opid,FlowOrgID from FLOWPACKAGE
      /*union all
      select FPackageID,CargoTypeID,PackageInDate,opid,FlowOrgID from FLOWPACKAGEin*/
      ) as FlowPackage  on FlowPackageList.FPackageID = FlowPackage.FPackageID
      left JOIN PackageType WITH (NOLOCK)  on FlowPackageList.packagetypeid = PackageType.PTypeID
      left JOIN view_CargoType AS CargoType WITH (NOLOCK) ON FlowPackage.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN AC_WorkGroup AS CheckUser WITH (NOLOCK) ON FlowPackageList.CheckID = CheckUser.FID
      WHERE 1 = 1
      {1}
      GROUP BY
      CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,FlowPackage.CargoTypeID,PackageType.PName,CargoType.InstrumentsNumber,CheckUser.FNames
    </Content>
    <Content Key="ReportPackageTotal" Desc="配包统计报表" DataBaseType="Oracle">
      SELECT
      FlowPackage.CargoTypeID AS CARGOTYPEID,
      CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
      CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
      nvl(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      PackageType.PName AS OUTPACKING,--外包装
      COUNT(1) AS PACKAGEQTY,
      0 AS CHECKQTY,
      nvl(CargoType.InstrumentsNumber,0) * COUNT(1) AS PACKAGEINSTRUMENTSNUMBER,
      0 AS CHECKINSTRUMENTSNUMBER,
      PackageUser.FNames AS NAME
      FROM FlowPackageList
      INNER JOIN
      (
      select FPackageID,CargoTypeID,PackageDate,opid,FlowOrgID from FLOWPACKAGE
      /*union all
      select FPackageID,CargoTypeID,PackageInDate,opid,FlowOrgID from FLOWPACKAGEin*/
      )  FlowPackage
      on FlowPackageList.FPackageID = FlowPackage.FPackageID
      left JOIN PackageType   on FlowPackageList.packagetypeid = PackageType.PTypeID
      left JOIN view_CargoType  CargoType  ON FlowPackage.CargoTypeID = CargoType.CargoTypeID
      --INNER JOIN AC_User  PackageUser  ON FlowPackage.OPID = PackageUser.ID
      INNER JOIN AC_WorkGroup PackageUser ON FlowPackage.OPID = PackageUser.FID
      WHERE 1 = 1
      {0}
      GROUP BY
      CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,FlowPackage.CargoTypeID,PackageType.PName,CargoType.InstrumentsNumber,PackageUser.FNames
      Union ALL
      SELECT
      FlowPackage.CargoTypeID AS CARGOTYPEID,
      CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
      CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
      nvl(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      PackageType.PName AS OUTPACKING,--外包装
      0 AS PACKAGEQTY,
      COUNT(1) AS CHECKQTY,
      0 AS PACKAGEINSTRUMENTSNUMBER,
      nvl(CargoType.InstrumentsNumber,0) * COUNT(1) AS CHECKINSTRUMENTSNUMBER,
      CheckUser.FNames AS NAME
      FROM FlowPackageList
      INNER JOIN
      (
      select FPackageID,CargoTypeID,PackageDate,opid,FlowOrgID from FLOWPACKAGE
      /*union all
      select FPackageID,CargoTypeID,PackageInDate,opid,FlowOrgID from FLOWPACKAGEin*/
      )  FlowPackage
      on FlowPackageList.FPackageID = FlowPackage.FPackageID
      left JOIN PackageType on FlowPackageList.packagetypeid = PackageType.PTypeID
      left JOIN view_CargoType  CargoType  ON FlowPackage.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN AC_WorkGroup  CheckUser  ON FlowPackageList.CheckID = CheckUser.FID
      WHERE 1 = 1
      {1}
      GROUP BY
      CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,FlowPackage.CargoTypeID,PackageType.PName,CargoType.InstrumentsNumber,CheckUser.FNames
    </Content>
    <Content Key="ReportSterilizeSummary" Desc="灭菌统计" DataBaseType="SqlServer">
      --灭菌统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      DevicesUseLog.BeginDate BDATE,
      SterilizaUser.Fnames as FNAMES,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
      CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
      PackageType.PName AS OUTPACKING,--外包装
      COUNT(FlowPackageList.PackageID) AS STERILIZATIONQTY
      ,Devices.DeviceName DEVICENAME
      FROM FlowSterilizationList WITH (NOLOCK)
      LEFT JOIN DevicesUseLog WITH (NOLOCK) on FlowSterilizationList.SterilizationLogID=DevicesUseLog.LogID
      LEFT JOIN Devices ON DevicesUseLog.DeviceID=Devices.DeviceID
      LEFT JOIN FlowPackageList WITH (NOLOCK) ON FlowSterilizationList.PackageID = FlowPackageList.PackageID
      LEFT JOIN PackageType WITH (NOLOCK)  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN view_CargoType AS CargoType WITH (NOLOCK) ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN AC_WorkGroup  SterilizaUser  ON DevicesUseLog.UserID = SterilizaUser.FID
      LEFT JOIN AC_WorkGroup  SterilizaChecker  ON DevicesUseLog.CheckID = SterilizaChecker.FID
      WHERE  Devices.DeviceType IN(4,5,6) {0}
      GROUP BY
      DevicesUseLog.BeginDate,
      SterilizaUser.Fnames,
      CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,FlowPackageList.CargoTypeID,PackageType.PName,Devices.DeviceName

    </Content>
    <Content Key="ReportSterilizeSummary" Desc="灭菌统计" DataBaseType="Oracle">
      SELECT
      DevicesUseLog.BeginDate BDATE,
      SterilizaUser.Fnames   FNAMES,
      FlowPackageList.CargoTypeID CARGOTYPEID,
      CargoType.CargoTopTypeText CARGOTOPTYPETEXT,
      CargoType.CargoTypeKindText CARGOTYPEKINDTEXT,
      CargoType.CargoTypeText CARGOTYPETEXT,
      PackageType.PName  OUTPACKING,
      COUNT(FlowPackageList.PackageID)  STERILIZATIONQTY
      ,Devices.DeviceName DEVICENAME
      FROM FlowSterilizationList
      LEFT JOIN DevicesUseLog   on FlowSterilizationList.SterilizationLogID=DevicesUseLog.LogID
      LEFT JOIN Devices ON DevicesUseLog.DeviceID=Devices.DeviceID
      LEFT JOIN FlowPackageList ON FlowSterilizationList.PackageID = FlowPackageList.PackageID
      LEFT JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN view_CargoType  CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN AC_WorkGroup  SterilizaUser  ON DevicesUseLog.UserID = SterilizaUser.FID
      LEFT JOIN AC_WorkGroup  SterilizaChecker  ON DevicesUseLog.CheckID = SterilizaChecker.FID
      WHERE  Devices.DeviceType IN(4,5,6) {0}
      GROUP BY
      DevicesUseLog.BeginDate,
      SterilizaUser.Fnames,
      CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,FlowPackageList.CargoTypeID,PackageType.PName,Devices.DeviceName
    </Content>
    <Content Key="ReportSterilizeSummary_CZ" Desc="灭菌统计报表" DataBaseType="SqlServer">
		--灭菌统计
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		SELECT
		Devices.DeviceName AS DEVICENAME,
		DevicesUseLog.UseTimes AS USETIMES,
		DevicesUseLog.TodayUseTimes AS TODAYUSETIMES,
		CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
		CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
		CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
		PackageType.PName AS OUTPACKING,--外包装
		StorageList.Barcode AS BARCODE
		FROM FlowSterilizationList
		inner JOIN DevicesUseLog on FlowSterilizationList.SterilizationLogID=DevicesUseLog.LogID
		inner JOIN Devices ON DevicesUseLog.DeviceID = Devices.DeviceID
		inner JOIN FlowPackageList ON FlowSterilizationList.PackageID = FlowPackageList.PackageID
		inner JOIN StorageList ON  FlowPackageList.StorageID = StorageList .StorageID
		LEFT JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
		LEFT JOIN view_CargoType AS CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
		LEFT JOIN AC_WorkGroup  SterilizaUser  ON DevicesUseLog.UserID = SterilizaUser.FID
		LEFT JOIN AC_WorkGroup  SterilizaChecker  ON DevicesUseLog.CheckID = SterilizaChecker.FID
		WHERE  Devices.DeviceType IN(4,5,6) {0}
		ORDER BY DeviceName,UseTimes,TodayUseTimes,CargoTopTypeText,CargoTypeKindText,CargoTypeText,OUTPACKING
	</Content>
    <Content Key="ReportSterilizeSummary_CZ" Desc="灭菌统计报表" DataBaseType="Oracle">
		SELECT
		Devices.DeviceName AS DeviceName,
		DevicesUseLog.UseTimes AS UseTimes,
		DevicesUseLog.TodayUseTimes AS TodayUseTimes,
		CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
		CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
		CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品、器械包
		PackageType.PName AS OUTPACKING,--外包装
		StorageList.Barcode AS BarCode
		FROM FlowSterilizationList
		inner JOIN DevicesUseLog   on FlowSterilizationList.SterilizationLogID=DevicesUseLog.LogID
		inner JOIN Devices   ON DevicesUseLog.DeviceID = Devices.DeviceID
		inner JOIN FlowPackageList  ON FlowSterilizationList.PackageID = FlowPackageList.PackageID
		inner JOIN StorageList  ON  FlowPackageList.StorageID = StorageList .StorageID
		LEFT JOIN PackageType    on FlowPackageList.packagetypeid = PackageType.PTypeID
		LEFT JOIN view_CargoType    CargoType   ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
		LEFT JOIN AC_WorkGroup  SterilizaUser  ON DevicesUseLog.UserID = SterilizaUser.FID
		LEFT JOIN AC_WorkGroup  SterilizaChecker  ON DevicesUseLog.CheckID = SterilizaChecker.FID
		WHERE  Devices.DeviceType IN(4,5,6) {0}
		ORDER BY DeviceName,UseTimes,TodayUseTimes,CargoTopTypeText,CargoTypeKindText,CargoTypeText,OUTPACKING
	</Content>
    <Content Key="ReportProvideMaterialSummaryPriceUseInLocation" Desc="发放一次性物品统计（一次性物品价格取入库的单价）" DataBaseType="SqlServer">
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		SELECT
		StorageOut.OutDate OUTDATE,
		Area.Name AS AREATEXT, --区域
		Location.LOCATIONNAME,
		CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
		CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
		CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
		CargoType.MinUnit MINUNIT,
		CargoType.Unit UNIT,
		CargoType.incode INCODE,
		SUM(SOLSL.Quantity) AS QTY,--数量
		ISNULL(StorageList.Price,0.00) AS UNITPRICE,--单价
		ISNULL(StorageList.Price,0.00) * SUM(SOLSL.Quantity) AS TOTALPRICE --总价
		,(select ISNULL(SUM(st.Quantity),0)
		FROM  StorageList st
		WHERE st.Quantity>0
		AND st.WarehouseID = StorageOut.WarehouseID and st.cargotypeid=StorageOutList.cargotypeid
		AND st.EXPDate>CONVERT(varchar(10),GETDATE(),120)
		GROUP BY
		st.CargoTypeID
		)  SHENGQTY
		,StorageList.LotNumber LOTNUMBER
		,StorageOutList.CARGOTYPEID
		FROM StorageOutList WITH (NOLOCK)
		INNER JOIN StorageOut WITH (NOLOCK)  on StorageOut.OutID = StorageOutList.OutID
		INNER JOIN StorageOutListStorageList SOLSL  WITH (NOLOCK)  on StorageOutList.Outlistid= SOLSL.Outlistid
		LEFT JOIN StorageList  WITH (NOLOCK)   on StorageList.StorageID = SOLSL.StorageID
		LEFT JOIN AC_ORG AS Area WITH (NOLOCK)  on StorageOut.OrgID = Area.ID
		LEFT JOIN CargoType WITH (NOLOCK)  on StorageList.CargoTypeID = CargoType.CargoTypeID
		LEFT JOIN CargoTypeKind WITH (NOLOCK) ON CargoType.CargoTypeKind = CargoTypeKind.ID
		LEFT JOIN SystemTypeParameter AS CargoTopType WITH (NOLOCK) ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
		LEFT JOIN AC_WorkGroup AS ProvideUser WITH (NOLOCK) on StorageOut.OPID = ProvideUser.FID
		LEFT JOIN AC_WorkGroup AS RecipientUser WITH (NOLOCK) on StorageOut.RECIPIENTID = RecipientUser.FID
		LEFT JOIN Location WITH (NOLOCK) on StorageOutList.LocationID = Location.LocationID
		Where OutType = 6  {0} -- 可能需要震泽及其下属所有科室
		Group By
		Area.Name,
		StorageOut.WarehouseID,StorageOutList.cargotypeid,
		Location.LOCATIONNAME,
		CargoTopType.TypeName,
		CargoTypeKind.KindName,
		CargoType.CargoTypeName,
		CargoType.MinUnit,
		CargoType.Unit,CargoType.incode,
		StorageOut.OutDate,StorageList.Price,StorageList.Quantity,StorageList.LotNumber
		Order By StorageOut.OutDate DESC
	</Content>
    <Content Key="ReportProvideMaterialSummaryPriceUseInLocation" Desc="发放一次性物品统计（一次性物品价格取入库的单价）" DataBaseType="Oracle">
		SELECT
		StorageOut.OutDate OUTDATE,
		Area.Name AS AREATEXT, --区域
		Location.LOCATIONNAME,
		CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
		CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
		CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
		CargoType.MinUnit MINUNIT,
		CargoType.Unit UNIT,
		CargoType.incode INCODE,
		SUM(SOLSL.Quantity) AS QTY,--数量
		nvl(StorageList.Price,0.00) AS UNITPRICE,--单价
		nvl(StorageList.Price,0.00) * SUM(SOLSL.Quantity) AS TOTALPRICE --总价
		,(select nvl(SUM(st.Quantity),0)
		FROM  StorageList st
		WHERE st.Quantity>0
		AND st.WarehouseID = StorageOut.WarehouseID and st.cargotypeid=StorageOutList.cargotypeid
		AND  to_char(st.EXPDate,'yyyy-mm-dd')>to_char(sysdate,'yyyy-mm-dd')
		GROUP BY
		st.CargoTypeID
		)  SHENGQTY
		,StorageList.LotNumber LOTNUMBER
		,StorageOutList.CARGOTYPEID
		FROM StorageOutList
		INNER JOIN StorageOut  on StorageOut.OutID = StorageOutList.OutID
		INNER JOIN StorageOutListStorageList SOLSL on StorageOutList.Outlistid= SOLSL.Outlistid
		LEFT JOIN StorageList on StorageList.StorageID = SOLSL.StorageID
		LEFT JOIN AC_ORG  Area   on StorageOut.OrgID = Area.ID
		LEFT JOIN CargoType   on StorageList.CargoTypeID = CargoType.CargoTypeID
		LEFT JOIN CargoTypeKind  ON CargoType.CargoTypeKind = CargoTypeKind.ID
		LEFT JOIN SystemTypeParameter  CargoTopType  ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
		LEFT JOIN AC_WorkGroup  ProvideUser  on StorageOut.OPID = ProvideUser.FID
		LEFT JOIN AC_WorkGroup  RecipientUser  on StorageOut.RECIPIENTID = RecipientUser.FID
		LEFT JOIN Location  on StorageOutList.LocationID = Location.LocationID
		Where OutType = 6  {0} -- 可能需要震泽及其下属所有科室
		Group By
		Area.Name,
		StorageOut.WarehouseID,StorageOutList.cargotypeid,
		Location.LOCATIONNAME,
		CargoTopType.TypeName,
		CargoTypeKind.KindName,
		CargoType.CargoTypeName,
		CargoType.MinUnit,
		CargoType.Unit,CargoType.incode,StorageOut.OutDate,StorageList.Price,StorageList.Quantity,StorageList.LotNumber
		Order By StorageOut.OutDate DESC
	</Content>

	  <Content Key="ReportProvideMaterialSummary" Desc="发放一次性物品统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      StorageOut.OutDate OUTDATE,
      Area.Name AS AREATEXT, --区域
      orgs.Name as NAMES,
      Location.LOCATIONNAME,
      CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
      CargoType.MinUnit MINUNIT,
      CargoType.Unit UNIT,
      CargoType.incode INCODE,
      SUM(SOLSL.Quantity) AS QTY,--数量
      ISNULL(CargoType.Amount,0.00) AS UNITPRICE,--单价
      ISNULL(CargoType.Amount,0.00) * SUM(SOLSL.Quantity) AS TOTALPRICE --总价
      ,(ISNULL(CargoType.Amount,0.00)-ISNULL(CargoType.FCostPrice,0.00)) * SUM(SOLSL.Quantity) AS PROFIT --利润
      ,(select ISNULL(SUM(cast(st.Quantity as bigint)),0)
      FROM  StorageList st
      WHERE st.Quantity>0
      AND st.WarehouseID = StorageOut.WarehouseID and st.cargotypeid=StorageOutList.cargotypeid
      AND st.EXPDate>CONVERT(varchar(10),GETDATE(),120)
      GROUP BY
      st.CargoTypeID
      )   SHENGQTY
      ,StorageList.LotNumber LOTNUMBER
      ,StorageOutList.CARGOTYPEID
      FROM StorageOutList WITH (NOLOCK)
      INNER JOIN StorageOut WITH (NOLOCK)  on StorageOut.OutID = StorageOutList.OutID
      Left join  StorageOutListStorageList SOLSL ON SOLSL.OutListID=StorageOutList.OutListID
      LEFT JOIN StorageList WITH (NOLOCK)  on StorageList.StorageID = SOLSL.StorageID
      LEFT JOIN AC_ORG AS Area WITH (NOLOCK)  on StorageOut.OrgID = Area.ID
      left join AC_Org orgs on Area.PrevID=orgs.ID
      LEFT JOIN CargoType WITH (NOLOCK)  on StorageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind WITH (NOLOCK) ON CargoType.CargoTypeKind = CargoTypeKind.ID
      LEFT JOIN SystemTypeParameter AS CargoTopType WITH (NOLOCK) ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      LEFT JOIN AC_WorkGroup AS ProvideUser WITH (NOLOCK) on StorageOut.OPID = ProvideUser.FID
      LEFT JOIN AC_WorkGroup AS RecipientUser WITH (NOLOCK) on StorageOut.RECIPIENTID = RecipientUser.FID
      LEFT JOIN Location WITH (NOLOCK) on StorageOutList.LocationID = Location.LocationID
      Where OutType = 6  {0} -- 可能需要震泽及其下属所有科室
      Group By
      Area.Name,
      orgs.Name,
      StorageOut.WarehouseID,StorageOutList.cargotypeid,
      Location.LOCATIONNAME,
      CargoTopType.TypeName,
      CargoTypeKind.KindName,
      CargoType.CargoTypeName,
      CargoType.Amount,
      CargoType.FCostPrice,
      CargoType.MinUnit,
      CargoType.Unit,CargoType.incode,
      StorageOut.OutDate,SOLSL.Quantity,StorageList.LotNumber
      Order By StorageOut.OutDate DESC
    </Content>
	  <Content Key="ReportProvideMaterialSummary" Desc="发放一次性物品统计" DataBaseType="Oracle">
      SELECT
      StorageOut.OutDate OUTDATE,
      Area.Name AS AREATEXT, --区域
      orgs.Name as NAMES,
      Location.LOCATIONNAME,
      CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
      CargoType.MinUnit MINUNIT,
      CargoType.Unit UNIT,
      CargoType.incode INCODE,
      SUM(SOLSL.Quantity) AS QTY,--数量
      nvl(CargoType.Amount,0.00) AS UNITPRICE,--单价
      nvl(CargoType.Amount,0.00) * SUM(SOLSL.Quantity) AS TOTALPRICE --总价
      ,(nvl(CargoType.Amount,0.00)-nvl(CargoType.FCostPrice,0.00)) * SUM(SOLSL.Quantity) AS PROFIT --利润
      ,(select nvl(SUM(st.Quantity),0)
      FROM  StorageList st
      WHERE st.Quantity>0
      AND st.WarehouseID = StorageOut.WarehouseID and st.cargotypeid=StorageOutList.cargotypeid
      AND  to_char(st.EXPDate,'yyyy-mm-dd')>to_char(sysdate,'yyyy-mm-dd')
      GROUP BY
      st.CargoTypeID
      )  SHENGQTY
      ,StorageList.LotNumber LOTNUMBER
      ,StorageOutList.CARGOTYPEID
      FROM StorageOutList
      INNER JOIN StorageOut  on StorageOut.OutID = StorageOutList.OutID
      Left join  StorageOutListStorageList SOLSL ON SOLSL.OutListID=StorageOutList.OutListID
      LEFT JOIN StorageList  on StorageList.StorageID = SOLSL.StorageID
      LEFT JOIN AC_ORG  Area   on StorageOut.OrgID = Area.ID
      left join AC_Org orgs on Area.PrevID=orgs.ID
      LEFT JOIN CargoType   on StorageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind  ON CargoType.CargoTypeKind = CargoTypeKind.ID
      LEFT JOIN SystemTypeParameter  CargoTopType  ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      LEFT JOIN AC_WorkGroup  ProvideUser  on StorageOut.OPID = ProvideUser.FID
      LEFT JOIN AC_WorkGroup  RecipientUser  on StorageOut.RECIPIENTID = RecipientUser.FID
      LEFT JOIN Location  on StorageOutList.LocationID = Location.LocationID
      Where OutType = 6  {0} -- 可能需要震泽及其下属所有科室
      Group By
      Area.Name,
      orgs.Name,
      StorageOut.WarehouseID,StorageOutList.cargotypeid,
      Location.LOCATIONNAME,
      CargoTopType.TypeName,
      CargoTypeKind.KindName,
      CargoType.CargoTypeName,
      CargoType.Amount,
      CargoType.FCostPrice,
      CargoType.MinUnit,
      CargoType.Unit,CargoType.incode,StorageOut.OutDate,SOLSL.Quantity,StorageList.LotNumber
      Order By StorageOut.OutDate DESC
    </Content>	 
    <Content Key="ReportProvideSummary" Desc="发放统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Area.Name AS AREATEXT, --区域
      orgs.Name as NAMES,
      l.LOCATIONNAME,
      CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
      PackageType.PName AS OUTPACKING,--外包装
      case FlowPackageList.LendFlag
      when 0 then '否'
      when 1 then '是'
      End as LENDFLAG,
      COUNT(1) AS QTY,--数量
      ISNULL(CargoType.Amount,0.00) AS UNITPRICE,--单价
      ISNULL(CargoType.Amount,0.00) * COUNT(FlowProvideList.PackageID) AS TOTALPRICE, --总价
      ISNULL(CargoType.InstrumentsNumber,0) AS INUMBER,
      ISNULL(CargoType.InstrumentsNumber,0) * COUNT(FlowProvideList.PackageID) AS TOTALINUMBER
      ,StorageList.BARCODE
      ,isnull(c1.SUMAMOUNT,0) as SUMAMOUNT
      FROM FlowProvideList
      INNER JOIN FlowProvide on FlowProvide.ProvideID = FlowProvideList.ProvideID
      inner JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID
      left JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN AC_ORG AS Area  on FlowProvide.OrgID = Area.ID
      left join AC_Org orgs on Area.PrevID=orgs.ID
      LEFT JOIN CargoType on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind  ON CargoType.CargoTypeKind = CargoTypeKind.ID
      inner JOIN SystemTypeParameter AS CargoTopType ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      inner JOIN StorageList on FlowPackageList.StorageID = StorageList.StorageID
      inner JOIN AC_WorkGroup on FlowProvide.OPID = AC_WorkGroup.FID
      LEFT JOIN AC_WorkGroup us on FlowProvide.RECIPIENTID = us.FID
      Left join Location l on FlowProvide.LocationID = l.LocationID
      left join
      (
      select  ps.PackageTypeID,  SUM(ps.Quantity*ct1.amount) as SUMAMOUNT
      from  PackageSetting ps
      left join  CargoType ct1
      on ps.CargoTypeID=ct1.CargoTypeID
      where  ps.CargoTopType=4
      group by  ps.PackageTypeID
      ) c1
      on cargotype.CargoTypeID=c1.PackageTypeID
      Where 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      Group By
      Area.Name,
      orgs.Name,
      l.LOCATIONNAME,
      CargoTopType.TypeName,
      CargoTypeKind.KindName,
      CargoType.CargoTypeName,
      PackageType.PName,
      FlowPackageList.LendFlag,
      CargoType.Amount,
      CargoType.InstrumentsNumber
      ,StorageList.BARCODE
      ,c1.SUMAMOUNT
      Order By AreaText,CARGOTYPETEXT
    </Content>
    <Content Key="ReportProvideSummary" Desc="发放统计" DataBaseType="Oracle">
      SELECT
      Area.Name  AREATEXT,
      orgs.Name NAMES,
      l.LOCATIONNAME,
      CargoTopType.TypeName  CARGOTOPTYPETEXT,
      CargoTypeKind.KindName  CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName  CARGOTYPETEXT,
      PackageType.PName  OUTPACKING,
      case FlowPackageList.LendFlag
      when 0 then '否'
      when 1 then '是'
      End  LENDFLAG,
      COUNT(1)  QTY,
      nvl(CargoType.Amount,0.00)  UNITPRICE,
      nvl(CargoType.Amount,0.00) * COUNT(FlowProvideList.PackageID)  TOTALPRICE, --总价
      nvl(CargoType.InstrumentsNumber,0) AS INUMBER,
      nvl(CargoType.InstrumentsNumber,0) * COUNT(FlowProvideList.PackageID) AS TOTALINUMBER
      ,StorageList.BARCODE
      ,nvl(c1.SUMAMOUNT,0) as SUMAMOUNT
      FROM FlowProvideList
      INNER JOIN FlowProvide  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      inner JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID
      inner JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN AC_ORG  Area  on FlowProvide.OrgID = Area.ID
      left join AC_Org orgs on Area.PrevID=orgs.ID
      LEFT JOIN CargoType  on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind ON CargoType.CargoTypeKind = CargoTypeKind.ID
      inner JOIN SystemTypeParameter  CargoTopType ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      inner JOIN StorageList  on FlowPackageList.StorageID = StorageList.StorageID
      inner JOIN AC_WorkGroup  on FlowProvide.OPID = AC_WorkGroup.FID
      LEFT JOIN AC_WorkGroup us  on FlowProvide.RECIPIENTID = us.FID
      Left join Location l  on FlowProvide.LocationID = l.LocationID
      left join
      (
      select  ps.PackageTypeID,  SUM(ps.Quantity*ct1.amount) as SUMAMOUNT
      from  PackageSetting ps
      left join  CargoType ct1
      on ps.CargoTypeID=ct1.CargoTypeID
      where  ps.CargoTopType=4
      group by  ps.PackageTypeID
      ) c1
      on cargotype.CargoTypeID=c1.PackageTypeID
      Where 1 = 1  {0}
      Group By
      Area.Name,
      orgs.Name,
      l.LOCATIONNAME,
      CargoTopType.TypeName,
      CargoTypeKind.KindName,
      CargoType.CargoTypeName,
      PackageType.PName,
      FlowPackageList.LendFlag,
      CargoType.Amount,
      CargoType.InstrumentsNumber
      ,StorageList.BARCODE
      ,c1.SUMAMOUNT
      Order By AreaText,CargoTypeText
    </Content>

    <Content Key="ReportDeviceDisinfectSummary" Desc="清洗设备统计" DataBaseType="SqlServer">
      --清洗设备统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      case DEVICENAME when '人工清洗' then '人工清洗'  else '自动清洗' end as DISINFECTTYPE,
      CONVERT(varchar(10),DevicesUseLog.BeginDate,120) AS BEGINDATE
      ,Devices.DeviceName as DEVICENAME
      ,CK.KindName as CARGOTYPEKINDTEXT
      ,DevicesUseLog.TODAYUSETIMES                    --每天的清洗批次
      ,DevicesUseLog.USETIMES
      --每批次运行的时间+所用的清洗程序
      ,isnull(DATEDIFF(n,DevicesUseLog.BeginDate,DevicesUseLog.EndDate),0) USEDATE
      ,isnull(prule.RULENAME,'') RULENAME
      --每批次清晰地科室+包名+数量
      ,RecycleOrg.Name ORGNAME
      ,view_CargoType.CargoTypeText    CARGOTYPENAME
      ,COUNT(FlowRecycleList.PackageID) QUANTITY
      ,isnull(view_CargoType.InstrumentsNumber,0) * sum(1) AS INSTRUMENTSNUMBER
      ,(select count(*) from FLOWDISINFECTCONTAINERLIST a where a.frecycleid=FlowRecycle.frecycleid) as CONTAINERQUANTITY
      FROM   DevicesUseLog  with (nolock)
      INNER JOIN Devices with (nolock)  ON Devices.DeviceID =DevicesUseLog.DeviceID
      INNER JOIN AC_WorkGroup PackageUser with (nolock) ON DevicesUseLog.UserID = PackageUser.FID
      INNER JOIN AC_UserWorkGroup WG  ON PackageUser.FID = WG.FGroupID
      INNER JOIN AC_User AU  ON WG.FUserID = AU.ID
      LEFT JOIN DeviceProcessRule prule  on DevicesUseLog.DeviceProcessRuleID = prule.RuleID
      LEFT JOIN FlowDisinfect fd on  DevicesUseLog.Logid=fd.LogID
      LEFT JOIN (select distinct FRecycleID,FDisinfectID   from FLOWDISINFECTCONTAINERLIST)  d on fd.FDisinfectID=d.FDisinfectID
      LEFT JOIN FlowRecycle ON d.FRecycleID = FlowRecycle.FRecycleID
      LEFT JOIN FlowRecycleList ON d.FRecycleID = FlowRecycleList.FRecycleID
      LEFT JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN view_CargoType ON StorageList.CargoTypeID = view_CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON view_CargoType.CargoTypeKind = CK.ID
      LEFT JOIN Warehouse WITH (NOLOCK) ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg WITH (NOLOCK) ON Warehouse.OrgID = RecycleOrg.ID
      WHERE Devices.DeviceType = 0 {0}
      GROUP by
      DevicesUseLog.TodayUseTimes,
      DevicesUseLog.UseTimes,
      DevicesUseLog.BeginDate,
      DevicesUseLog.EndDate,
      FlowRecycle.FRecycleID,
      prule.RuleName,
      RecycleOrg.Name,
      view_CargoType.CargoTypeText,
      CONVERT(varchar(10),DevicesUseLog.BeginDate,120),
      DeviceName
      ,CK.KindName
      ,view_CargoType.InstrumentsNumber
      ORDER BY CONVERT(varchar(10),DevicesUseLog.BeginDate,120) ,DeviceName,DevicesUseLog.TODAYUSETIMES
    </Content>
    <Content Key="ReportDeviceDisinfectSummary" Desc="清洗设备统计" DataBaseType="Oracle">
		SELECT
		fun_get_Date(DevicesUseLog.BeginDate,'Daily')  BEGINDATE
		,Devices.DeviceName  DEVICENAME
		,DevicesUseLog.TODAYUSETIMES
		,DevicesUseLog.USETIMES
		--每批次运行的时间+所用的清洗程序
		,nvl((to_date(EndDate,'yyyy-mm-dd hh24:mi:ss')-to_date(BeginDate,'yyyy-mm-dd hh24:mi:ss'))*24*60,0) USEDATE
		,nvl(prule.RULENAME,'') RULENAME
		--每批次清晰地科室+包名+数量
		,RecycleOrg.Name ORGNAME
		, view_CargoType.CargoTypeText CARGOTYPENAME
		,COUNT(FlowRecycleList.PackageID) QUANTITY
		,(select count(*) from FLOWDISINFECTCONTAINERLIST a where a.frecycleid=FlowRecycle.frecycleid) as CONTAINERQUANTITY
		FROM   DevicesUseLog
		INNER JOIN Devices  ON Devices.DeviceID =DevicesUseLog.DeviceID
		INNER JOIN AC_WorkGroup PackageUser  ON DevicesUseLog.UserID = PackageUser.FID
		INNER JOIN AC_UserWorkGroup WG  ON PackageUser.FID = WG.FGroupID
		INNER JOIN AC_User AU  ON WG.FUserID = AU.ID
		LEFT JOIN DeviceProcessRule prule  on DevicesUseLog.DeviceProcessRuleID = prule.RuleID
		LEFT JOIN FlowDisinfect fd on  DevicesUseLog.Logid=fd.LogID
		LEFT JOIN (select distinct FRecycleID,FDisinfectID   from FLOWDISINFECTCONTAINERLIST)  d on fd.FDisinfectID=d.FDisinfectID
		LEFT JOIN FlowRecycle ON d.FRecycleID = FlowRecycle.FRecycleID
		LEFT JOIN FlowRecycleList ON d.FRecycleID = FlowRecycleList.FRecycleID
		LEFT JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
		LEFT JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
		LEFT JOIN view_CargoType ON StorageList.CargoTypeID = view_CargoType.CargoTypeID
		LEFT JOIN Warehouse  ON  StorageList.WarehouseID = Warehouse.WarehouseID
		LEFT JOIN AC_Org  RecycleOrg  ON Warehouse.OrgID = RecycleOrg.ID
		WHERE Devices.DeviceType = 0 {0}
		GROUP by
		DevicesUseLog.TodayUseTimes,
		DevicesUseLog.UseTimes,
		DevicesUseLog.BeginDate,
		DevicesUseLog.EndDate,
		FlowRecycle.FRecycleID,
		prule.RuleName,
		RecycleOrg.Name,
		view_CargoType.CargoTypeText,
		fun_get_Date(DevicesUseLog.BeginDate,'Daily'),
		DeviceName
		ORDER BY fun_get_Date(DevicesUseLog.BeginDate,'Daily') DESC,DeviceName
	</Content>

    <Content Key="ReportDeviceUseSummary" Desc="设备使用统计" DataBaseType="SqlServer">
      <![CDATA[
      SELECT
      CONVERT(varchar(10),DevicesUseLog.BeginDate,120) AS BEGINDATE
      ,Devices.DeviceName as DEVICENAME,
      count(*) QUANTITY
      FROM   DevicesUseLog  with (nolock)
      INNER JOIN Devices with (nolock)  ON Devices.DeviceID =DevicesUseLog.DeviceID
      WHERE isdisabled=0 and Devices.DeviceID<>'88163FBB-FCB1-4E1C-8A80-A77486FB26AE'  {0}
      GROUP by
      CONVERT(varchar(10),DevicesUseLog.BeginDate,120),
      DeviceName
      ORDER BY CONVERT(varchar(10),DevicesUseLog.BeginDate,120) desc,DEVICENAME asc
      ]]>
    </Content>
    <Content Key="ReportDevicesUseCountSummary_SHCH" Desc="设备使用统计(长海)" DataBaseType="SqlServer">
      <![CDATA[
     with 
cr as 
( 
    select du.deviceid,du.logid from DevicesUseLog du inner join devices d1 on d1.deviceid=du.deviceid  where 1=1 {0}
)  
SELECT [全自动清洗消毒器1] as '1#机',[全自动清洗消毒器2] as '2#机',[全自动清洗消毒器3] as '3#机',[全自动清洗消毒器4] as '4#机',[全自动清洗消毒器5] as '5#机',
      [人工清洗] as '人工',[1#压力蒸汽灭菌器] as '1#锅',[2#压力蒸汽灭菌器] as '2#锅',[3#压力蒸汽灭菌器] as '3#锅',[4#压力蒸汽灭菌器] as '4#锅',[5#压力蒸汽灭菌器] as '5#锅',
      [6#低温等离子灭菌器] as '6#锅',[7#低温等离子灭菌器] as '7#锅',[8#低温等离子灭菌器] as '8#锅',[9#环氧乙烷灭菌器] as '9#锅',
      isnull([全自动清洗消毒器1],0)+isnull([全自动清洗消毒器2],0)+isnull([全自动清洗消毒器3],0)+isnull([全自动清洗消毒器4],0)+isnull([全自动清洗消毒器5],0)+isnull([人工清洗],0)
      +isnull([1#压力蒸汽灭菌器],0)+isnull([2#压力蒸汽灭菌器],0)+isnull([3#压力蒸汽灭菌器],0)+isnull([4#压力蒸汽灭菌器],0)+isnull([5#压力蒸汽灭菌器],0)
      +isnull([6#低温等离子灭菌器],0)+isnull([7#低温等离子灭菌器],0)+isnull([8#低温等离子灭菌器],0)+isnull([9#环氧乙烷灭菌器],0)
      as ' '
      FROM 
      (select  d.DeviceName,isnull(cnt,0) cnt from Devices d 
      left join  
      (
         select cr.deviceid,COUNT(*) as cnt from 
		  (
			select distinct DeviceLogID,FRecycleID  from FlowDisinfectContainerList
		  )
		  aa  inner join  FlowRecycleList  frcl on aa.FRecycleID=frcl.FRecycleID
		  inner join cr on cr.LogID=aa.DeviceLogID
		  group by cr.DeviceID
		  union all  
		  select cr.DeviceID,COUNT(*) from FlowSterilizationList fsl
		  inner join cr on cr.LogID=fsl.SterilizationLogID
		  group by cr.DeviceID
      ) c1  on c1.deviceid=d.deviceid 
       ) aa
      PIVOT 
      (
          sum(cnt) for DeviceName in([人工清洗],[全自动清洗消毒器1],[全自动清洗消毒器2],[全自动清洗消毒器3],[全自动清洗消毒器4],[全自动清洗消毒器5],[1#压力蒸汽灭菌器]
              ,[2#压力蒸汽灭菌器],[3#压力蒸汽灭菌器],[4#压力蒸汽灭菌器],[5#压力蒸汽灭菌器],[6#低温等离子灭菌器],[7#低温等离子灭菌器],[8#低温等离子灭菌器],[9#环氧乙烷灭菌器])
      )TBL
      ]]>
    </Content>
    <Content Key="ReportDeviceDisinfectSummary" Desc="清洗设备统计" DataBaseType="Oracle">
      <![CDATA[
      SELECT
      fun_get_Date(DevicesUseLog.BeginDate,'Daily')  BEGINDATE
      ,Devices.DeviceName  DEVICENAME,
      count(*) QUANTITY
      FROM   DevicesUseLog
      INNER JOIN Devices  ON Devices.DeviceID =DevicesUseLog.DeviceID
      WHERE isdisabled=0 and Devices.DeviceID<>'88163FBB-FCB1-4E1C-8A80-A77486FB26AE'  {0}
      GROUP by
      fun_get_Date(DevicesUseLog.BeginDate,'Daily'),
      DeviceName
      ORDER BY fun_get_Date(DevicesUseLog.BeginDate,'Daily') DESC,DeviceName asc
       ]]>
    </Content>
    
    
    <Content Key="ReportDeviceSterilizeSummary" Desc="灭菌设备统计" DataBaseType="SqlServer">
      --灭菌设备统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      SELECT T1.BEGINDATE,T1.DEVICENAME,T1.TODAYUSETIMES,T1.USETIMES,T1.RULENAME,T1.CARGOTYPENAME,T1.PNAME
      ,sum(T1.QUANTITY) as QUANTITY,T1.ORGNAME
      from
      (
      SELECT T.BEGINDATE,T.DEVICENAME,T.TODAYUSETIMES,T.USETIMES,T.RULENAME,T.CARGOTYPENAME,T.PNAME
      ,T.QUANTITY
      ,(select top 1 name from	FlowRecycleList
      inner join FlowPackageList on FlowRecycleList.PackageID = FlowPackageList.PackageID
      inner join StorageList on FlowPackageList.StorageID = StorageList.StorageID
      left join Warehouse on StorageList.WarehouseID = Warehouse.WarehouseID
      left join AC_Org on Warehouse.OrgID = AC_Org.ID
      where StorageList.CargoTypeID = T.CARGOTYPEID and FlowRecycleList.FRecycleID = T.FRecycleID) as  ORGNAME
      FROM
      (SELECT
      CONVERT(varchar(10),DevicesUseLog.BeginDate,120) AS [BEGINDATE],
      Devices.DeviceName AS DEVICENAME,
      DevicesUseLog.TODAYUSETIMES,
      DevicesUseLog.USETIMES,
      isnull(prule.RULENAME,'') as RULENAME
      ,c.CargoTypeName CARGOTYPENAME
      ,pt.PNAME
      ,COUNT(fl.PackageID) as QUANTITY
      ,c.CARGOTYPEID
      ,fld.FRECYCLEID
      From DevicesUseLog  with (nolock)
      left JOIN Devices with (nolock)  ON Devices.DeviceID =DevicesUseLog.DeviceID
      LEFT JOIN DeviceProcessRule  prule  ON DevicesUseLog.DeviceProcessRuleID = prule.RuleID
      inner join FlowSterilizationList fsl  ON DevicesUseLog.LogID=fsl.SterilizationLogID
      inner join FlowPackageList fl  on fsl.PackageID = fl.PackageID
      inner join FlowPackageListDisinfect fld on fld.PackageID = fl.PackageID
      left join PackageType pt ON fl.PackageTypeID = pt.PTypeID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      left join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      WHERE Devices.DeviceType in (4,5,6) {0}
      GROUP by  CONVERT(varchar(10),DevicesUseLog.BeginDate,120),DevicesUseLog.TODAYUSETIMES,DevicesUseLog.UseTimes,
      DeviceName,prule.RULENAME,c.CargoTypeName,pt.PNAME,c.CARGOTYPEID,fld.FRecycleID) as T) AS T1
      GROUP BY T1.BEGINDATE,T1.DEVICENAME,T1.TODAYUSETIMES,T1.USETIMES,T1.RULENAME,T1.CARGOTYPENAME,T1.PNAME,T1.ORGNAME
      ORDER BY BeginDate DESC,DeviceName,ORGNAME,CARGOTYPENAME
    </Content>
    <Content Key="ReportDeviceSterilizeSummary" Desc="灭菌设备统计" DataBaseType="Oracle">
      SELECT T1.BEGINDATE,T1.DEVICENAME,T1.TODAYUSETIMES,T1.USETIMES,T1.RULENAME,T1.CARGOTYPENAME,T1.PNAME
      ,sum(T1.QUANTITY) as QUANTITY,T1.ORGNAME
      from
      (
      SELECT T.BEGINDATE,T.DEVICENAME,T.TODAYUSETIMES,T.USETIMES,T.RULENAME,T.CARGOTYPENAME,T.PNAME
      ,T.QUANTITY
      ,(select  name from	FlowRecycleList
      inner join FlowPackageList on FlowRecycleList.PackageID = FlowPackageList.PackageID
      inner join StorageList on FlowPackageList.StorageID = StorageList.StorageID
      left join Warehouse on StorageList.WarehouseID = Warehouse.WarehouseID
      left join AC_Org on Warehouse.OrgID = AC_Org.ID
      where  rownum=1 and StorageList.CargoTypeID = T.CARGOTYPEID and FlowRecycleList.FRecycleID = T.FRecycleID) as  ORGNAME
      FROM
      (SELECT
      fun_get_Date(DevicesUseLog.BeginDate,'Daily')  AS BEGINDATE,
      Devices.DeviceName AS DEVICENAME,
      DevicesUseLog.TODAYUSETIMES,
      DevicesUseLog.USETIMES,
      nvl(prule.RULENAME,'')  as RULENAME
      ,c.CargoTypeName CARGOTYPENAME
      ,pt.PNAME
      ,COUNT(fl.PackageID) as QUANTITY
      ,c.CARGOTYPEID
      ,fld.FRECYCLEID
      From DevicesUseLog
      left JOIN Devices  ON Devices.DeviceID =DevicesUseLog.DeviceID
      LEFT JOIN DeviceProcessRule  prule  ON DevicesUseLog.DeviceProcessRuleID = prule.RuleID
      inner join FlowSterilizationList fsl  ON DevicesUseLog.LogID=fsl.SterilizationLogID
      inner join FlowPackageList fl  on fsl.PackageID = fl.PackageID
      inner join FlowPackageListDisinfect fld on fld.PackageID = fl.PackageID
      left join PackageType pt ON fl.PackageTypeID = pt.PTypeID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      left join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      WHERE Devices.DeviceType in (4,5,6) {0}
      GROUP by  fun_get_Date(DevicesUseLog.BeginDate,'Daily'),DevicesUseLog.TODAYUSETIMES,DevicesUseLog.UseTimes,
      DeviceName,prule.RULENAME,c.CargoTypeName,pt.PNAME,c.CARGOTYPEID,fld.FRecycleID)   T)  T1
      GROUP BY T1.BEGINDATE,T1.DEVICENAME,T1.TODAYUSETIMES,T1.USETIMES,T1.RULENAME,T1.CARGOTYPENAME,T1.PNAME,T1.ORGNAME
      ORDER BY BeginDate DESC,DeviceName,ORGNAME,CARGOTYPENAME

    </Content>

    <Content Key="QueryDevicesMaintainList" Desc="设备维保记录" DataBaseType="SqlServer">
      SELECT DEVICENAME,Convert(char(10), M.MAINTAINDATE ,120) MAINTAINDATE,M.REMARK
      FROM DevicesMaintainLog M  WITH (NOLOCK)
      LEFT JOIN Devices D WITH (NOLOCK) ON M.DeviceID = D.DeviceID
      INNER JOIN AC_WorkGroup U ON M.UserID=U.FID
      INNER JOIN AC_UserWorkGroup WG  ON U.FID = WG.FGroupID
      INNER JOIN AC_User AU  ON WG.FUserID = AU.ID
      WHERE  M.MaintainDate is not null {0} ORDER BY M.MaintainDate DESC
    </Content>
    <Content Key="QueryDevicesMaintainList" Desc="设备维保记录" DataBaseType="Oracle">
      SELECT DeviceName,to_char( M.MaintainDate,'yyyy-mm-dd') MaintainDate,M.Remark
      FROM DevicesMaintainLog M
      LEFT JOIN Devices D  ON M.DeviceID = D.DeviceID
      INNER JOIN AC_WorkGroup U ON M.UserID=U.FID
      INNER JOIN AC_UserWorkGroup WG  ON U.FID = WG.FGroupID
      INNER JOIN AC_User AU  ON WG.FUserID = AU.ID
      WHERE  M.MaintainDate is not null {0} ORDER BY M.MaintainDate DESC
    </Content>
	  
	  <Content Key="REPORT_FlowProvideConfirmSUMMARY" Desc="发放接收统计" DataBaseType="SqlServer">
		  SELECT p.*,C.CONFIRMQTY,P.PROVIDEQTY-ISNULL(c.CONFIRMQTY,0) NOTCONFIRMQTY FROM
		  (
		  SELECT vc.CARGOTYPEID,vc.CARGOTYPETEXT,COUNT(*) as PROVIDEQTY FROM
		  FLOWPROVIDELIST FPV   INNER JOIN FlowProvide fp on fp.ProvideID=fpv.ProvideID
		  INNER JOIN FlowPackageList fpl on fpv.PackageID=fpl.PackageID
		  inner join view_CargoType VC on vc.CargoTypeID=fpl.CargoTypeID
		  --Left join FlowProvideConfirm FPC on  FPV.ProvideConfirmID=FPC.ProvideConfirmID
		  WHERE 1=1 {0}
		  group by vc.CargoTypeID,vc.CARGOTYPETEXT
		  ) p
		  LEFT JOIN
		  (
		  SELECT vc.CARGOTYPEID,vc.CARGOTYPETEXT,ISNULL(COUNT(*),0) as CONFIRMQTY FROM
		  FLOWPROVIDELIST FPV   INNER JOIN FlowProvide fp on fp.ProvideID=fpv.ProvideID
		  INNER JOIN FlowPackageList fpl on fpv.PackageID=fpl.PackageID
		  inner join view_CargoType VC on vc.CargoTypeID=fpl.CargoTypeID
		  --Left join FlowProvideConfirm FPC on  FPV.ProvideConfirmID=FPC.ProvideConfirmID
		  WHERE 1=1   and fpv.Status=1 {0}
		  group by vc.CargoTypeID,vc.CARGOTYPETEXT
		  ) c ON P.CargoTypeID=C.CargoTypeID
	  </Content>
	  <Content Key="REPORT_FlowProvideConfirmSUMMARY" Desc="发放接收统计" DataBaseType="Oracle">
		  SELECT p.*,C.CONFIRMQTY,P.PROVIDEQTY-nvl(c.CONFIRMQTY,0) NOTCONFIRMQTY FROM
		  (
		  SELECT vc.CARGOTYPEID,vc.CARGOTYPETEXT,COUNT(*) as PROVIDEQTY FROM
		  FLOWPROVIDELIST FPV   INNER JOIN FlowProvide fp on fp.ProvideID=fpv.ProvideID
		  INNER JOIN FlowPackageList fpl on fpv.PackageID=fpl.PackageID
		  inner join view_CargoType VC on vc.CargoTypeID=fpl.CargoTypeID
		  --Left join FlowProvideConfirm FPC on  FPV.ProvideConfirmID=FPC.ProvideConfirmID
		  WHERE 1=1 {0}
		  group by vc.CargoTypeID,vc.CARGOTYPETEXT
		  ) p
		  LEFT JOIN
		  (
		  SELECT vc.CARGOTYPEID,vc.CARGOTYPETEXT,nvl(COUNT(*),0) as CONFIRMQTY FROM
		  FLOWPROVIDELIST FPV   INNER JOIN FlowProvide fp on fp.ProvideID=fpv.ProvideID
		  INNER JOIN FlowPackageList fpl on fpv.PackageID=fpl.PackageID
		  inner join view_CargoType VC on vc.CargoTypeID=fpl.CargoTypeID
		  --Left join FlowProvideConfirm FPC on  FPV.ProvideConfirmID=FPC.ProvideConfirmID
		  WHERE 1=1   and fpv.Status=1 {0}
		  group by vc.CargoTypeID,vc.CARGOTYPETEXT
		  ) c ON P.CargoTypeID=C.CargoTypeID
	  </Content>
    <Content Key="ReportGetFlowPackageIn" Desc="外来包统计" DataBaseType="SqlServer">
    <![CDATA[
        SELECT  T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
      count(distinct T2.packageid) QUANTITY,T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
      T1.RETURNMEMO,O.NAME AS ORGNAME,U.FNames AS OPNAME,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
      --,T3.BARCODE,T3.STATUS FRECYCLESTATUS
      ,T5.OPID,T6.FNames FRECYCLER
      ,T7.CARGOTYPENAME
      --,T8.LASTFDISINFECTID
      --,T10.USERID FSTERILIZEID
      ,T14.FNames FSTERILIZER
      ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
      ,T10.BEGINDATE FSTERILIZEDATE
      ,T15.FNames FSCHECKER
      --,T10.LOGID
      ,T16.TYPENAME FSTERILIZERESULT
      ,CASE ISNULL(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END FSTERILIZETYPE
      ,T12.OPID FPROVIDEID,T17.FNames FPROVIDER,T12.PROVIDEDATE,T12.ORGID FPROVIDERORGID,T18.NAME FPROVIDERORG
      ,D.DEVICENAME,FR.OPID ,AWR.FNAMES FRECYCLER,awp.FNames FPACKAGER,awC.FNames FCHECKER,T1.FPACKAGENAME
      ,BTP.TypeName as IsBPCDOK
      ,T1.FPatient
      ,T1.InDisinfectPrice as INDISINFECTPRICE
      ,isnull(T1.IsChecked,0) as ISCHECKED
      ,T1.PackageInCode as PACKAGEINCODE
      ,T2.SubPackageQty as SUBPACKAGEQTY
      ,T1.DisabledReason
      
      ,T5.RecycleDate --回收时间
      ,Disinfect.FNames as DisinfectName --清洗人
      ,fd.DisinfectDate --清洗时间
      ,DisinfectDevices.DeviceName as DisinfectDeviceName --清洗设备
      ,dul.TODAYUSETIMES as DisinfectToDayUseTimes --清洗锅次
      ,T3.Barcode as PackageBarcode --条码
      ,againRecycleName.FNames as AgainRecycleName --再次回收人
      ,T1.AgainRecycleDate --再次回收时间
      ,againDisinfectName.FNames as AgainDisinfectName --再次清洗人
      ,T1.AgainDisinfectDate --再次清洗时间
      ,T1.AgainBarcode --新条码
      ,returnName.FNames as ReturnName --归还人
      ,ous.Name as ForgName --发放科室
      ,(CASE WHEN T10.IsBDTest <> 1 THEN CTP.TYPENAME END) AS ISCPCDOK
      ,case when  dbo.fun_IsBPCD(T9.SterilizationLogID)=0 then '未涉及' else BTP.TYPENAME end  AS ISBPCDOKs
      
      FROM FLOWPACKAGEIN T1
      INNER JOIN FLOWPACKAGELIST T2 ON T2.FPACKAGEID=T1.FPACKAGEID
      LEFT JOIN STORAGELIST T3 ON T3.STORAGEID=T2.STORAGEID
      LEFT JOIN FLOWRECYCLELIST T4 ON T4.PACKAGEID=T2.PACKAGEID
      LEFT JOIN FLOWRECYCLE T5 ON T5.FRECYCLEID=T4.FRECYCLEID
      
      /*----*/
      left join FlowDisinfectContainerList fdc on T5.FRecycleID=fdc.FRecycleID
      left join FlowDisinfect fd on fdc.FDisinfectID=fd.FDisinfectID
      left join DevicesUseLog dul on fd.LogID=dul.LogID
      left join Devices DisinfectDevices on dul.DeviceID=DisinfectDevices.DeviceID
      left join AC_WorkGroup Disinfect on dul.UserID=Disinfect.FID
      left join AC_WorkGroup againRecycleName on T1.AgainRecycleID=againRecycleName.FID
      left join AC_WorkGroup againDisinfectName  on T1.AgainDisinfectID=againDisinfectName.FID
      left join AC_WorkGroup returnName on T1.ReturnOPID=returnName.FID
      /*----*/
      
      LEFT JOIN AC_WorkGroup T6 ON T6.FID=T5.OPID
      LEFT JOIN CARGOTYPE T7 ON T7.CARGOTYPEID=T1.CARGOTYPEID
      --LEFT JOIN FLOWRECYCLECONTAINER T8 ON T8.FRECYCLEID=T5.FRECYCLEID
      LEFT JOIN FLOWSTERILIZATIONLIST T9 ON T9.PACKAGEID=T2.PACKAGEID
      LEFT JOIN DEVICESUSELOG T10 ON T10.LOGID=T9.STERILIZATIONLOGID
      LEFT JOIN SYSTEMTYPEPARAMETER CTP ON ( T10.IsCPCDOK =  CTP.TYPEVALUE AND CTP.TYPEKEY = 'IsOK')
      LEFT JOIN FLOWPROVIDELIST T11 ON T11.PACKAGEID=T2.PACKAGEID
      LEFT JOIN FLOWPROVIDE T12 ON T12.PROVIDEID=T11.PROVIDEID
      LEFT JOIN AC_WorkGroup T14 ON T14.FID=T10.USERID
      LEFT JOIN AC_WorkGroup T15 ON T15.FID=T10.CHECKID
      LEFT JOIN (SELECT TYPEVALUE,TYPENAME FROM SYSTEMTYPEPARAMETER WHERE TYPEKEY='QualifiedNO') T16 ON T16.TYPEVALUE=T2.BADFLAG
      LEFT JOIN AC_WorkGroup T17 ON T17.FID=T12.OPID
      LEFT JOIN AC_ORG T18 ON T18.ID=T12.ORGID
      left join Ac_Org ous on ous.ID=T12.FlowOrgID
      LEFT JOIN AC_ORG O ON T1.SENDER = O.ID
      INNER JOIN AC_WorkGroup U ON T1.OPID = U.FID
      Left join Devices d on d.DeviceID=t10.DeviceID
      left join FlowRecycleList frl on frl.PackageID =t2.PackageID
      left join FlowRecycle fr on fr.FRecycleID=frl.FRecycleID
      left join AC_WorkGroup awR on awr.FID=fr.OPID
      left join AC_WorkGroup awP on awp.FID=t1.packagerID
      left join AC_WorkGroup awC on awc.FID=t2.CheckID
      LEFT JOIN SYSTEMTYPEPARAMETER BTP ON ( T10.IsBPCDOK =  BTP.TYPEVALUE AND BTP.TYPEKEY = 'IsOK')
      WHERE 1=1 and ISNULL(T1.IsDisabled,0)<>1 {0}
      GROUP by T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
      T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
      T1.RETURNMEMO,O.NAME  ,U.FNames ,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
      --,T3.BARCODE,T3.STATUS FRECYCLESTATUS
      ,T5.OPID,T6.FNames
      ,T7.CARGOTYPENAME
      --,T8.LASTFDISINFECTID
      --,T10.USERID FSTERILIZEID
      ,T14.FNames
      ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
      ,T10.BEGINDATE
      ,T15.FNames
      --,T10.LOGID
      ,T16.TYPENAME
      ,CASE ISNULL(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END
      ,T12.OPID  ,T17.FNames ,T12.PROVIDEDATE,T12.ORGID  ,T18.NAME
      ,D.DEVICENAME,FR.OPID ,AWR.FNAMES  ,awp.FNames  ,awC.FNames  ,T1.FPACKAGENAME
      ,BTP.TypeName
      ,T1.FPatient
      ,T1.InDisinfectPrice
      ,T1.IsChecked
      ,T1.PackageInCode
      ,T2.SubPackageQty
      ,T1.DisabledReason
      
      ,T5.RecycleDate
      ,Disinfect.FNames
      ,fd.DisinfectDate
      ,againRecycleName.FNames 
      ,T1.AgainRecycleDate
      ,T3.Barcode
      ,T1.AgainBarcode
      ,againDisinfectName.FNames
      ,T1.AgainDisinfectDate
      ,returnName.FNames
      ,ous.Name
      ,DisinfectDevices.DeviceName
      ,dul.TODAYUSETIMES
       ,T10.IsBDTest
      ,CTP.TYPENAME
      ,T9.SterilizationLogID
    ]]>
    </Content>
    <Content Key="ReportGetFlowPackageIn" Desc="外来包统计" DataBaseType="Oracle">
    <![CDATA[
        /*--select distinct u.FNames as USERNAME,o.Name as ORGNAME,FlowPackageIn.QUANTITY,c.CARGOTYPENAME,FlowPackageIn.PACKAGEINDATE,fp.PROVIDEDATE,pu.FNames as OPNAME,FlowPackageIn.FDOCTOR,FlowPackageIn.FPATIENT,FlowPackageIn.FPACKAGENAME,SystemTypeParameter.TypeName AS ISOK,FlowPackageIn.SendText,FlowPackageIn.FHospitalizedNo
      from  FlowPackageIn
      inner join AC_WorkGroup u  on FlowPackageIn.OPID = u.FID
      inner join CargoType  c  on FlowPackageIn.CargoTypeID = c.CargoTypeID
      inner join FlowPackageList pl ON FlowPackageIn.FPackageID = pl.FPackageID
      left join FlowProvideList fpl on pl.packageid = fpl.packageid
      left join FlowProvide fp on fpl.provideid = fp.provideid
      left join AC_WorkGroup pu on fp.opid = pu.fid
      inner join AC_Org o on FlowPackageIn.Sender = o.ID

      LEFT OUTER JOIN FlowSterilizationList fsl ON fsl.PackageID = pl.PackageID
      LEFT OUTER JOIN DevicesUseLog l ON fsl.SterilizationLogID = l.LogID
      LEFT OUTER JOIN SystemTypeParameter ON l.ISOK = SystemTypeParameter.TypeValue AND SystemTypeParameter.TypeKey = 'IsOK'
      where 1=1 {0}--*/
      SELECT  T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
      count(distinct T2.packageid) QUANTITY,T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
      T1.RETURNMEMO,O.NAME AS ORGNAME,U.FNames AS OPNAME,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
      --,T3.BARCODE,T3.STATUS FRECYCLESTATUS
      ,T5.OPID,T6.FNames FRECYCLER
      ,T7.CARGOTYPENAME
      --,T8.LASTFDISINFECTID
      --,T10.USERID FSTERILIZEID
      ,T14.FNames FSTERILIZER
      ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
      ,T10.BEGINDATE FSTERILIZEDATE
      ,T15.FNames FSCHECKER
      --,T10.LOGID
      ,T16.TYPENAME FSTERILIZERESULT
      ,CASE nvl(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END FSTERILIZETYPE
      ,T12.OPID FPROVIDEID,T17.FNames FPROVIDER,T12.PROVIDEDATE,T12.ORGID FPROVIDERORGID,T18.NAME FPROVIDERORG
      ,D.DEVICENAME,FR.OPID ,AWR.FNAMES FRECYCLER,awp.FNames FPACKAGER,awC.FNames FCHECKER,T1.FPACKAGENAME
      ,BTP.TypeName as IsBPCDOK
      ,T1.FPatient
      ,T1.InDisinfectPrice as INDISINFECTPRICE
      ,nvl(T1.IsChecked,0) as ISCHECKED
      ,T1.PackageInCode as PACKAGEINCODE
      ,T2.SubPackageQty as SUBPACKAGEQTY
      ,T1.DisabledReason
      
      ,T5.RecycleDate --回收时间
      ,Disinfect.FNames as DisinfectName --清洗人
      ,fd.DisinfectDate --清洗时间
      ,DisinfectDevices.DeviceName as DisinfectDeviceName --清洗设备
      ,dul.TODAYUSETIMES as DisinfectToDayUseTimes --清洗锅次
      ,T3.Barcode as PackageBarcode --条码
      ,againRecycleName.FNames as AgainRecycleName --再次回收人
      ,T1.AgainRecycleDate --再次回收时间
      ,againDisinfectName.FNames as AgainDisinfectName --再次清洗人
      ,T1.AgainDisinfectDate --再次清洗时间
      ,T1.AgainBarcode --新条码
      ,returnName.FNames as ReturnName --归还人
      ,ous.Name as ForgName --发放科室
      
      FROM FLOWPACKAGEIN T1
      INNER JOIN FLOWPACKAGELIST T2 ON T2.FPACKAGEID=T1.FPACKAGEID
      LEFT JOIN STORAGELIST T3 ON T3.STORAGEID=T2.STORAGEID
      LEFT JOIN FLOWRECYCLELIST T4 ON T4.PACKAGEID=T2.PACKAGEID
      LEFT JOIN FLOWRECYCLE T5 ON T5.FRECYCLEID=T4.FRECYCLEID
      
      /*----*/
      left join FlowDisinfectContainerList fdc on T5.FRecycleID=fdc.FRecycleID
      left join FlowDisinfect fd on fdc.FDisinfectID=fd.FDisinfectID
      left join DevicesUseLog dul on fd.LogID=dul.LogID
      left join Devices DisinfectDevices on dul.DeviceID=DisinfectDevices.DeviceID
      left join AC_WorkGroup Disinfect on dul.UserID=Disinfect.FID
      left join AC_WorkGroup againRecycleName on T1.AgainRecycleID=againRecycleName.FID
      left join AC_WorkGroup againDisinfectName  on T1.AgainDisinfectID=againDisinfectName.FID
      left join AC_WorkGroup returnName on T1.ReturnOPID=returnName.FID
      /*----*/
      
      LEFT JOIN AC_WorkGroup T6 ON T6.FID=T5.OPID
      LEFT JOIN CARGOTYPE T7 ON T7.CARGOTYPEID=T1.CARGOTYPEID
      --LEFT JOIN FLOWRECYCLECONTAINER T8 ON T8.FRECYCLEID=T5.FRECYCLEID
      LEFT JOIN FLOWSTERILIZATIONLIST T9 ON T9.PACKAGEID=T2.PACKAGEID
      LEFT JOIN DEVICESUSELOG T10 ON T10.LOGID=T9.STERILIZATIONLOGID
      LEFT JOIN FLOWPROVIDELIST T11 ON T11.PACKAGEID=T2.PACKAGEID
      LEFT JOIN FLOWPROVIDE T12 ON T12.PROVIDEID=T11.PROVIDEID
      LEFT JOIN AC_WorkGroup T14 ON T14.FID=T10.USERID
      LEFT JOIN AC_WorkGroup T15 ON T15.FID=T10.CHECKID
      LEFT JOIN (SELECT TYPEVALUE,TYPENAME FROM SYSTEMTYPEPARAMETER WHERE TYPEKEY='QualifiedNO') T16 ON T16.TYPEVALUE=T2.BADFLAG
      LEFT JOIN AC_WorkGroup T17 ON T17.FID=T12.OPID
      LEFT JOIN AC_ORG T18 ON T18.ID=T12.ORGID
      left join Ac_Org ous on ous.ID=T12.FlowOrgID
      LEFT JOIN AC_ORG O ON T1.SENDER = O.ID
      INNER JOIN AC_WorkGroup U ON T1.OPID = U.FID
      Left join Devices d on d.DeviceID=t10.DeviceID
      left join FlowRecycleList frl on frl.PackageID =t2.PackageID
      left join FlowRecycle fr on fr.FRecycleID=frl.FRecycleID
      left join AC_WorkGroup awR on awr.FID=fr.OPID
      left join AC_WorkGroup awP on awp.FID=t1.packagerID
      left join AC_WorkGroup awC on awc.FID=t2.CheckID
      LEFT JOIN SYSTEMTYPEPARAMETER BTP ON ( T10.IsBPCDOK =  BTP.TYPEVALUE AND BTP.TYPEKEY = 'IsOK')
      WHERE 1=1 and nvl(T1.IsDisabled,0)<>1 {0}
      GROUP by T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
      T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
      T1.RETURNMEMO,O.NAME  ,U.FNames ,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
      --,T3.BARCODE,T3.STATUS FRECYCLESTATUS
      ,T5.OPID,T6.FNames
      ,T7.CARGOTYPENAME
      --,T8.LASTFDISINFECTID
      --,T10.USERID FSTERILIZEID
      ,T14.FNames
      ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
      ,T10.BEGINDATE
      ,T15.FNames
      --,T10.LOGID
      ,T16.TYPENAME
      ,CASE nvl(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END
      ,T12.OPID  ,T17.FNames ,T12.PROVIDEDATE,T12.ORGID  ,T18.NAME
      ,D.DEVICENAME,FR.OPID ,AWR.FNAMES  ,awp.FNames  ,awC.FNames  ,T1.FPACKAGENAME
      ,BTP.TypeName
      ,T1.FPatient
      ,T1.InDisinfectPrice
      ,T1.IsChecked
      ,T1.PackageInCode
      ,T2.SubPackageQty
      ,T1.DisabledReason
      
      ,T5.RecycleDate
      ,Disinfect.FNames
      ,fd.DisinfectDate
      ,againRecycleName.FNames 
      ,T1.AgainRecycleDate
      ,T3.Barcode
      ,T1.AgainBarcode
      ,againDisinfectName.FNames
      ,T1.AgainDisinfectDate
      ,returnName.FNames
      ,ous.Name
      ,DisinfectDevices.DeviceName
      ,dul.TODAYUSETIMES
    ]]>
    </Content>
    
    //临床科室下 回收发放情况
    <Content Key="ClinicalGetRecycleProvide" Desc="临床科室下回收发放情况" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      SELECT SHOWDATA.WORKDATE,SHOWDATA.ORGID,SHOWDATA.ORGNAME,SHOWDATA.CARGOTYPEID,C.CargoTypeName AS CARGOTYPENAME,
      CK.KindName AS KINDNAME,SHOWDATA.SENDERNAME,SHOWDATA.RECIPIENTUSERNAME,SHOWDATA.RECYCLEQTY,SHOWDATA.PROVIDEQTY
      FROM
      (
      SELECT
      RESULTDATA.ORGID,RESULTDATA.ORGNAME,RESULTDATA.CARGOTYPEID,
      RESULTDATA.WORKDATE AS WORKDATE,
      MAX(RESULTDATA.SENDERNAME)AS SENDERNAME,
      MAX(RESULTDATA.RECIPIENTUSERNAME) AS RECIPIENTUSERNAME,
      SUM(RESULTDATA.RECYCLEQTY) AS RECYCLEQTY,
      SUM(RESULTDATA.PROVIDEQTY) AS PROVIDEQTY
      FROM
      (
      SELECT
      AO.ID AS ORGID,
      AO.Name AS ORGNAME,
      FPL.CargoTypeID AS CARGOTYPEID,
      SU.FNames AS SENDERNAME,
      '' AS RECIPIENTUSERNAME,
      CAST(Convert(varchar(10),FR.RecycleDate,120) as datetime) AS WORKDATE,
      COUNT(1) AS  RECYCLEQTY,
      0 AS PROVIDEQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      left join AC_WorkGroup SU on SU.FID = FR.SenderID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      INNER JOIN StorageList SL ON FPL.StorageID = SL.StorageID
      LEFT JOIN Warehouse W ON SL.WarehouseID = W.WarehouseID
      LEFT JOIN AC_Org  AO  ON W.OrgID = AO.ID
      where 1=1 {0}
      GROUP BY AO.ID,AO.Name,SU.FNames ,FPL.CargoTypeID,CAST(Convert(varchar(10),FR.RecycleDate,120) as datetime)
      UNION ALL
      SELECT
      AO.ID AS ORGID,
      AO.Name AS ORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      '' AS SENDERNAME,
      ISNULL(FP.Recipient,'') AS RECIPIENTUSERNAME,
      CAST(Convert(varchar(10),FP.PROVIDEDATE,120) as datetime) AS WORKDATE,
      0 AS  RECYCLEQTY,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
      where 1=1 {1}
      GROUP BY AO.ID,FP.OrgID,AO.Name,FP.Recipient,
      FPL.CargoTypeID,CAST(Convert(varchar(10),FP.PROVIDEDATE,120) as datetime)
      ) RESULTDATA
      GROUP BY RESULTDATA.ORGID,RESULTDATA.ORGNAME,RESULTDATA.CARGOTYPEID,RESULTDATA.WORKDATE

      ) SHOWDATA
      LEFT JOIN CargoType C ON SHOWDATA.CARGOTYPEID = C.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON C.CargoTypeKind = CK.ID
      ORDER BY SHOWDATA.WORKDATE,SHOWDATA.ORGNAME,CK.KINDNAME,C.CargoTypeName  DESC
    </Content>

    //临床科室下 回收发放情况
    <Content Key="ClinicalGetRecycleProvide" Desc="临床科室下回收发放情况" DataBaseType="Oracle">
      SELECT SHOWDATA.WORKDATE,SHOWDATA.ORGID,SHOWDATA.ORGNAME,SHOWDATA.CARGOTYPEID,C.CargoTypeName AS CARGOTYPENAME,
      CK.KindName AS KINDNAME,SHOWDATA.SENDERNAME,SHOWDATA.RECIPIENTUSERNAME,SHOWDATA.RECYCLEQTY,SHOWDATA.PROVIDEQTY
      FROM
      (
      SELECT
      RESULTDATA.ORGID,RESULTDATA.ORGNAME,RESULTDATA.CARGOTYPEID,
      RESULTDATA.WORKDATE AS WORKDATE,
      MAX(RESULTDATA.SENDERNAME)AS SENDERNAME,
      MAX(RESULTDATA.RECIPIENTUSERNAME) AS RECIPIENTUSERNAME,
      SUM(RESULTDATA.RECYCLEQTY) AS RECYCLEQTY,
      SUM(RESULTDATA.PROVIDEQTY) AS PROVIDEQTY
      FROM
      (
      SELECT
      AO.ID AS ORGID,
      AO.Name AS ORGNAME,
      FPL.CargoTypeID AS CARGOTYPEID,
      SU.FNames AS SENDERNAME,
      '' AS RECIPIENTUSERNAME,
      to_date(to_char(FR.RECYCLEDATE,'YYYY-MM-DD'),'YYYY-MM-DD') AS WORKDATE,
      COUNT(1) AS  RECYCLEQTY,
      0 AS PROVIDEQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      left join AC_WorkGroup SU on SU.FID = FR.SenderID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      INNER JOIN StorageList SL ON FPL.StorageID = SL.StorageID
      LEFT JOIN Warehouse W ON SL.WarehouseID = W.WarehouseID
      LEFT JOIN AC_Org  AO  ON W.OrgID = AO.ID
      where 1=1 {0} 
      GROUP BY AO.ID,AO.Name,SU.FNames ,FPL.CargoTypeID,to_date(to_char(FR.RECYCLEDATE,'YYYY-MM-DD'),'YYYY-MM-DD') 
      UNION ALL
      SELECT
      AO.ID AS ORGID,
      AO.Name AS ORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      '' AS SENDERNAME,
      nvl(FP.Recipient,'') AS RECIPIENTUSERNAME,
       to_date(to_char(FP.PROVIDEDATE,'YYYY-MM-DD'),'YYYY-MM-DD') AS WORKDATE,
      0 AS  RECYCLEQTY,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
     where 1=1  {1}
      GROUP BY AO.ID,FP.OrgID,AO.Name,FP.Recipient,
      FPL.CargoTypeID,to_date(to_char(FP.PROVIDEDATE,'YYYY-MM-DD'),'YYYY-MM-DD')
      ) RESULTDATA
      GROUP BY RESULTDATA.ORGID,RESULTDATA.ORGNAME,RESULTDATA.CARGOTYPEID,RESULTDATA.WORKDATE

      ) SHOWDATA
      LEFT JOIN CargoType C ON SHOWDATA.CARGOTYPEID = C.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON C.CargoTypeKind = CK.ID
      ORDER BY SHOWDATA.WORKDATE,SHOWDATA.ORGNAME,CK.KINDNAME,C.CargoTypeName  DESC
    </Content>
    
    <Content Key="GetRecycleProvide" Desc="回收发放情况" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      WITH RecycleProvide(ORGID,ORGNAME,USERORGNAME,CARGOTYPEID,CARGOTOPTYPETEXT,CARGOTYPEKINDTEXT,CARGOTYPETEXT,RECYCLEDATE,RECYCLEQTY,PROVIDEQTY)
      AS
      (
      SELECT
      Recycle.ORGID,Recycle.ORGNAME,Recycle.USERORGNAME,Recycle.CARGOTYPEID,CARGOTOPTYPETEXT,CARGOTYPEKINDTEXT,CARGOTYPETEXT,Recycle.RECYCLEDATE,ISNULL(RECYCLEQTY,0) RECYCLEQTY,ISNULL(PROVIDEQTY,0) PROVIDEQTY
      FROM
      (
      SELECT
      AO.ID ORGID,
      AO.Name  ORGNAME,
      uorg.Name USERORGNAME,
      FPL.CargoTypeID  CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      CAST(Convert(varchar(10),FR.RecycleDate,120) as datetime) RECYCLEDATE,
      SUM(1)  RECYCLEQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      LEFT join AC_OrgUser on AC_OrgUser .UserID =FR.OPID
      LEFT join AC_Org uorg on uorg.ID =AC_OrgUser.OrgID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      LEFT JOIN view_CargoType  CT  ON FPL.CargoTypeID = CT.CargoTypeID
      INNER JOIN StorageList SL ON FPL.StorageID = SL.StorageID
      LEFT JOIN Warehouse W ON SL.WarehouseID = W.WarehouseID
      LEFT JOIN AC_Org  AO  ON W.OrgID = AO.ID
      where 1=1 {0}
      GROUP BY AO.ID,W.OrgID,AO.Name,uorg.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,CAST(Convert(varchar(10),FR.RecycleDate,120) as datetime)
      ) Recycle

      LEFT JOIN
      (
      SELECT
      AO.ID ORGID,
      AO.Name ORGNAME,
      uorg1.Name USERORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      CAST(Convert(varchar(10),FP.PROVIDEDATE,120) as datetime) RECYCLEDATE,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      LEFT join AC_OrgUser on AC_OrgUser.UserID=FP .OPID
      LEFT join AC_Org uorg1 on uorg1 .ID =AC_OrgUser.OrgID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN PackageType PT ON FPL.PackageTypeID = PT.PTypeID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where 1=1 {1}
      GROUP BY AO.ID,FP.OrgID,AO.Name,uorg1.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,CAST(Convert(varchar(10),FP.PROVIDEDATE,120) as datetime)

      ) Provide ON Recycle.CARGOTYPEID=Provide.CARGOTYPEID AND Recycle.ORGID = Provide.ORGID AND Recycle.RECYCLEDATE = Provide.RECYCLEDATE
      )

      SELECT * FROM RecycleProvide
      ORDER BY RecycleDate DESC
    </Content>
    
    <Content Key="GetRecycleProvide" Desc="回收发放情况" DataBaseType="Oracle">
      WITH RecycleProvide
      AS
      (
      SELECT
      Recycle.ORGID,Recycle.ORGNAME,Recycle.USERORGNAME,Recycle.CARGOTYPEID,CARGOTOPTYPETEXT,CARGOTYPEKINDTEXT,CARGOTYPETEXT,Recycle.RECYCLEDATE,nvl(RECYCLEQTY,0) RECYCLEQTY,nvl(PROVIDEQTY,0) PROVIDEQTY
      FROM
      (
      SELECT
      AO.ID ORGID,
      AO.Name  ORGNAME,
      uorg.Name USERORGNAME,
      FPL.CargoTypeID  CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      to_date(to_char(FR.RECYCLEDATE,'YYYY-MM-DD'),'YYYY-MM-DD') RECYCLEDATE,
      SUM(1)  RECYCLEQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      LEFT JOIN AC_OrgUser on AC_OrgUser .UserID =FR.OPID
      LEFT JOIN AC_Org uorg on uorg.ID =AC_OrgUser.OrgID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      LEFT JOIN view_CargoType  CT  ON FPL.CargoTypeID = CT.CargoTypeID
      INNER JOIN StorageList SL ON FPL.StorageID = SL.StorageID
      LEFT JOIN Warehouse W ON SL.WarehouseID = W.WarehouseID
      LEFT JOIN AC_Org  AO  ON W.OrgID = AO.ID
      where 1=1 {0}
      GROUP BY AO.ID,W.OrgID,AO.Name,uorg.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,to_date(to_char(FR.RECYCLEDATE,'YYYY-MM-DD'),'YYYY-MM-DD')
      ) Recycle

      LEFT JOIN
      (
      SELECT
      AO.ID ORGID,
      AO.Name ORGNAME,
      uorg1.Name USERORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      to_date(to_char(FP.PROVIDEDATE,'YYYY-MM-DD'),'YYYY-MM-DD') RECYCLEDATE,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      LEFT JOIN AC_OrgUser on AC_OrgUser.UserID=FP .OPID
      LEFT JOIN AC_Org uorg1 on uorg1 .ID =AC_OrgUser.OrgID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN PackageType PT ON FPL.PackageTypeID = PT.PTypeID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where 1=1 {1}
      GROUP BY AO.ID,FP.OrgID,AO.Name,uorg1.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,to_date(to_char(FP.PROVIDEDATE,'YYYY-MM-DD'),'YYYY-MM-DD')

      ) Provide ON Recycle.CARGOTYPEID=Provide.CARGOTYPEID AND Recycle.ORGID = Provide.ORGID AND Recycle.RECYCLEDATE = Provide.RECYCLEDATE
      )

      SELECT * FROM RecycleProvide
      ORDER BY RecycleDate DESC
    </Content>
    
    <Content Key="GetProvideTotal" Desc="发放统计报表" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      WITH ProvideTotal(ORGID,ORGNAME,CARGOTYPEID,CARGOTOPTYPETEXT,CARGOTYPEKINDTEXT,CARGOTYPETEXT,PROVIDEDATE,PROVIDEQTY)
      AS
      (
      SELECT
      Provide.ORGID,
      Provide.ORGNAME,
      Provide.CARGOTYPEID,
      Provide.CARGOTOPTYPETEXT,
      Provide.CARGOTYPEKINDTEXT,
      Provide.CARGOTYPETEXT,
      Provide.PROVIDEDATE,
      Provide.PROVIDEQTY
      FROM  (
      (SELECT
      AO.ID ORGID,
      AO.Name ORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      FP.ProvideDate PROVIDEDATE,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN PackageType PT ON FPL.PackageTypeID = PT.PTypeID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      GROUP BY AO.ID,AO.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,FP.ProvideDate
      )
      UNION ALL
      (
      SELECT
      AO.ID ORGID,
      AO.Name ORGNAME, --区域
      OL.CargoTypeID CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      SO.OutDate PROVIDEDATE,
      OL.Quantity PROVIDEQTY
      FROM StorageOutList OL
      INNER JOIN StorageOut SO ON SO.OutID=OL.OutID
      LEFT JOIN view_CargoType CT ON CT.CargoTypeID=OL.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID=SO.OrgID
      GROUP BY AO.ID,AO.Name,OL.CargoTypeID,CT.CargoTopTypeText,CT.CargoTypeKindText,
      CT.CargoTypeText,OL.Quantity,SO.OutDate
      )
      ) Provide
      )

      SELECT * FROM ProvideTotal  WHERE 1=1 {0} ORDER BY PROVIDEDATE DESC
    </Content>
    <Content Key="GetProvideTotal" Desc="发放统计报表" DataBaseType="Oracle">
      WITH ProvideTotal
      AS
      (
      SELECT
      Provide.ORGID,
      Provide.ORGNAME,
      Provide.CARGOTYPEID,
      Provide.CARGOTOPTYPETEXT,
      Provide.CARGOTYPEKINDTEXT,
      Provide.CARGOTYPETEXT,
      Provide.PROVIDEDATE,
      Provide.PROVIDEQTY
      FROM  (
      (SELECT
      AO.ID ORGID,
      AO.Name ORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      FP.ProvideDate PROVIDEDATE,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN PackageType PT ON FPL.PackageTypeID = PT.PTypeID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      GROUP BY AO.ID,AO.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,FP.ProvideDate
      )
      UNION ALL
      (
      SELECT
      AO.ID ORGID,
      AO.Name ORGNAME, --区域
      OL.CargoTypeID CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      SO.OutDate PROVIDEDATE,
      OL.Quantity PROVIDEQTY
      FROM StorageOutList OL
      INNER JOIN StorageOut SO ON SO.OutID=OL.OutID
      LEFT JOIN view_CargoType CT ON CT.CargoTypeID=OL.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID=SO.OrgID
      GROUP BY AO.ID,AO.Name,OL.CargoTypeID,CT.CargoTopTypeText,CT.CargoTypeKindText,
      CT.CargoTypeText,OL.Quantity,SO.OutDate
      )
      ) Provide
      )

      SELECT * FROM ProvideTotal WHERE 1=1 {0} ORDER BY PROVIDEDATE DESC
    </Content>

    <Content Key="GetProvideTotal_BDYY" Desc="发放统计报表" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      WITH ProvideTotal(ORGID,PREORGNAME,ORGNAME,CARGOTYPEID,CARGOTOPTYPETEXT,CARGOTYPEKINDTEXT,CARGOTYPETEXT,PROVIDEDATE,PROVIDEQTY)
      AS
      (
      SELECT
      Provide.ORGID,
      Provide.PREORGNAME,
      Provide.ORGNAME,
      Provide.CARGOTYPEID,
      Provide.CARGOTOPTYPETEXT,
      Provide.CARGOTYPEKINDTEXT,
      Provide.CARGOTYPETEXT,
      Provide.PROVIDEDATE,
      Provide.PROVIDEQTY
      FROM  (
      (SELECT
      AO.ID ORGID,
      PreOrg.name PREORGNAME,
      AO.Name ORGNAME,
      FPL.CargoTypeID CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      FP.ProvideDate PROVIDEDATE,
      COUNT(1)  PROVIDEQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      LEFT JOIN PackageType PT ON FPL.PackageTypeID = PT.PTypeID
      LEFT JOIN AC_ORG AO ON FP.OrgID = AO.ID
      LEFT JOIN AC_Org AS PreOrg ON AO.PrevID = PreOrg.ID
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      GROUP BY AO.ID,PreOrg.name,AO.Name,FPL.CargoTypeID,CT.CargoTopTypeText,
      CT.CargoTypeKindText,CT.CargoTypeText,FP.ProvideDate
      )
      UNION ALL
      (
      SELECT
      AO.ID ORGID,
      PreOrg.name PREORGNAME,
      AO.Name ORGNAME, --区域
      OL.CargoTypeID CARGOTYPEID,
      CT.CargoTopTypeText  CARGOTOPTYPETEXT,
      CT.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CT.CargoTypeText  CARGOTYPETEXT,
      SO.OutDate PROVIDEDATE,
      OL.Quantity PROVIDEQTY
      FROM StorageOutList OL
      INNER JOIN StorageOut SO ON SO.OutID=OL.OutID
      LEFT JOIN view_CargoType CT ON CT.CargoTypeID=OL.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID=SO.OrgID
      LEFT JOIN AC_Org AS PreOrg ON AO.PrevID = PreOrg.ID
      GROUP BY AO.ID,PreOrg.name,AO.Name,OL.CargoTypeID,CT.CargoTopTypeText,CT.CargoTypeKindText,
      CT.CargoTypeText,OL.Quantity,SO.OutDate
      )
      ) Provide
      )

      SELECT * FROM ProvideTotal  WHERE 1=1 {0} ORDER BY PROVIDEDATE DESC
    </Content>
    <Content Key="ReportBadPackageSummary" Desc="不合格包统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      select * from
      (
      select
      o.Name as AREA
      ,ck.KINDNAME--类别
      ,c.CARGOTYPENAME--包类型
      ,pt.PNAME--外包装
      ,fl.BADFLAGDATE --不合格时间
      ,dbo.fun_get_BadFlagReason(fl.BadFlagReason) as BADREASON  -- 坏包原因
      ,SUM(1) as QTY --数量
      ,ISNULL(c.Amount,0.00) AS UNITPRICE--单价
      ,ISNULL(c.Amount,0.00) * COUNT(fp.PackageID) AS TOTALPRICE --总价
      ,fl.FLOWORGID
      from FlowPackageList fl
      inner join FlowPackage f on fl.FPackageID = f.FPackageID
      left join FlowProvideList fp on fp.PackageID = fl.PackageID
      inner join StorageList sl on fl.StorageID = sl.StorageID
      left join CargoType c on sl.CargoTypeID = c.CargoTypeID
      left join CargoTypeKind ck on c.CargoTypeKind = ck.ID
      left join PackageType pt on fl.PackageTypeID = pt.PTypeID
      left join Warehouse w on w.WarehouseID   = sl.WarehouseID
      left join AC_Org o on o.ID=w.OrgID
      where fl.BadFlag = 1
      group by o.Name,ck.KindName,
      c.CargoTypeName,
      pt.PName,
      fl.BadFlagDate,
      dbo.fun_get_BadFlagReason(fl.BadFlagReason),c.Amount,fl.FLOWORGID
      ) BAD where 1=1 {0}
    </Content>
    <Content Key="ReportBadPackageSummary" Desc="不合格包统计" DataBaseType="Oracle">
      select * from
      (
      select
      o.Name as AREA
      ,ck.KINDNAME--类别
      ,c.CARGOTYPENAME--包类型
      ,pt.PNAME--外包装
      ,fl.BADFLAGDATE --不合格时间
      ,fun_get_BadFlagReason(fl.BadFlagReason) as BADREASON  -- 坏包原因
      ,SUM(1) as QTY --数量
      ,nvl(c.Amount,0.00) AS UNITPRICE--单价
      ,nvl(c.Amount,0.00) * COUNT(fp.PackageID) AS TOTALPRICE --总价
      ,fl.FLOWORGID
      from FlowPackageList fl
      inner join FlowPackage f  on fl.FPackageID = f.FPackageID
      left join FlowProvideList fp on fp.PackageID = fl.PackageID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      left join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      left join CargoTypeKind ck  on c.CargoTypeKind = ck.ID
      left join PackageType pt  on fl.PackageTypeID = pt.PTypeID
      left join Warehouse  w  on w.WarehouseID   = sl.WarehouseID
      left join AC_Org o   on o.ID=w.OrgID
      where fl.BadFlag = 1
      group by o.Name,ck.KindName,
      c.CargoTypeName,
      pt.PName,
      fl.BadFlagDate,
      fun_get_BadFlagReason(fl.BadFlagReason),c.Amount,fl.FLOWORGID
      ) BAD where 1=1  {0}
    </Content>

    <Content Key="ReportBadFlagReasonA" Desc="不合格包原因统计" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
     select o.Name as ORG_NAME ,CargoTypeKind.KindName C_KINDNAME,sl.BARCODE,c.CargoTypeName C_TYPENAME, sl.QUANTITY, fl.BADFLAGDATE, dbo.fun_get_BadFlagReason(fl.BadFlagReason) BADFLAGREASON
      from FlowPackageList fl WITH (NOLOCK)
      inner join StorageList sl WITH (NOLOCK) on fl.StorageID=sl.StorageID
      left join CargoType c WITH (NOLOCK) on fl.CargoTypeID=c.CargoTypeID
      left join CargoTypeKind WITH (NOLOCK) on c.CargoTypeKind=CargoTypeKind.ID
      left join AC_Org o WITH (NOLOCK) on CargoTypeKind.OrgID=o.ID
      where fl.BadFlag > 0 and BadFlagDate between @begindate and @enddate
       ]]>
    </Content>

    <Content Key="ReportBadFlagReasonB" Desc="不合格包原因统计" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
     select o.Name as ORG_NAME ,CargoTypeKind.KindName C_KINDNAME,sl.BARCODE,c.CargoTypeName C_TYPENAME, sl.QUANTITY, fl.BADFLAGDATE, dbo.fun_get_BadFlagReason(fl.BadFlagReason) BADFLAGREASON
      from FlowPackageList fl WITH (NOLOCK)
      inner join StorageList sl WITH (NOLOCK) on fl.StorageID=sl.StorageID
      left join CargoType c WITH (NOLOCK) on fl.CargoTypeID=c.CargoTypeID
      left join CargoTypeKind WITH (NOLOCK) on c.CargoTypeKind=CargoTypeKind.ID
      left join AC_Org o WITH (NOLOCK) on CargoTypeKind.OrgID=o.ID
      where fl.BadFlag > 0 and BadFlagDate between @begindate and @enddate and o.ID=@userid
       ]]>

    </Content>
    <Content Key="ReportBadFlagReasonB" Desc="不合格包原因统计" DataBaseType="Oracle">
      <![CDATA[
     select o.Name as ORG_NAME ,CargoTypeKind.KindName C_KINDNAME,sl.BARCODE,c.CargoTypeName C_TYPENAME, sl.QUANTITY, fl.BADFLAGDATE, dbo.fun_get_BadFlagReason(fl.BadFlagReason) BADFLAGREASON
      from FlowPackageList fl WITH (NOLOCK)
      inner join StorageList sl WITH (NOLOCK) on fl.StorageID=sl.StorageID
      left join CargoType c WITH (NOLOCK) on fl.CargoTypeID=c.CargoTypeID
      left join CargoTypeKind WITH (NOLOCK) on c.CargoTypeKind=CargoTypeKind.ID
      left join AC_Org o WITH (NOLOCK) on CargoTypeKind.OrgID=o.ID
      where fl.BadFlag > 0 and BadFlagDate between  :begindate  and  :enddate  and o.ID=:userid
       ]]>

    </Content>

    <Content Key="ReportBadFlagReasonA" Desc="不合格包原因统计" DataBaseType="Oracle">
      <![CDATA[
       select o.Name as ORG_NAME ,CargoTypeKind.KindName C_KINDNAME,sl.BARCODE,c.CargoTypeName C_TYPENAME, sl.QUANTITY, fl.BADFLAGDATE, dbo.fun_get_BadFlagReason(fl.BadFlagReason) BADFLAGREASON
      from FlowPackageList fl WITH (NOLOCK)
      inner join StorageList sl WITH (NOLOCK) on fl.StorageID=sl.StorageID
      left join CargoType c WITH (NOLOCK) on fl.CargoTypeID=c.CargoTypeID
      left join CargoTypeKind WITH (NOLOCK) on c.CargoTypeKind=CargoTypeKind.ID
      left join AC_Org o WITH (NOLOCK) on CargoTypeKind.OrgID=o.ID
      where fl.BadFlag > 0 and BadFlagDate between  :begindate  and  :enddate
       ]]>
    </Content>

	          <Content Key="ReportBadCleanContainerReason" Desc="网篮清洗不合格原因统计" DataBaseType="SqlServer">
		          <![CDATA[ 
	        select c.CONTAINERNAME,ct.CARGOTYPENAME
        ,d.DEVICEID,d.DEVICENAME,dpr.RULENAME,fdf.DISINFECTDATE,
        ou.FNames NAME ,cu.FNames CNAME,dl.TodayUseTimes TODAYUSETIMES
        ,case when   fl.Status=1 then '合格'  when fl.Status=-1 then '不合格'  when  fl.Status=2 then '部分合格'  end as QUALIFIEDTRUE     
        ,fl.CHECKDATE,fd.FQTY,fd.FBADREASON 
        from FlowDisinfectContainerList fl
        left join FlowDisinfectCheckDetail fd on fd.FParentID =fl.ContainerDisinfectLogID 
        left join CargoType ct on ct.CargoTypeID =fd.FCargotypeID 
        left join Container c on c.ContainerID =fl.ContainerID
        left join FlowDisinfect fdf on fl.FDisinfectID=fdf.FDisinfectID
        inner join DevicesUseLog dl  on fdf.LogID = dl.Logid
        inner join Devices d  on dl.DeviceID = d.deviceid
        left join DeviceProcessRule dpr on dl.DeviceProcessRuleID=dpr.RuleID
        inner join AC_WorkGroup ou  on dl.UserID= ou.FID
        left join AC_WorkGroup cu  on fl.CheckID= cu.FID 
        where  fl.Status in (-1,2) {0}
        order by CheckDate desc
         ]]>
	          </Content>
	          <Content Key="ReportBadCleanContainerReason" Desc="网篮清洗不合格原因统计" DataBaseType="Oracle">
		          <![CDATA[ 
	        select c.CONTAINERNAME,ct.CARGOTYPENAME
        ,d.DEVICEID,d.DEVICENAME,dpr.RULENAME,fdf.DISINFECTDATE,
        ou.FNames NAME ,cu.FNames CNAME ,dl.TodayUseTimes TODAYUSETIMES
        ,case when   fl.Status=1 then '合格'  when fl.Status=-1 then '不合格'  when  fl.Status=2 then '部分合格'  end as QUALIFIEDTRUE     
        ,fl.CHECKDATE,fd.FQTY,fd.FBADREASON 
        from FlowDisinfectContainerList fl
        left join FlowDisinfectCheckDetail fd on fd.FParentID =fl.ContainerDisinfectLogID 
        left join CargoType ct on ct.CargoTypeID =fd.FCargotypeID 
        left join Container c on c.ContainerID =fl.ContainerID
        left join FlowDisinfect fdf on fl.FDisinfectID=fdf.FDisinfectID
        inner join DevicesUseLog dl  on fdf.LogID = dl.Logid
        inner join Devices d  on dl.DeviceID = d.deviceid
        left join DeviceProcessRule dpr on dl.DeviceProcessRuleID=dpr.RuleID
        inner join AC_WorkGroup ou  on dl.UserID= ou.FID
        left join AC_WorkGroup cu  on fl.CheckID= cu.FID 
        where  fl.Status in (-1,2) {0}
        order by CheckDate desc
         ]]>
	          </Content>

            <Content Key="ReportBadCleanContainerReason_ZZ" Desc="网篮清洗不合格原因统计" DataBaseType="SqlServer">
              <![CDATA[ 
	       select c.CONTAINERNAME,ct.CARGOTYPENAME
        ,d.DEVICEID,d.DEVICENAME,dpr.RULENAME,fdf.DISINFECTDATE,
        ou.FNames NAME ,cu.FNames CNAME 
        ,case when   fl.Status=1 then '合格'  when fl.Status=-1 then '不合格'  when  fl.Status=2 then '部分合格'  end as QUALIFIEDTRUE     
        ,fl.CHECKDATE,fd.FQTY,fd.FBADREASON 
        ,dl.TodayUseTimes as TODAYUSETIMES
        from FlowDisinfectContainerList fl
        left join FlowDisinfectCheckDetail fd on fd.FParentID =fl.ContainerDisinfectLogID 
        left join CargoType ct on ct.CargoTypeID =fd.FCargotypeID 
        left join Container c on c.ContainerID =fl.ContainerID
        left join FlowDisinfect fdf on fl.FDisinfectID=fdf.FDisinfectID
        inner join DevicesUseLog dl  on fdf.LogID = dl.Logid
        inner join Devices d  on dl.DeviceID = d.deviceid
        left join DeviceProcessRule dpr on dl.DeviceProcessRuleID=dpr.RuleID
        inner join AC_WorkGroup ou  on dl.UserID= ou.FID
        left join AC_WorkGroup cu  on fl.CheckID= cu.FID 
        where  fl.Status in (-1,2) {0}
        order by d.DeviceName,CheckDate desc
         ]]>
            </Content>
            <Content Key="ReportBadCleanContainerReason_ZZ" Desc="网篮清洗不合格原因统计" DataBaseType="Oracle">
              <![CDATA[ 
	        select c.CONTAINERNAME,ct.CARGOTYPENAME
        ,d.DEVICEID,d.DEVICENAME,dpr.RULENAME,fdf.DISINFECTDATE,
        ou.FNames NAME ,cu.FNames CNAME 
        ,case when   fl.Status=1 then '合格'  when fl.Status=-1 then '不合格'  when  fl.Status=2 then '部分合格'  end as QUALIFIEDTRUE     
        ,fl.CHECKDATE,fd.FQTY,fd.FBADREASON 
        ,dl.TodayUseTimes as TODAYUSETIMES
        from FlowDisinfectContainerList fl
        left join FlowDisinfectCheckDetail fd on fd.FParentID =fl.ContainerDisinfectLogID 
        left join CargoType ct on ct.CargoTypeID =fd.FCargotypeID 
        left join Container c on c.ContainerID =fl.ContainerID
        left join FlowDisinfect fdf on fl.FDisinfectID=fdf.FDisinfectID
        inner join DevicesUseLog dl  on fdf.LogID = dl.Logid
        inner join Devices d  on dl.DeviceID = d.deviceid
        left join DeviceProcessRule dpr on dl.DeviceProcessRuleID=dpr.RuleID
        inner join AC_WorkGroup ou  on dl.UserID= ou.FID
        left join AC_WorkGroup cu  on fl.CheckID= cu.FID 
        where  fl.Status in (-1,2) {0}
        order by d.DeviceName,CheckDate desc
         ]]>
            </Content>


    <Content Key="Query_GetDisinfectQuantitySum" Desc="查询清洗器械总数" DataBaseType="SqlServer">
      <![CDATA[
     --清洗统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Devices.DeviceName 
      ,isnull(CargoType.InstrumentsNumber,0) * sum(1) AS INSTRUMENTSNUMBER
      FROM
      FlowDisinfect fd
      LEFT JOIN FlowDisinfectContainerList fdc on fd.FDisinfectID=fdc.FDisinfectID
      LEFT JOIN FlowRecycleList ON fdc.FRecycleID=FlowRecycleList.FRecycleID
      LEFT JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      LEFT JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN DEVICESUSELOG  ON DevicesUseLog.LOGID=fd.LogID
      LEFT JOIN Devices ON DevicesUseLog.DeviceID=Devices.DeviceID
      LEFT JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      LEFT JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org  RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup  RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      WHERE 1 = 1 {0}
      GROUP BY
      Devices.DeviceName,
      CargoType.InstrumentsNumber
      order by Devices.DeviceName
      ]]>
    </Content>

    <Content Key="Query_GetDisinfectQuantitySum" Desc="查询清洗器械总数" DataBaseType="Oracle">
      <![CDATA[
      --清洗统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Devices.DeviceName 
      ,nvl(CargoType.InstrumentsNumber,0) * sum(1) AS INSTRUMENTSNUMBER
      FROM
      FlowDisinfect fd
      LEFT JOIN FlowDisinfectContainerList fdc on fd.FDisinfectID=fdc.FDisinfectID
      LEFT JOIN FlowRecycleList ON fdc.FRecycleID=FlowRecycleList.FRecycleID
      LEFT JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      LEFT JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN DEVICESUSELOG  ON DevicesUseLog.LOGID=fd.LogID
      LEFT JOIN Devices ON DevicesUseLog.DeviceID=Devices.DeviceID
      LEFT JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      LEFT JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org  RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup  RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      WHERE 1 = 1 {0}
      GROUP BY
      Devices.DeviceName,
      CargoType.InstrumentsNumber
      order by Devices.DeviceName
      ]]>
    </Content>

    <Content Key="ReportPackageConsumeSummary" Desc="辅料消耗统计" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      SystemTypeParameter.TypeName AS CARGOTOPTYPETEXT, --种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品、器械包
      SUM(FlowPackageCargoList.Quantity)  AS PACKAGEQTY
      FROM  FlowPackageCargoList
      INNER JOIN FlowPackage ON FlowPackageCargoList.FPackageID=FlowPackage.FPackageID
      left JOIN CargoType  ON FlowPackageCargoList.CargoTypeID = CargoType.CargoTypeID
      left JOIN SystemTypeParameter ON CargoType.CargoTopType = SystemTypeParameter.TypeValue AND SystemTypeParameter.TypeKey = 'CargoTopType'
      left JOIN CargoTypeKind ON CargoType.CargoTypeKind = CargoTypeKind.ID
      WHERE CargoType.CargoTopType <> 16 AND CargoType.CargoTopType <> 1
      {0}
      GROUP BY
      SystemTypeParameter.TypeName,CargoTypeKind.KindName,CargoType.CargoTypeName
      ]]>
    </Content>
    <Content Key="ReportPackageConsumeSummary" Desc="辅料消耗统计" DataBaseType="Oracle">
    <![CDATA[
     SELECT
      SystemTypeParameter.TypeName AS CARGOTOPTYPETEXT, --种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品、器械包
      SUM(FlowPackageCargoList.Quantity)  AS PACKAGEQTY
      FROM  FlowPackageCargoList
      INNER JOIN FlowPackage ON FlowPackageCargoList.FPackageID=FlowPackage.FPackageID
      left JOIN CargoType  ON FlowPackageCargoList.CargoTypeID = CargoType.CargoTypeID
      left JOIN SystemTypeParameter ON CargoType.CargoTopType = SystemTypeParameter.TypeValue AND SystemTypeParameter.TypeKey = 'CargoTopType'
      left JOIN CargoTypeKind ON CargoType.CargoTypeKind = CargoTypeKind.ID
      WHERE CargoType.CargoTopType <> 16 AND CargoType.CargoTopType <> 1
      {0}
      GROUP BY
      SystemTypeParameter.TypeName,CargoTypeKind.KindName,CargoType.CargoTypeName
      ]]>
    </Content>


    <Content Key="ReportOrgProvideSummary" Desc="科室发放统计" DataBaseType="SqlServer">
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		SELECT * FROM
		(SELECT AO.Name ORGNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,CT.INCODE,ISNULL(CT.Amount,0) AMOUNT,
		SUM(SL.QUANTITY) QUANTITY,ISNULL(CT.Amount,0)*SUM(SL.QUANTITY) SUMAMOUNT,SO.OutDate PRODATE,AU.FlowOrgID
		FROM StorageOut SO
		INNER JOIN StorageOutList SL ON SO.OutID=SL.OutID
		left JOIN AC_Org AO ON SO.OrgID=AO.ID
		left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		left JOIN AC_WorkGroup ProvideUser  on SO.OPID = ProvideUser.FID
		left JOIN AC_UserWorkGroup WG ON ProvideUser.FID=WG.FGroupID
		left JOIN AC_User AU ON WG.FUserID=AU.ID
		WHERE SO.OutType=6
		GROUP BY  AO.Name,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,AMOUNT,
		QUANTITY,ISNULL(CT.Amount,0)*QUANTITY,SO.OutDate,AU.FlowOrgID
		UNION ALL
		SELECT AO.Name ORGNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,CT.INCODE,ISNULL(CT.Amount,0) AMOUNT,
		SUM(SL.QUANTITY) QUANTITY,ISNULL(CT.Amount,0)*SUM(SL.QUANTITY) SUMAMOUNT,FP.ProvideDate PRODATE,FP.FlowOrgID
		FROM FlowProvide FP
		INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
		INNER JOIN FlowPackageList PL ON FL.PackageID=PL.PackageID
		INNER JOIN StorageList SL ON PL.StorageID=SL.StorageID
		left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		left JOIN AC_Org AO ON FP.OrgID=AO.ID
		GROUP BY  AO.Name,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,AMOUNT,
		QUANTITY,ISNULL(CT.Amount,0)*QUANTITY,FP.ProvideDate,FP.FlowOrgID ) TEMP
		WHERE 1=1  {0}
	</Content>
    <Content Key="ReportOrgProvideSummary" Desc="科室发放统计" DataBaseType="Oracle">
		SELECT * FROM
		(SELECT AO.Name ORGNAME,CT.CargoTypeKindText CARGOTYPEKINDTEXT,CT.CargoTypeText CARGOTYPETEXT,CT.INCODE,nvl(CT.Amount,0) AMOUNT,
		SUM(SL.QUANTITY) QUANTITY,nvl(CT.Amount,0)*SUM(SL.QUANTITY) SUMAMOUNT,SO.OutDate PRODATE,AU.FlowOrgID
		FROM StorageOut SO
		INNER JOIN StorageOutList SL ON SO.OutID=SL.OutID
		left JOIN AC_Org AO ON SO.OrgID=AO.ID
		left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		left JOIN AC_WorkGroup ProvideUser  on SO.OPID = ProvideUser.FID
		left JOIN AC_UserWorkGroup WG ON ProvideUser.FID=WG.FGroupID
		left JOIN AC_User AU ON WG.FUserID=AU.ID
		WHERE SO.OutType=6
		GROUP BY AO.Name,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,AMOUNT,
		QUANTITY,nvl(CT.Amount,0)*QUANTITY ,SO.OutDate,AU.FlowOrgID
		UNION ALL
		SELECT AO.Name ORGNAME,CT.CargoTypeKindText CARGOTYPEKINDTEXT,CT.CargoTypeText CARGOTYPETEXT,CT.INCODE,nvl(CT.Amount,0) AMOUNT,
		SUM(SL.QUANTITY) QUANTITY,nvl(CT.Amount,0)*SUM(SL.QUANTITY) SUMAMOUNT,FP.ProvideDate PRODATE,FP.FlowOrgID
		FROM FlowProvide FP
		INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
		INNER JOIN FlowPackageList PL ON FL.PackageID=PL.PackageID
		INNER JOIN StorageList SL ON PL.StorageID=SL.StorageID
		left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		left JOIN AC_Org AO ON FP.OrgID=AO.ID
		GROUP BY  AO.Name ,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,AMOUNT,
		QUANTITY,nvl(CT.Amount,0)*QUANTITY ,FP.ProvideDate,FP.FlowOrgID ) TEMP
		WHERE 1=1 {0}
	</Content>
	  <Content Key="ReportOrgProvideSummaryPriceUseInLocation" Desc="科室发放统计（一次性物品价格取入库的单价）" DataBaseType="SqlServer">
		  SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		  SELECT * FROM
		  (SELECT AO.Name ORGNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,CT.INCODE,ISNULL(StorageList.Price,0) AMOUNT,
		  SUM(SOLSL.Quantity) QUANTITY,ISNULL(StorageList.Price,0)*SUM(SOLSL.Quantity) SUMAMOUNT,SO.OutDate PRODATE,AU.FlowOrgID
		  FROM StorageOut SO
		  INNER JOIN StorageOutList SL ON SO.OutID=SL.OutID
		  INNER JOIN StorageOutListStorageList SOLSL  WITH (NOLOCK)  on SL.Outlistid= SOLSL.Outlistid
		  LEFT JOIN StorageList  WITH (NOLOCK)   on StorageList.StorageID = SOLSL.StorageID
		  left JOIN AC_Org AO ON SO.OrgID=AO.ID
		  left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		  left JOIN AC_WorkGroup ProvideUser  on SO.OPID = ProvideUser.FID
		  left JOIN AC_UserWorkGroup WG ON ProvideUser.FID=WG.FGroupID
		  left JOIN AC_User AU ON WG.FUserID=AU.ID
		  WHERE SO.OutType=6
		  GROUP BY  AO.Name,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,StorageList.Price,
		  SOLSL.Quantity,ISNULL(StorageList.Price,0)*SOLSL.Quantity,SO.OutDate,AU.FlowOrgID
		  UNION ALL
		  SELECT AO.Name ORGNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,CT.INCODE,ISNULL(CT.Amount,0) AMOUNT,
		  SUM(SL.QUANTITY) QUANTITY,ISNULL(CT.Amount,0)*SUM(SL.QUANTITY) SUMAMOUNT,FP.ProvideDate PRODATE,FP.FlowOrgID
		  FROM FlowProvide FP
		  INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
		  INNER JOIN FlowPackageList PL ON FL.PackageID=PL.PackageID
		  INNER JOIN StorageList SL ON PL.StorageID=SL.StorageID
		  left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		  left JOIN AC_Org AO ON FP.OrgID=AO.ID
		  GROUP BY  AO.Name,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,AMOUNT,
		  QUANTITY,ISNULL(CT.Amount,0)*QUANTITY,FP.ProvideDate,FP.FlowOrgID ) TEMP
		  WHERE 1=1  {0}
	  </Content>
	  <Content Key="ReportOrgProvideSummaryPriceUseInLocation" Desc="科室发放统计（一次性物品价格取入库的单价）" DataBaseType="Oracle">
		  SELECT * FROM
		  (SELECT AO.Name ORGNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,CT.INCODE,nvl(StorageList.Price,0) AMOUNT,
		  SUM(SOLSL.Quantity) QUANTITY,nvl(StorageList.Price,0)*SUM(SOLSL.Quantity) SUMAMOUNT,SO.OutDate PRODATE,AU.FlowOrgID
		  FROM StorageOut SO
		  INNER JOIN StorageOutList SL ON SO.OutID=SL.OutID
		  INNER JOIN StorageOutListStorageList SOLSL  WITH (NOLOCK)  on SL.Outlistid= SOLSL.Outlistid
		  LEFT JOIN StorageList  WITH (NOLOCK)   on StorageList.StorageID = SOLSL.StorageID
		  left JOIN AC_Org AO ON SO.OrgID=AO.ID
		  left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		  left JOIN AC_WorkGroup ProvideUser  on SO.OPID = ProvideUser.FID
		  left JOIN AC_UserWorkGroup WG ON ProvideUser.FID=WG.FGroupID
		  left JOIN AC_User AU ON WG.FUserID=AU.ID
		  WHERE SO.OutType=6
		  GROUP BY  AO.Name,CARGOTYPEKINDTEXT,CARGOTYPETEXT,CT.INCODE,StorageList.Price,
		  SOLSL.Quantity,nvl(StorageList.Price,0)*SOLSL.Quantity,SO.OutDate,AU.FlowOrgID
		  UNION ALL
		  SELECT AO.Name ORGNAME,CT.CargoTypeKindText CARGOTYPEKINDTEXT,CT.CargoTypeText CARGOTYPETEXT,CT.INCODE,nvl(CT.Amount,0) AMOUNT,
		  SUM(SL.QUANTITY) QUANTITY,nvl(CT.Amount,0)*SUM(SL.QUANTITY) SUMAMOUNT,FP.ProvideDate PRODATE,FP.FlowOrgID
		  FROM FlowProvide FP
		  INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
		  INNER JOIN FlowPackageList PL ON FL.PackageID=PL.PackageID
		  INNER JOIN StorageList SL ON PL.StorageID=SL.StorageID
		  left JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
		  left JOIN AC_Org AO ON FP.OrgID=AO.ID
		  GROUP BY  AO.Name ,CARGOTYPEKINDTEXT,CT.INCODE,CARGOTYPETEXT,AMOUNT,
		  QUANTITY,nvl(CT.Amount,0)*QUANTITY ,FP.ProvideDate,FP.FlowOrgID ) TEMP
		  WHERE 1=1 {0}
	  </Content>

    <Content Key="ReportMaterialProvideSummary" Desc="物品发放统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT * FROM
      (SELECT CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,
      SL.QUANTITY,SO.OutDate PRODATE,AU.FlowOrgID
      FROM StorageOut SO
      INNER JOIN StorageOutList SL ON SO.OutID=SL.OutID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_WorkGroup ProvideUser  on SO.OPID = ProvideUser.FID
      LEFT JOIN AC_UserWorkGroup WG ON ProvideUser.FID=WG.FGroupID
      LEFT JOIN AC_User AU ON WG.FUserID=AU.ID
      WHERE SO.OutType=6
      UNION ALL
      SELECT CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,
      SL.QUANTITY,FP.ProvideDate PRODATE,FP.FlowOrgID
      FROM FlowProvide FP
      INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
      INNER JOIN FlowPackageList PL ON FL.PackageID=PL.PackageID
      INNER JOIN StorageList SL ON PL.StorageID=SL.StorageID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID ) TEMP
      WHERE 1=1 {0}
    </Content>
    <Content Key="ReportMaterialProvideSummary" Desc="物品发放统计" DataBaseType="Oracle">
      SELECT * FROM
      (SELECT CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,
      SL.QUANTITY,SO.OutDate PRODATE,AU.FlowOrgID
      FROM StorageOut SO
      INNER JOIN StorageOutList SL ON SO.OutID=SL.OutID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_WorkGroup ProvideUser  on SO.OPID = ProvideUser.FID
      LEFT JOIN AC_UserWorkGroup WG ON ProvideUser.FID=WG.FGroupID
      LEFT JOIN AC_User AU ON WG.FUserID=AU.ID
      WHERE SO.OutType=6
      UNION ALL
      SELECT CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,
      SL.QUANTITY,FP.ProvideDate PRODATE,FP.FlowOrgID
      FROM FlowProvide FP
      INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
      INNER JOIN FlowPackageList PL ON FL.PackageID=PL.PackageID
      INNER JOIN StorageList SL ON PL.StorageID=SL.StorageID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID ) TEMP
      WHERE 1=1 {0}
    </Content>

    <Content Key="ReportMaterialStorageSummary" Desc="物品入库统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,SL.QUANTITY
      ,CONVERT(CHAR(10),SI.INDATE,120) AS INDATE,SL.LOTNUMBER,S.NAME SUPPLIERNAME
      FROM StorageIn SI
      INNER JOIN StorageInList SL ON SI.InID=SL.InID
      LEFT JOIN Supplier S ON SI.SupplierID=S.SupplierID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_WorkGroup ProvideUser  on SI.OPID = ProvideUser.FID
      LEFT JOIN AC_UserWorkGroup WG  ON ProvideUser.FID = WG.FGroupID
      LEFT JOIN AC_User AU  ON WG.FUserID = AU.ID
      WHERE  1=1 {0}
    </Content>
    <Content Key="ReportMaterialStorageSummary" Desc="物品入库统计" DataBaseType="Oracle">
      SELECT CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,SL.QUANTITY
      ,to_char(SI.INDATE,'yyyy-mm-dd') INDATE,SL.LOTNUMBER,S.NAME SUPPLIERNAME
      FROM StorageIn SI
      INNER JOIN StorageInList SL ON SI.InID=SL.InID
      LEFT JOIN Supplier S ON SI.SupplierID=S.SupplierID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_WorkGroup ProvideUser  on SI.OPID = ProvideUser.FID
      LEFT JOIN AC_UserWorkGroup WG  ON ProvideUser.FID = WG.FGroupID
      LEFT JOIN AC_User AU  ON WG.FUserID = AU.ID
      WHERE  1=1 {0}
    </Content>


    <Content Key="ReportUseSummary" Desc="使用统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      UseArea.Name AS AREATEXT, --区域
      CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT, --种类
      CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeText AS CARGOTYPETEXT,--无菌物品
      COUNT(FlowUseList.Quantity) AS QTY, --数量
      FlowUse.UseDate as USEDATE,--使用时间
      ISNULL(CargoType.Amount,0.00) AS UNITPRICE,--单价
      ISNULL(CargoType.Amount,0.00) * COUNT(FlowUse.UseID) AS TOTALPRICE --总价
      ,StorageList.Barcode BARCODE         --包条码
      ,AC_WorkGroup.FNames USERNAME               --使用人
      ,PatientList.PatientName PATIENTNAME --病人
      FROM FlowUse with (nolock)
      INNER JOIN FlowUseList with (nolock)  on FlowUse.UseID = FlowUseList.UseID
      INNER JOIN StorageList with (nolock)  on FlowUseList.StorageID = StorageList.StorageID
      INNER JOIN FlowPackageList with (nolock)  on FlowPackageList.StorageID = StorageList.StorageID
      left JOIN PackageType with (nolock)  on FlowPackageList.packagetypeid = PackageType.PTypeID
      left JOIN AC_ORG AS UseArea with (nolock)  on FlowUse.OrgID = UseArea.ID
      left JOIN view_CargoType AS CargoType with (nolock) ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      left JOIN AC_WorkGroup with (nolock)  on FlowUse.OPID = AC_WorkGroup.FID
      LEFT JOIN PatientList on PatientList.PatientID = FlowUse.PatientID
      WHERE 1 = 1 {0}
      GROUP BY
      UseArea.Name,
      CargoType.CargoTypeText,
      CargoType.CargoTypeKindText,
      CargoType.CargoTopTypeText,CargoType.Amount,FlowUse.UseDate
      ,StorageList.Barcode
      ,AC_WorkGroup.FNames
      ,PatientList.PatientName
      Order By AreaText,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>
    <Content Key="ReportUseSummary" Desc="使用统计" DataBaseType="Oracle">
      SELECT
      UseArea.Name  AREATEXT,
      CargoType.CargoTopTypeText  CARGOTOPTYPETEXT,
      CargoType.CargoTypeKindText  CARGOTYPEKINDTEXT,
      CargoType.CargoTypeText  CARGOTYPETEXT,
      COUNT(FlowUseList.Quantity)  QTY,
      FlowUse.UseDate as USEDATE,--使用时间
      nvl(CargoType.Amount,0.00) AS UNITPRICE,--单价
      nvl(CargoType.Amount,0.00) * COUNT(FlowUse.UseID) AS TOTALPRICE --总价
      ,StorageList.Barcode BARCODE         --包条码
      ,AC_WorkGroup.FNames USERNAME               --使用人
      ,PatientList.PatientName PATIENTNAME --病人
      FROM FlowUse
      INNER JOIN FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      INNER JOIN StorageList  on FlowUseList.StorageID = StorageList.StorageID
      INNER JOIN FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      left JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      left JOIN AC_ORG  UseArea  on FlowUse.OrgID = UseArea.ID
      left JOIN view_CargoType  CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      left JOIN AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      LEFT JOIN PatientList on PatientList.PatientID = FlowUse.PatientID
      WHERE 1 = 1  {0}
      GROUP BY
      UseArea.Name,
      CargoType.CargoTypeText,
      CargoType.CargoTypeKindText,
      CargoType.CargoTopTypeText,CargoType.Amount,FlowUse.UseDate
      ,StorageList.Barcode
      ,AC_WorkGroup.FNames
      ,PatientList.PatientName
      Order By AreaText,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>

    <Content Key="ReportFetchSummary" Desc="领取统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT FF.FETCHDATE,L.LOCATIONNAME,L1.LOCATIONNAME NOWLOCATIONNAME,WG.FNames OPNAME,AW.FNames RECNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,COUNT(1) FQTY
      ,CONVERT(char(10),FF.PlanUseDate,120) PLANUSERDATE,ST.TypeName STATUSNAME
      ,case when SL.Status=20 then CONVERT(varchar(30),fr.RecycleDate,111) end as RECYCLEDATE
      FROM FlowFetch FF
      INNER JOIN FlowFetchList FL ON FF.FetchID=FL.FetchID
      INNER JOIN FlowPackageList FPL ON FL.PackageID=FPL.PackageID
      INNER JOIN StorageList SL ON FPL.StorageID=SL.StorageID
      LEFT JOIN SystemTypeParameter ST ON SL.Status=ST.TypeValue AND ST.TypeKey='StorageStatus'
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_WorkGroup WG ON FF.OPID=WG.FID
      LEFT JOIN AC_WorkGroup AW ON FF.RecipientID=AW.FID
      LEFT JOIN AC_OrgUser on AC_OrgUser.UserID =AW .FID
      LEFT JOIN AC_Org on AC_Org .ID =AC_OrgUser .OrgID
      LEFT JOIN Location L ON FF.LocationID=L.LocationID
      LEFT JOIN Location L1 ON FPL.lastLocationID=L1.LocationID
      /*--begin--*/
      left join FlowRecycleList frl on FPL.PackageID= frl.PackageID
      left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      /*--end--*/
      WHERE 1=1 {0}
      GROUP BY FF.FetchDate,L.LocationName,L1.LOCATIONNAME,WG.FNames,AW.FNames,CT.CargoTypeKindText,CT.CargoTypeText,FF.PlanUseDate,ST.TypeName,SL.Status
      ,CONVERT(varchar(30),fr.RecycleDate,111)
      ORDER BY FF.FetchDate DESC
    </Content>
    <Content Key="ReportFetchSummary" Desc="领取统计" DataBaseType="Oracle">
      SELECT FF.FETCHDATE,L.LOCATIONNAME,L1.LOCATIONNAME NOWLOCATIONNAME,WG.FNames OPNAME,AW.FNames RECNAME,CT.CARGOTYPEKINDTEXT,CT.CARGOTYPETEXT,COUNT(1) FQTY
      ,to_char(FF.PlanUseDate,'yyyy-mm-dd') PLANUSERDATE,ST.TypeName STATUSNAME
      ,case when SL.Status=20 then to_char(fr.RecycleDate,'yyyy-mm-dd') end as RECYCLEDATE
      FROM FlowFetch FF
      INNER JOIN FlowFetchList FL ON FF.FetchID=FL.FetchID
      INNER JOIN FlowPackageList FPL ON FL.PackageID=FPL.PackageID
      INNER JOIN StorageList SL ON FPL.StorageID=SL.StorageID
      LEFT JOIN SystemTypeParameter ST ON SL.Status=ST.TypeValue AND ST.TypeKey='StorageStatus'
      LEFT JOIN view_CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_WorkGroup WG ON FF.OPID=WG.FID
      LEFT JOIN AC_WorkGroup AW ON FF.RecipientID=AW.FID
      LEFT JOIN AC_OrgUser on AC_OrgUser.UserID =AW .FID
      LEFT JOIN AC_Org on AC_Org .ID =AC_OrgUser .OrgID
      LEFT JOIN Location L ON FF.LocationID=L.LocationID
      LEFT JOIN Location L1 ON FPL.lastLocationID=L1.LocationID
      /*--begin--*/
      left join FlowRecycleList frl on FPL.PackageID=frl.PackageID
      left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      /*--end--*/
      WHERE 1=1 {0}
      GROUP BY FF.FetchDate,L.LocationName,L1.LOCATIONNAME,WG.FNames,AW.FNames,CT.CargoTypeKindText,CT.CargoTypeText,FF.PlanUseDate,ST.TypeName,SL.Status
      ,to_char(fr.RecycleDate,'yyyy-mm-dd')
      ORDER BY FF.FetchDate DESC
    </Content>

    //临床预定的无菌包费用统计

    <Content Key="ReportPreOrderSummaryPrice" Desc="预订费用统计" DataBaseType="SqlServer">

      <![CDATA[
     select  a.Name ORGNAME
        ,fp.ORDERDATE
        , ct.CARGOTOPTYPETEXT
        , fp.PreOrderType
        , ct.CARGOTYPEKINDTEXT
        , c.CARGOTYPENAME
        , fpd.PreOrderQty QTY  --数量
        , Isnull(c.amount,0.00) AMOUNT --单价
        , ISNULL(c.amount,0.00) * fpd.PreOrderQty as TOTALPRICE--总价
    from FlowPreOrderDetail fpd
        inner join FlowPreOrder fp on fp.PreOrderID=fpd.PreOrderID
        inner join CargoType c on c.CargoTypeID=fpd.CargoTypeID
        inner join AC_Org a on a.ID=fp.OrgID 
        left join view_CargoType ct on ct.CargoTypeID=fpd.CargoTypeID
   where fp.CheckStatus=1 and fp.PreOrderType <>0 and fp.OrderDate between @OrderDateBegin and @OrderDateEnd {0}
   order by fp.OrderDate desc
      ]]>
    </Content>

    //临床预定的无菌包费用统计

    <Content Key="ReportPreOrderSummaryPrice" Desc="预订费用统计" DataBaseType="Oracle">

      <![CDATA[
     select  a.Name ORGNAME
        ,fp.ORDERDATE
        , ct.CARGOTOPTYPETEXT
        , fp.PreOrderType
        , ct.CARGOTYPEKINDTEXT
        , c.CARGOTYPENAME
        , fpd.PreOrderQty QTY  --数量
        , nvl(c.amount,0.00) AMOUNT --单价
        , nvl(c.amount,0.00) * fpd.PreOrderQty as TOTALPRICE--总价
    from FlowPreOrderDetail fpd
        inner join FlowPreOrder fp on fp.PreOrderID=fpd.PreOrderID
        inner join CargoType c on c.CargoTypeID=fpd.CargoTypeID
        inner join AC_Org a on a.ID=fp.OrgID 
        left join view_CargoType ct on ct.CargoTypeID=fpd.CargoTypeID
   where fp.CheckStatus=1 and fp.PreOrderType <>0 and fp.OrderDate between  :OrderDateBegin and  :OrderDateEnd {0}
   order by fp.OrderDate desc
      ]]>
    </Content>
    
    <Content Key="ReportPreOrderSummary" Desc="预订统计" DataBaseType="SqlServer">
      <![CDATA[
	    WITH PreOrder(
      PROVIDEAREATEXT
      ,CARGOTOPTYPETEXT    --种类
      ,CARGOTYPEKINDTEXT   --类别
      ,CARGOTYPETEXT       --无菌物品、器械包
      ,CARGOTYPEID
      ,APPLYQTY            --申请数量
      ,APPROVEDQTY         --批准数量
      ,PROVIDEQTY          --发放数量
      ,CHECKSTATUS)
      AS
      ( --1

      SELECT
      ApplyQ.Name AS PROVIDEAREATEXT
      ,ApplyQ.CargoTopTypeText AS CARGOTOPTYPETEXT   --种类
      ,ApplyQ.CargoTypeKindText AS CARGOTYPEKINDTEXT --类别
      ,ApplyQ.CargoTypeText AS CARGOTYPETEXT         --无菌物品、器械包
      ,ApplyQ.CargoTypeID AS CARGOTYPEID
      ,ApplyQ.ApplyQty AS APPLYQTY                   --申请数量
      ,Approved.ApprovedQty AS APPROVEDQTY           --批准数量
      ,Provide.ProvideQty AS PROVIDEQTY              --发放数量
      ,ApplyQ.CheckStatus AS CHECKSTATUS
      FROM
      (
      SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,FD.CargoTypeID
      ,isnull(SUM(PreOrderQty),0) ApplyQty  -- 申请数量
      ,FO.CheckStatus
      FROM FlowPreOrder FO 
      INNER JOIN FlowPreOrderDetail FD ON FO.PreOrderID = FD.PreOrderID
      LEFT JOIN view_CargoType CT  ON FD.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org  AO  ON AO.ID = FO.OrgID
      WHERE FO.OrderDate>=@OrderDateBegin AND FO.OrderDate<=@OrderDateEnd
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,FD.CargoTypeID,FO.CheckStatus
      ) ApplyQ

      LEFT JOIN
      (
      SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,FD.CargoTypeID
      ,isnull(SUM(PreOrderQty),0) ApprovedQty  -- 批准数量
      FROM FlowPreOrder FO 
      INNER JOIN FlowPreOrderDetail FD ON FO.PreOrderID = FD.PreOrderID
      LEFT JOIN view_CargoType CT ON FD.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID = FO.OrgID
      WHERE  FO.CheckStatus=1 AND FO.OrderDate>=@OrderDateBegin AND FO.OrderDate<=@OrderDateEnd
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,FD.CargoTypeID
      ) Approved
      ON ApplyQ.CargoTypeID = Approved.CargoTypeID and  ApplyQ.name = Approved.name 

      LEFT JOIN
      (

      (SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,SL.CargoTypeID
      ,isnull(SUM(Quantity),0) ProvideQty  -- 发放数量
      FROM StorageOut SO 
      INNER JOIN StorageOutList SL ON SO.OutID = SL.OutID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID = SO.OrgID
      WHERE SO.OutDate>=@OrderDateBegin AND SO.OutDate<=@OrderDateEnd
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,SL.CargoTypeID
      )
      UNION
      (
      SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,CT.CargoTypeID
      ,isnull(SUM(SL.Quantity),0) ProvideQty  -- 发放数量
      FROM FlowProvide FP
      INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
      INNER JOIN FlowPackageList PA ON FL.PackageID=PA.PackageID
      INNER JOIN StorageList SL ON PA.StorageID=SL.StorageID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_Org AO ON FP.OrgID=AO.ID
      WHERE FP.ProvideDate>=@OrderDateBegin AND FP.ProvideDate<=@OrderDateEnd 
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,CT.CargoTypeID)
      ) Provide
      ON ApplyQ.CargoTypeID = Provide.CargoTypeID and ApplyQ.NAME = Provide.NAME
      ) --1 END

      SELECT
      PROVIDEAREATEXT
      ,CT.CARGOTOPTYPETEXT
      ,CT.CARGOTYPEKINDTEXT
      ,CT.CARGOTYPETEXT
      ,CT.CARGOTYPEID
      ,isnull(APPLYQTY,0) APPLYQTY
      ,isnull(APPROVEDQTY,0) APPROVEDQTY
      ,isnull(PROVIDEQTY,0) PROVIDEQTY
      ,CHECKSTATUS
      ,CT.UNIT ,CT.MINUNIT
      FROM PreOrder
      left JOIN view_CargoType CT ON CT.CargoTypeID=PreOrder.CARGOTYPEID
      WHERE 1=1 {0}
      GROUP BY PROVIDEAREATEXT,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,CT.CargoTypeID,
      APPLYQTY,APPROVEDQTY,PROVIDEQTY,CHECKSTATUS,CT.UNIT ,CT.MINUNIT
      ORDER BY PROVIDEAREATEXT,CT.CargoTypeText
   
      ]]>

    </Content>

    <Content Key="ReportPreOrderSummary" Desc="预订统计" DataBaseType="Oracle">

      <![CDATA[
	    WITH PreOrder
      AS
      ( --1

      SELECT
      ApplyQ.Name AS PROVIDEAREATEXT
      ,ApplyQ.CargoTopTypeText AS CARGOTOPTYPETEXT   --种类
      ,ApplyQ.CargoTypeKindText AS CARGOTYPEKINDTEXT --类别
      ,ApplyQ.CargoTypeText AS CARGOTYPETEXT         --无菌物品、器械包
      ,ApplyQ.CargoTypeID AS CARGOTYPEID
      ,ApplyQ.ApplyQty AS APPLYQTY                   --申请数量
      ,Approved.ApprovedQty AS APPROVEDQTY           --批准数量
      ,Provide.ProvideQty AS PROVIDEQTY              --发放数量
      ,ApplyQ.CheckStatus AS CHECKSTATUS
      FROM
      (
      SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,FD.CargoTypeID
      ,nvl(SUM(PreOrderQty),0) ApplyQty  -- 申请数量
      ,FO.CheckStatus
      FROM FlowPreOrder FO 
      INNER JOIN FlowPreOrderDetail FD ON FO.PreOrderID = FD.PreOrderID
      LEFT JOIN view_CargoType CT  ON FD.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org  AO  ON AO.ID = FO.OrgID
      WHERE FO.OrderDate>=:OrderDateBegin AND FO.OrderDate<=:OrderDateEnd
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,FD.CargoTypeID,FO.CheckStatus
      ) ApplyQ

      LEFT JOIN
      (
      SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,FD.CargoTypeID
      ,nvl(SUM(PreOrderQty),0) ApprovedQty  -- 批准数量
      FROM FlowPreOrder FO 
      INNER JOIN FlowPreOrderDetail FD ON FO.PreOrderID = FD.PreOrderID
      LEFT JOIN view_CargoType CT ON FD.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID = FO.OrgID
      WHERE  FO.CheckStatus=1 AND FO.OrderDate>=:OrderDateBegin AND FO.OrderDate<=:OrderDateEnd
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,FD.CargoTypeID
      ) Approved
      ON ApplyQ.CargoTypeID = Approved.CargoTypeID and  ApplyQ.name = Approved.name 

      LEFT JOIN
      (

      (SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,SL.CargoTypeID
      ,nvl(SUM(Quantity),0) ProvideQty  -- 发放数量
      FROM StorageOut SO 
      INNER JOIN StorageOutList SL ON SO.OutID = SL.OutID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org AO ON AO.ID = SO.OrgID
      WHERE SO.OutDate>=:OrderDateBegin AND SO.OutDate<=:OrderDateEnd
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,SL.CargoTypeID
      )
      UNION
      (
      SELECT
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,CT.CargoTypeID
      ,nvl(SUM(SL.Quantity),0) ProvideQty  -- 发放数量
      FROM FlowProvide FP
      INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
      INNER JOIN FlowPackageList PA ON FL.PackageID=PA.PackageID
      INNER JOIN StorageList SL ON PA.StorageID=SL.StorageID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_Org AO ON FP.OrgID=AO.ID
      WHERE FP.ProvideDate>=:OrderDateBegin AND FP.ProvideDate<=:OrderDateEnd 
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,CT.CargoTypeID)
      ) Provide
      ON ApplyQ.CargoTypeID = Provide.CargoTypeID and ApplyQ.NAME = Provide.NAME
      ) --1 END

      SELECT
      PROVIDEAREATEXT
      ,CT.CARGOTOPTYPETEXT
      ,CT.CARGOTYPEKINDTEXT
      ,CT.CARGOTYPETEXT
      ,CT.CARGOTYPEID
      ,nvl(APPLYQTY,0) APPLYQTY
      ,nvl(APPROVEDQTY,0) APPROVEDQTY
      ,nvl(PROVIDEQTY,0) PROVIDEQTY
      ,CHECKSTATUS
      ,CT.UNIT ,CT.MINUNIT
      FROM PreOrder
      LEFT JOIN view_CargoType CT ON CT.CargoTypeID=PreOrder.CARGOTYPEID
      WHERE 1=1 {0}
      GROUP BY PROVIDEAREATEXT,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,CT.CargoTypeID,
      APPLYQTY,APPROVEDQTY,PROVIDEQTY,CHECKSTATUS,CT.UNIT ,CT.MINUNIT
      ORDER BY PROVIDEAREATEXT,CT.CargoTypeText
   
      ]]>

    </Content>


    <Content Key="BorrowPackageSummary" Desc="借包统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      Select CONVERT(CHAR(10),t2.PROVIDEDATE,120) AS PROVIDEDATE,t4.Name As ORGNAME,t3.CARGOTYPEKINDTEXT,t3.CARGOTYPETEXT,
      t1.QUANTITY,t1.RETURNQUANTITY,(t1.QUANTITY-t1.RETURNQUANTITY) As ONQUANTITY,t2.RECIPIENT
      From FlowProvideLend t1
      Inner Join FlowProvide t2 On t1.ProvideID = t2.ProvideID
      left Join view_CargoType t3 On t1.CargoTypeID = t3.CargoTypeID
      Inner Join AC_Org t4 On t4.ID=t2.OrgID
      Where 1=1 {0}
    </Content>

    <Content Key="BorrowPackageSummary" Desc="借包统计" DataBaseType="Oracle">
		Select to_char(t2.PROVIDEDATE,'yyyy-mm-dd') PROVIDEDATE,t4.Name As ORGNAME,t3.CARGOTYPEKINDTEXT,t3.CARGOTYPETEXT,
		t1.QUANTITY,t1.RETURNQUANTITY,t2.RECIPIENT
		From FlowProvideLend t1
		Inner Join FlowProvide t2 On t1.ProvideID = t2.ProvideID
		left Join view_CargoType t3 On t1.CargoTypeID = t3.CargoTypeID
		Inner Join AC_Org t4 On t4.ID=t2.OrgID
		Where 1=1 {0}
	</Content>
	  <Content Key="ProvidePackageInstrumentSummary" Desc="发包包内器械统计" DataBaseType="SqlServer">
		  select  g.NAME as ORGNAME,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from FlowProvide fp  inner join FlowProvideList fpl  on fp.ProvideID=fpl.ProvideID
		  inner join FlowPackageList fplt  on fpl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  inner join AC_Org g  on fp.OrgID=g.ID
		  left join AC_Org p on g.previd = p.ID
		  left join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  ) v on v.PackageID=fpl.PackageID
		  where   1=1 {0}
		  group by  g.NAME,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="ProvidePackageInstrumentSummary" Desc="发包包内器械统计" DataBaseType="Oracle">
		  select  g.NAME as ORGNAME,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from FlowProvide fp  inner join FlowProvideList fpl  on fp.ProvideID=fpl.ProvideID
		  inner join FlowPackageList fplt  on fpl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  inner join AC_Org g  on fp.OrgID=g.ID
		  left join AC_Org p on g.previd = p.ID
		  left join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  ) v on v.PackageID=fpl.PackageID
		  where  1=1 {0}
		  group by  g.NAME,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="RecyclePackageInstrumentSummary" Desc="回收包内器械统计" DataBaseType="SqlServer">
		  select  g.Name  as ORGNAME,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from FlowRecycle fr  inner join FlowRecycleList frl  on fr.FRecycleID=frl.FRecycleID
		  inner join FlowPackageList fplt  on frl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  LEFT JOIN WAREHOUSE W  ON fplt.LASTWAREHOUSEID = W.WAREHOUSEID
		  left join AC_Org g on g.ID=w.OrgID
		  inner join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  union
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackageLostBarcode   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageLostBarcodeCList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1 and  pcl.Quantity>0)
		  ) v on v.PackageID=frl.PackageID
		  where  1=1 {0}
		  group by g.Name ,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="RecyclePackageInstrumentSummary" Desc="回收包内器械统计" DataBaseType="Oracle">
		  select  g.Name  as ORGNAME,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from FlowRecycle fr  inner join FlowRecycleList frl  on fr.FRecycleID=frl.FRecycleID
		  inner join FlowPackageList fplt  on frl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  LEFT JOIN WAREHOUSE W  ON fplt.LASTWAREHOUSEID = W.WAREHOUSEID
		  left join AC_Org g on g.ID=w.OrgID
		  left join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  UNION
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackageLostBarcode   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageLostBarcodeCList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1 and  pcl.Quantity>0)
		  ) v on v.PackageID=frl.PackageID
		  where    1=1 {0}
		  group by  g.Name,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="DisinfectPackageInstrumentSummary" Desc="清洗包内器械统计" DataBaseType="SqlServer">
		  select  g.Name  as ORGNAME,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from FlowDisinfectContainerList fdfc inner join 	FlowRecycle fr  on fdfc.FRecycleID=fr.FRecycleID
		  inner join FlowDisinfect fd on fd.FDisinfectID=fdfc.FDisinfectID
		  inner join FlowRecycleList frl  on fr.FRecycleID=frl.FRecycleID
		  inner join FlowPackageList fplt  on frl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  LEFT JOIN WAREHOUSE W  ON fplt.LASTWAREHOUSEID = W.WAREHOUSEID
		  left join AC_Org g on g.ID=w.OrgID
		  inner join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  union
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackageLostBarcode   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageLostBarcodeCList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1 and  pcl.Quantity>0)
		  ) v on v.PackageID=frl.PackageID
		  where  1=1 {0}
		  group by g.Name ,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="DisinfectPackageInstrumentSummary" Desc="清洗包内器械统计" DataBaseType="Oracle">
		  select  g.Name  as ORGNAME,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from FlowDisinfectContainerList fdfc inner join 	FlowRecycle fr  on fdfc.FRecycleID=fr.FRecycleID
		  inner join FlowDisinfect fd on fd.FDisinfectID=fdfc.FDisinfectID
		  inner join FlowRecycleList frl  on fr.FRecycleID=frl.FRecycleID
		  inner join FlowPackageList fplt  on frl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  LEFT JOIN WAREHOUSE W  ON fplt.LASTWAREHOUSEID = W.WAREHOUSEID
		  left join AC_Org g on g.ID=w.OrgID
		  inner join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  union
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackageLostBarcode   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageLostBarcodeCList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1 and  pcl.Quantity>0)
		  ) v on v.PackageID=frl.PackageID
		  where  1=1 {0}
		  group by g.Name ,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="PackagePackageInstrumentSummary" Desc="配包器械统计" DataBaseType="SqlServer">
		  select   c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from Flowpackage fp
		  inner join FlowPackageList fplt  on fp.fPackageID=fplt.fPackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  left join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  ) v on v.PackageID=fplt.PackageID
		  where   1=1 {0}
		  group by  c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="PackagePackageInstrumentSummary" Desc="配包包内器械统计" DataBaseType="Oracle">
		  select   c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from Flowpackage fp
		  inner join FlowPackageList fplt  on fp.fPackageID=fplt.fPackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  left join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)
		  ) v on v.PackageID=fplt.PackageID
		  where  1=1  {0}
		  group by  c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="FlowSterilizeInstrumentSummary" Desc="灭菌包内器械统计" DataBaseType="SqlServer">
		  select  c.CargoTypeID,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from DevicesUseLog dul  inner join FlowSterilizationList frl  on frl.SterilizationLogID=dul.LogID
		  inner join FlowPackageList fplt  on frl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  inner join Devices d on d.DeviceID=dul.DeviceID
		  inner join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)

		  ) v on v.PackageID=frl.PackageID
		  where  d.DeviceType in (4,5,6) {0}
		  group by c.CargoTypeID,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
	  <Content Key="FlowSterilizeInstrumentSummary" Desc="灭菌包内器械统计" DataBaseType="Oracle">
		  select  c.CargoTypeID,c.CARGOTYPENAME,v.CargoTypeName as QXNAME,sum(v.Quantity) as QUANTITY
		  from DevicesUseLog dul  inner join FlowSterilizationList frl  on frl.SterilizationLogID=dul.LogID
		  inner join FlowPackageList fplt  on frl.PackageID=fplt.PackageID
		  inner join CargoType c  on c.CargoTypeID=fplt.CargoTypeID
		  inner join Devices d on d.DeviceID=dul.DeviceID
		  inner join
		  (
		  SELECT     p.PackageID, c1.CargoTypeName, pcl.Quantity / fp.Quantity AS Quantity,pcl.CargoTypeID
		  FROM           FlowPackageList   p  INNER JOIN
		  FlowPackage   fp   ON fp.FPackageID = p.FPackageID INNER JOIN
		  FlowPackageCargoList  pcl   ON fp.FPackageID = pcl.FPackageID INNER JOIN
		  CargoType  c1   ON pcl.CargoTypeID = c1.CargoTypeID
		  WHERE      (pcl.CargoTopType = 1)

		  ) v on v.PackageID=frl.PackageID
		  where  d.DeviceType in (4,5,6) {0}
		  group by c.CargoTypeID,c.CARGOTYPENAME,v.CargoTypeName
	  </Content>
    <Content Key="ReportStockSummary" Desc="库存统计" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
        WarehouseName AS WAREHOUSETEXT
		,LOCATIONNAME
      , CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT --种类
      , CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT--类别
      , CargoType.CargoTypeText AS CARGOTYPETEXT--无菌物品
      , CargoType.CargoTopType CARGOTOPTYPE
      , CargoType.CargoTypeKind AS CARGOTYPEKIND
      , CargoType.CargoTypeID AS CARGOTYPEID
      , SUM(QUANTITY) AS  QTY -- 数量	 
      FROM View_StorageList AS StorageList with (nolock)
      LEFT JOIN view_CargoType AS CargoType with (nolock)
      ON StorageList.CargoTypeID = CargoType.CargoTypeID
      WHERE Quantity>0 
	    and  CONVERT(varchar(10),StorageList.EXPDate,120) >CONVERT(varchar(10),GETDATE(),120)
      AND ((CargoType.CargoTopType = 16 AND STATUS IN (40,50,60))-- 灭菌包 & 已发放
      OR CargoType.CargoTopType <> 16)
      {0}
      GROUP BY WarehouseName,LOCATIONNAME,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,CargoType.CargoTypeID, CargoType.CargoTypeKind
      ,CargoType.CargoTopType
      Order BY WarehouseName,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ]]>
    </Content>
    <Content Key="ReportStockSummary" Desc="库存统计" DataBaseType="Oracle">
      <![CDATA[
     SELECT
        WarehouseName  WAREHOUSETEXT
		,LOCATIONNAME
      , CargoType.CargoTopTypeText CARGOTOPTYPETEXT
      , CargoType.CargoTypeKindText CARGOTYPEKINDTEXT
      , CargoType.CargoTypeText CARGOTYPETEXT
      , CargoType.CargoTopType CARGOTOPTYPE
      , CargoType.CargoTypeKind CARGOTYPEKIND
      , CargoType.CargoTypeID CARGOTYPEID
      , SUM(QUANTITY)  QTY 	  
      FROM View_StorageList  StorageList
      LEFT JOIN view_CargoType  CargoType
      ON StorageList.CargoTypeID = CargoType.CargoTypeID
      WHERE Quantity>0 
	    and to_char(StorageList.expdate,'yyyy-mm-dd')>to_char(sysdate,'yyyy-mm-dd')
      AND ((CargoType.CargoTopType = 16 AND STATUS IN (40,50,60))
      OR CargoType.CargoTopType <> 16)
      {0}
      GROUP BY WarehouseName,LOCATIONNAME,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ,CargoType.CargoTypeID, CargoType.CargoTypeKind
      ,CargoType.CargoTopType
      Order BY WarehouseName,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText,CargoType.CargoTypeText
      ]]>
    </Content>

    <Content Key="StockInSummary" Desc="入库统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      SITYPE.TYPENAME AS INTYPETEXT
      ,SIL.CARGOTYPEID
      ,CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT
      ,CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT
      ,CargoType.CargoTypeText AS CARGOTYPETEXT
      ,W.WAREHOUSEID
      ,W.WAREHOUSENAME AS WAREHOUSETEXT
      ,SUM(SIL.QUANTITY) AS QTY
      FROM STORAGEIN SI
      INNER JOIN STORAGEINLIST SIL ON SI.INID = SIL.INID
      INNER JOIN AC_WorkGroup U ON SI.OPID = U.FID
      LEFT JOIN view_CargoType AS CargoType  ON SIL.CARGOTYPEID = CargoType.CARGOTYPEID
      LEFT JOIN WAREHOUSE W ON SIL.WAREHOUSEID = W.WAREHOUSEID
      LEFT JOIN LOCATION L ON SIL.LOCATIONID = L.LOCATIONID
      LEFT JOIN MANUFACTURER  M ON SIL.MANUFACTURERID=M.MANUFACTURERID
      INNER JOIN SYSTEMTYPEPARAMETER SITYPE
      ON SI.InType = SITYPE.TYPEVALUE AND SITYPE.TYPEKEY = 'StorageInType'
      WHERE 1=1 {0}
      GROUP BY SITYPE.TYPENAME,SIL.CARGOTOPTYPE,SIL.CARGOTYPEID
      ,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText,W.WAREHOUSEID,W.WAREHOUSENAME
      ORDER BY WareHouseText
      ,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText
      ,InTypeText
    </Content>
    <Content Key="StockInSummary" Desc="入库统计" DataBaseType="Oracle">
      SELECT
      SITYPE.TYPENAME  INTYPETEXT
      ,SIL.CARGOTYPEID
      ,CargoType.CargoTopTypeText CARGOTOPTYPETEXT
      ,CargoType.CargoTypeKindText CARGOTYPEKINDTEXT
      ,CargoType.CargoTypeText CARGOTYPETEXT
      ,W.WAREHOUSEID
      ,W.WAREHOUSENAME  WAREHOUSETEXT
      ,SUM(SIL.QUANTITY)  QTY
      FROM STORAGEIN SI
      INNER JOIN STORAGEINLIST SIL   ON SI.INID = SIL.INID
      INNER JOIN AC_WorkGroup U  ON SI.OPID = U.FID
      LEFT JOIN view_CargoType  CargoType  ON SIL.CARGOTYPEID = CargoType.CARGOTYPEID
      INNER JOIN WAREHOUSE W  ON SIL.WAREHOUSEID = W.WAREHOUSEID
      LEFT JOIN LOCATION L  ON SIL.LOCATIONID = L.LOCATIONID
      LEFT JOIN MANUFACTURER  M   ON SIL.MANUFACTURERID=M.MANUFACTURERID
      INNER JOIN SYSTEMTYPEPARAMETER SITYPE
      ON SI.InType = SITYPE.TYPEVALUE AND SITYPE.TYPEKEY = 'StorageInType'
      WHERE 1=1 {0}
      GROUP BY SITYPE.TYPENAME,SIL.CARGOTOPTYPE,SIL.CARGOTYPEID
      ,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText,W.WAREHOUSEID,W.WAREHOUSENAME
      ORDER BY WareHouseText
      ,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText
      ,InTypeText
    </Content>

    <Content Key="StockOutSummary" Desc="出库统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      SITYPE.TYPENAME AS  OUTTYPETEXT
      ,CargoType.CargoTopTypeText AS CARGOTOPTYPETEXT
      ,CargoType.CargoTypeKindText AS CARGOTYPEKINDTEXT
      ,CargoType.CargoTypeText AS CARGOTYPETEXT
      ,W.WAREHOUSEID
      ,W.WAREHOUSENAME AS  WAREHOUSETEXT
      ,SUM(SOL.QUANTITY) AS  QTY
      FROM STORAGEOUT SO
      INNER JOIN STORAGEOUTLIST SOL  ON SO.OUTID = SOL.OUTID
      INNER JOIN STORAGELIST SL  ON SOL.STORAGEID = SL.STORAGEID
      INNER JOIN AC_WorkGroup U ON SO.OPID = U.FID
      LEFT JOIN view_CargoType AS CargoType ON SL.CARGOTYPEID = CargoType.CARGOTYPEID
      LEFT JOIN WAREHOUSE W ON SO.WAREHOUSEID = W.WAREHOUSEID
      LEFT JOIN LOCATION L ON SL.LOCATIONID = L.LOCATIONID
      LEFT JOIN MANUFACTURER  M ON SL.MANUFACTURERID=M.MANUFACTURERID
      LEFT JOIN SYSTEMTYPEPARAMETER SITYPE ON SO.OutType = SITYPE.TYPEVALUE AND SITYPE.TYPEKEY = 'StorageOutType'
      LEFT JOIN WAREHOUSE ORG ON SO.ORGID = ORG.WAREHOUSEID
      LEFT JOIN SUPPLIER ON SO.ORGID = SUPPLIER.SupplierID
      WHERE 1 = 1
      {0}
      GROUP BY SITYPE.TYPENAME,SOL.CARGOTOPTYPE,SOL.CARGOTYPEID
      ,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText,W.WAREHOUSEID,W.WAREHOUSENAME
      ORDER BY WareHouseText
      ,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText
      ,OutTypeText
    </Content>
    <Content Key="StockOutSummary" Desc="出库统计" DataBaseType="Oracle">
      SELECT
      SITYPE.TYPENAME  OUTTYPETEXT
      ,CargoType.CargoTopTypeText CARGOTOPTYPETEXT
      ,CargoType.CargoTypeKindText CARGOTYPEKINDTEXT
      ,CargoType.CargoTypeText CARGOTYPETEXT
      ,W.WAREHOUSEID
      ,W.WAREHOUSENAME  WAREHOUSETEXT
      ,SUM(SOL.QUANTITY)  QTY
      FROM STORAGEOUT SO
      INNER JOIN STORAGEOUTLIST SOL   ON SO.OUTID = SOL.OUTID
      INNER JOIN STORAGELIST SL  ON SOL.STORAGEID = SL.STORAGEID
      INNER JOIN AC_WorkGroup U  ON SO.OPID = U.FID
      LEFT JOIN view_CargoType  CargoType  ON SL.CARGOTYPEID = CargoType.CARGOTYPEID
      LEFT JOIN WAREHOUSE W  ON SO.WAREHOUSEID = W.WAREHOUSEID
      LEFT JOIN LOCATION L  ON SL.LOCATIONID = L.LOCATIONID
      LEFT JOIN MANUFACTURER  M   ON SL.MANUFACTURERID=M.MANUFACTURERID
      LEFT JOIN SYSTEMTYPEPARAMETER SITYPE  ON SO.OutType = SITYPE.TYPEVALUE AND SITYPE.TYPEKEY = 'StorageOutType'
      LEFT JOIN WAREHOUSE ORG  ON SO.ORGID = ORG.WAREHOUSEID
      LEFT JOIN SUPPLIER  ON SO.ORGID = SUPPLIER.SupplierID
      WHERE 1 = 1
      {0}
      GROUP BY SITYPE.TYPENAME,SOL.CARGOTOPTYPE,SOL.CARGOTYPEID
      ,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText,W.WAREHOUSEID,W.WAREHOUSENAME
      ORDER BY WareHouseText
      ,CargoType.CargoTopTypeText
      ,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeText
      ,OutTypeText
    </Content>

    <Content Key="StockExpireSummary" Desc=" 有效期统计 " DataBaseType="SqlServer">
      <![CDATA[
      select * from

      (

      SELECT

      C.WAREHOUSENAME,D.LOCATIONNAME,CARGOTYPE.CargoTypeKindText AS CARGOTYPEKINDTEXT

      , CARGOTYPE.CargoTypeText AS CARGOTYPETEXT

      , Convert(char(10), A.EXPDATE ,120) AS EXPDATE

      , Datediff(DAY,GETDATE(),A.EXPDate) AS VALIDDATEDAYS

      , B.WarningDays AS WARNINGDAYS
      ,PT.WarningDays PTWARNINGDAYS
      , SUM(A.QUANTITY) AS QUANTITY

      , P.FLOWORGID

      FROM STORAGELIST A with (nolock)

      LEFT JOIN CARGOTYPE B with (nolock) ON A.CARGOTYPEID = B.CARGOTYPEID

      LEFT JOIN view_CargoType CARGOTYPE  with (nolock) ON CARGOTYPE.CargoTypeID = B.CARGOTYPEID

      LEFT JOIN Warehouse  C with (nolock) on A.WarehouseID = C.WarehouseID

      LEFT JOIN Location D with (nolock) on D.LocationID = C.WarehouseID

      INNER JOIN FLOWPACKAGELIST P with (nolock) on a.Storageid = p.Storageid
	  LEFT JOIN PackageType  PT  with (nolock) ON PT.PTypeID = P.PackageTypeID
      WHERE  A.CargoTopType = 16 AND A.STATUS IN (50,60) AND A.EXPDATE IS NOT NULL {0}

      GROUP BY C.WAREHOUSENAME,D.LOCATIONNAME,CARGOTYPE.CargoTypeKindText

      , CARGOTYPE.CargoTypeText

      , Convert(char(10), A.EXPDATE ,120)

      , Datediff(DAY,GETDATE(),A.EXPDate)

      , B.WarningDays
      ,PT.WarningDays 
      , P.FLOWORGID

      ) TOTALDATE 
      
      ]]>

    </Content>

    <Content Key="StockExpireSummary" Desc=" 有效期统计 " DataBaseType="Oracle">
      <![CDATA[
      select * from

      (

      SELECT

      C.WAREHOUSENAME,D.LOCATIONNAME,CARGOTYPE.CargoTypeKindText CARGOTYPEKINDTEXT

      , CARGOTYPE.CargoTypeText AS CARGOTYPETEXT

      , to_char(A.EXPDATE,'yyyy-mm-dd') AS EXPDATE

      , datediff('D',sysdate,A.EXPDate) as VALIDDATEDAYS

      , B.WarningDays AS WARNINGDAYS
	  ,PT.WarningDays PTWARNINGDAYS
      , SUM(A.QUANTITY) AS  QUANTITY

      , P.FLOWORGID

      FROM STORAGELIST A

      LEFT JOIN CARGOTYPE B  ON A.CARGOTYPEID = B.CARGOTYPEID

      LEFT JOIN view_CargoType CARGOTYPE ON CARGOTYPE.CargoTypeID = B.CARGOTYPEID

      LEFT JOIN Warehouse  C on A.WarehouseID = C.WarehouseID

      LEFT JOIN Location D on D.LocationID = C.WarehouseID

      INNER JOIN FLOWPACKAGELIST P on a.Storageid = p.Storageid
	  LEFT JOIN PackageType  PT    ON PT.PTypeID = P.PackageTypeID
      WHERE A.CargoTopType = 16 AND A.STATUS IN (50,60) AND A.EXPDATE IS NOT NULL {0}

      GROUP BY C.WAREHOUSENAME,D.LOCATIONNAME,CARGOTYPE.CargoTypeKindText

      , CARGOTYPE.CargoTypeText

      , to_char(A.EXPDATE,'yyyy-mm-dd')

      , datediff('D',sysdate,A.EXPDate)

      , B.WarningDays
      ,PT.WarningDays 
      , P.FLOWORGID

      ) TOTALDATE
      ]]>
    </Content>


    <Content Key="ReportProvideChartGrid" Desc="发放分析统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Area.Name AS AREATEXT, --区域
      --dbo.fun_get_Date(ProvideDate,@SummaryType) AS [Date],--月份
      CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
      PackageType.PName AS OUTPACKING,--外包装
      FlowProvide.ProvideDate AS PROVIDEDATE,--日期
      1 AS QTY--数量
      FROM FlowProvideList with (nolock)
      INNER JOIN FlowProvide with (nolock)  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      INNER JOIN FlowPackageList with (nolock)  on FlowProvideList.PackageID = FlowPackageList.PackageID
      LEFT JOIN PackageType with (nolock)  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN AC_ORG AS Area with (nolock)  on FlowProvide.OrgID = Area.ID
      LEFT JOIN CargoType with (nolock)  on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind with (nolock) ON CargoType.CargoTypeKind = CargoTypeKind.ID
      LEFT JOIN SystemTypeParameter AS CargoTopType with (nolock) ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      LEFT JOIN FlowSterilizationList with (nolock)  on FlowSterilizationList.PackageID = FlowPackageList.PackageID
      LEFT JOIN DevicesUseLog with (nolock)  on FlowSterilizationList.SterilizationLogID = DevicesUseLog.LogID
      LEFT JOIN Devices with (nolock)  on DevicesUseLog.DeviceID = Devices.DeviceID
      INNER JOIN StorageList  with (nolock) on FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN AC_WorkGroup with (nolock)  on FlowProvide.OPID = AC_WorkGroup.FID
      Where 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      Order By AreaText,CargoTypeText
    </Content>

    <Content Key="ReportProvideChartGrid" Desc="发放分析统计" DataBaseType="Oracle">
      SELECT
      Area.Name AS AREATEXT, --区域
      --dbo.fun_get_Date(ProvideDate,@SummaryType) AS [Date],--月份
      CargoTopType.TypeName AS CARGOTOPTYPETEXT,--种类
      CargoTypeKind.KindName AS CARGOTYPEKINDTEXT,--类别
      CargoType.CargoTypeName AS CARGOTYPETEXT,--无菌物品
      PackageType.PName AS OUTPACKING,--外包装
      FlowProvide.ProvideDate AS PROVIDEDATE,--日期
      1 AS QTY--数量
      FROM FlowProvideList
      INNER JOIN FlowProvide  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      INNER JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID
      LEFT JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN AC_ORG  Area  on FlowProvide.OrgID = Area.ID
      LEFT JOIN CargoType  on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind ON CargoType.CargoTypeKind = CargoTypeKind.ID
      LEFT JOIN SystemTypeParameter  CargoTopType ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      LEFT JOIN FlowSterilizationList  on FlowSterilizationList.PackageID = FlowPackageList.PackageID
      LEFT JOIN DevicesUseLog  on FlowSterilizationList.SterilizationLogID = DevicesUseLog.LogID
      LEFT JOIN Devices  on DevicesUseLog.DeviceID = Devices.DeviceID
      INNER JOIN StorageList  on FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN AC_WorkGroup  on FlowProvide.OPID = AC_WorkGroup.FID
      Where 1 = 1 {0}
      Order By AreaText,CargoTypeText
    </Content>

    <Content Key="ReportRecycleGrid" Desc="回收报表" DataBaseType="SqlServer">
      --回收统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      FlowRecycle.RecycleDate as RECYCLEDATE, --回收日期
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA,--回收方式
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      count(1)   AS RECYCLEQTY, --数量
      CargoType.InstrumentsNumber AS INSTRUMENTSNUMBER
      ,pcl.FName as PackageFLevel
      ,stp.TypeName SterilizationMethod
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType as CargoType ON FlowPackageList.CargoTypeID  = CargoType.CargoTypeID
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg WITH (NOLOCK) ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser WITH (NOLOCK) ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser WITH (NOLOCK) ON FlowRecycle.SENDERID = SenderUser.FID

      left join PackageCostLevel pcl on CargoType.FLevel=pcl.FID
      left join FlowSterilizationList fsl on FlowPackageList.PackageID=fsl.PackageID
      left join DevicesUseLog dul on fsl.SterilizationLogID=dul.LogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join SystemTypeParameter stp on d.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
      WHERE 1 = 1 {0}
      group by
      RecycleUser.FNames ,
      CargoType.CargoTypeText ,
      FlowRecycle.RecycleDate,
      FlowRecycle.FISPDADATA ,
      SenderUser.FNames,
      RecycleOrg.Name,
      CargoType.InstrumentsNumber
      ,pcl.FName
      ,stp.TypeName
    </Content>
    <Content Key="ReportRecycleGrid_BDYY" Desc="回收报表" DataBaseType="SqlServer">
      --回收统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      FlowRecycle.RecycleDate as RECYCLEDATE, --回收日期
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA,--回收方式
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecyclePreOrg.Name AS RECYCLEPREORGTEXT,
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      count(1)   AS RECYCLEQTY, --数量
      CargoType.InstrumentsNumber AS INSTRUMENTSNUMBER
      ,pcl.FName as PackageFLevel
      ,stp.TypeName SterilizationMethod
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType as CargoType ON FlowPackageList.CargoTypeID  = CargoType.CargoTypeID
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg WITH (NOLOCK) ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_Org AS RecyclePreOrg ON RecycleOrg.PrevID = RecyclePreOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser WITH (NOLOCK) ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser WITH (NOLOCK) ON FlowRecycle.SENDERID = SenderUser.FID

      left join PackageCostLevel pcl on CargoType.FLevel=pcl.FID
      left join FlowSterilizationList fsl on FlowPackageList.PackageID=fsl.PackageID
      left join DevicesUseLog dul on fsl.SterilizationLogID=dul.LogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join SystemTypeParameter stp on d.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
      WHERE 1 = 1 {0}
      group by
      RecycleUser.FNames ,
      CargoType.CargoTypeText ,
      FlowRecycle.RecycleDate,
      FlowRecycle.FISPDADATA ,
      SenderUser.FNames,
      RecyclePreOrg.Name,
      RecycleOrg.Name,
      CargoType.InstrumentsNumber
      ,pcl.FName
      ,stp.TypeName
    </Content>
    <Content Key="ReportRecycleGrid" Desc="回收报表" DataBaseType="Oracle">
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      FlowRecycle.RecycleDate as RECYCLEDATE, --回收日期
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA,--回收方式
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      count(1)   AS RECYCLEQTY, --数量
      CargoType.InstrumentsNumber AS INSTRUMENTSNUMBER
      ,pcl.FName as PackageFLevel
      ,stp.TypeName SterilizationMethod
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType   CargoType ON FlowPackageList.CargoTypeID  = CargoType.CargoTypeID
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org   RecycleOrg   ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup  RecycleUser  ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup   SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      left join PackageCostLevel pcl on CargoType.FLevel=pcl.FID
      left join FlowSterilizationList fsl on FlowPackageList.PackageID=fsl.PackageID
      left join DevicesUseLog dul on fsl.SterilizationLogID=dul.LogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join SystemTypeParameter stp on d.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
      WHERE 1 = 1 {0}
      group by
      RecycleUser.FNames ,
      CargoType.CargoTypeText ,
      FlowRecycle.RecycleDate,
      FlowRecycle.FISPDADATA ,
      SenderUser.FNames,
      RecycleOrg.Name,
      CargoType.InstrumentsNumber
      ,pcl.FName
      ,stp.TypeName
    </Content>
	  <Content Key="ReportPackageFrequencyGrid" Desc="回收报表" DataBaseType="SqlServer">
		  select vc.cargotypeid,vc.CARGOTYPEKINDTEXT,vc.CARGOTYPETEXT,COUNT(*) as CNT from FlowPackageList fpl
		  inner join StorageList s
		  on fpl.StorageID=s.StorageID
		  inner join view_CargoType vc
		  on vc.CargoTypeID=fpl.CargoTypeID
		  where fpl.IsTemp=0 {0}
		  group by vc.cargotypeid,vc.CargoTypeKindText,vc.CargoTypeText
	  </Content>
	  <Content Key="ReportPackageFrequencyGrid" Desc="回收报表" DataBaseType="Oracle">
		  select vc.cargotypeid,vc.CARGOTYPEKINDTEXT,vc.CARGOTYPETEXT,COUNT(*) as CNT from FlowPackageList fpl
		  inner join StorageList s
		  on fpl.StorageID=s.StorageID
		  inner join view_CargoType vc
		  on vc.CargoTypeID=fpl.CargoTypeID
		  where fpl.IsTemp=0 {0}
		  group by vc.cargotypeid,vc.CargoTypeKindText,vc.CargoTypeText
	  </Content>
	  <Content Key="ReportRecycleFetchGrid" Desc="回收交接报表" DataBaseType="SqlServer">
      --回收交接统计
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      FlowRecycleFetch.RecycleDate as RECYCLEDATE, --回收日期
      Case when FlowRecycleFetch.FISPDADATA = 0 then '供应室' when FlowRecycleFetch.FISPDADATA = 1 then 'PDA' end as FISPDA,--回收方式
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      count(1)   AS RECYCLEQTY, --数量
      CargoType.InstrumentsNumber AS INSTRUMENTSNUMBER
      FROM FlowRecycleFetchList WITH (NOLOCK)
      INNER JOIN FlowRecycleFetch WITH (NOLOCK) ON FlowRecycleFetch.FRecycleFetchID = FlowRecycleFetchList.FRecycleFetchID
      INNER JOIN FlowPackageList WITH (NOLOCK) ON FlowRecycleFetchList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType AS CargoType WITH (NOLOCK) ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN StorageList WITH (NOLOCK) ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse WITH (NOLOCK) ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg WITH (NOLOCK) ON Warehouse.OrgID = RecycleOrg.ID
      --LEFT JOIN AC_User AS RecycleUser WITH (NOLOCK) ON FlowRecycleFetch.OPID = RecycleUser.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser WITH (NOLOCK) ON FlowRecycleFetch.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser WITH (NOLOCK) ON FlowRecycleFetch.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
      GROUP BY
      RecycleUser.FNames,CargoType.CargoTypeText,FlowRecycleFetch.RecycleDate,FlowRecycleFetch.FIsPdaData,SenderUser.FNames,RecycleOrg.Name,CargoType.InstrumentsNumber
    </Content>
	  <Content Key="ReportRecycleFetchGrid" Desc="回收交接报表" DataBaseType="Oracle">
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      FlowRecycleFetch.RecycleDate as RECYCLEDATE, --回收日期
      Case when FlowRecycleFetch.FISPDADATA = 0 then '供应室' when FlowRecycleFetch.FISPDADATA = 1 then 'PDA' end as FISPDA,--回收方式
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      SUM(1)   AS RECYCLEQTY, --数量
      CargoType.InstrumentsNumber AS INSTRUMENTSNUMBER
      FROM FlowRecycleFetchList
      INNER JOIN FlowRecycleFetch  ON FlowRecycleFetch.FRecycleFetchID = FlowRecycleFetchList.FRecycleFetchID
      INNER JOIN FlowPackageList  ON FlowRecycleFetchList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType   CargoType  ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN StorageList  ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse  ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org   RecycleOrg  ON Warehouse.OrgID = RecycleOrg.ID
      --LEFT JOIN AC_User   RecycleUser  ON FlowRecycleFetch.OPID = RecycleUser.ID
      LEFT JOIN AC_WorkGroup  RecycleUser  ON FlowRecycleFetch.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup   SenderUser  ON FlowRecycleFetch.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
      GROUP BY
      RecycleUser.FNames,CargoType.CargoTypeText,FlowRecycleFetch.RecycleDate,FlowRecycleFetch.FIsPdaData,SenderUser.FNames,RecycleOrg.Name,CargoType.InstrumentsNumber
    </Content>
	  <Content Key="ReportRecycleFetchLostGrid" Desc="回收交接报表" DataBaseType="SqlServer">
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      CargoTypeLost.CargoTypeText AS CARGOTYPELOSTTEXT, --器械包类型
      FlowRecycleFetch.RecycleDate as RECYCLEDATE, --回收日期
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      SUM(fl.Quantity)   AS RECYCLEQTY  --数量
      FROM FlowRecycleFetchList WITH (NOLOCK)
      INNER JOIN FlowRecycleFetch WITH (NOLOCK) ON FlowRecycleFetch.FRecycleFetchID = FlowRecycleFetchList.FRecycleFetchID
      INNER JOIN FlowPackageList WITH (NOLOCK) ON FlowRecycleFetchList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType AS CargoType WITH (NOLOCK) ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN StorageList WITH (NOLOCK) ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse WITH (NOLOCK) ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg WITH (NOLOCK) ON Warehouse.OrgID = RecycleOrg.ID
      LEFT join FlowRecycleFetchLostList fl on fl.FRecycleFetchID=FlowRecycleFetchList.FRecycleFetchID and fl.PackageID=FlowRecycleFetchList.PackageID
      LEFT JOIN view_CargoType AS CargoTypeLost WITH (NOLOCK) ON fl.CargoTypeID = CargoTypeLost.CargoTypeID
      LEFT JOIN AC_WorkGroup AS RecycleUser WITH (NOLOCK) ON FlowRecycleFetch.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser WITH (NOLOCK) ON FlowRecycleFetch.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
      GROUP BY
      RecycleUser.FNames,CargoType.CargoTypeText,CargoTypelost.CargoTypeText,FlowRecycleFetch.RecycleDate,SenderUser.FNames,RecycleOrg.Name
      order by FlowRecycleFetch.RecycleDate desc
    </Content>
	  <Content Key="ReportRecycleFetchLostGrid" Desc="回收交接报表" DataBaseType="Oracle">
      SELECT
      RecycleUser.FNames as RECYCLEUSERNAME, --回收人员
      CargoType.CargoTypeText AS CARGOTYPETEXT, --器械包类型
      CargoTypeLost.CargoTypeText AS CARGOTYPELOSTTEXT, --器械包类型
      FlowRecycleFetch.RecycleDate as RECYCLEDATE, --回收日期
      SenderUser.FNames as SENDERUSERNAME, --科室人员（交接人）
      RecycleOrg.Name AS RECYCLEORGTEXT,--科室名称
      SUM(fl.Quantity)   AS RECYCLEQTY  --数量
      FROM FlowRecycleFetchList
      INNER JOIN FlowRecycleFetch  ON FlowRecycleFetch.FRecycleFetchID = FlowRecycleFetchList.FRecycleFetchID
      INNER JOIN FlowPackageList  ON FlowRecycleFetchList.PackageID = FlowPackageList.PackageID
      LEFT JOIN view_CargoType   CargoType  ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN StorageList  ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse  ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org   RecycleOrg  ON Warehouse.OrgID = RecycleOrg.ID
      Left join FlowRecycleFetchLostList fl on fl.FRecycleFetchID=FlowRecycleFetchList.FRecycleFetchID and fl.PackageID=FlowRecycleFetchList.PackageID
      LEFT JOIN view_CargoType  CargoTypeLost  ON fl.CargoTypeID = CargoTypeLost.CargoTypeID
      LEFT JOIN AC_WorkGroup   RecycleUser  ON FlowRecycleFetch.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup  SenderUser  ON FlowRecycleFetch.SENDERID = SenderUser.FID
      WHERE 1 = 1 {0}
      GROUP BY
      RecycleUser.FNames,CargoType.CargoTypeText,CargoTypelost.CargoTypeText,FlowRecycleFetch.RecycleDate,SenderUser.FNames,RecycleOrg.Name
      order by FlowRecycleFetch.RecycleDate desc
    </Content>
    <Content Key="FlowRecycleNotFlowfetchGrid" Desc="回收未入库统计" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      ISNULL(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY,
      RecycleUser.FNames,
      RecycleDate,
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA--回收方式
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      left join flowfetchlist fl on  FlowPackageList.packageID=fl.packageID
      left join flowfetch f on fl.FetchID=f.FetchID
      where 1=1 {0}
      order by RecycleDate Desc
    </Content>
    <Content Key="FlowRecycleNotFlowfetchGrid" Desc="回收未入库统计" DataBaseType="Oracle">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      ISNULL(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY,
      RecycleUser.FNames,
      RecycleDate,
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA--回收方式
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      left join flowfetchlist fl on  FlowPackageList.packageID=fl.packageID
      left join flowfetch f on fl.FetchID=f.FetchID
      where 1=1 {0}
      order by RecycleDate Desc
    </Content>
    <Content Key="FlowRecycleEXPDatePackageGrid" Desc="回收已过期包统计" DataBaseType="SqlServer">
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      ISNULL(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY,
      RecycleUser.FNames,
      RecycleDate,
      RecycleOrg.Name,
      sl.EXPDate,
      --f.FetchType,
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA--回收方式
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      INNER JOIN  StorageList sl ON FlowPackageList.StorageID=sl.StorageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      --left join flowfetchlist fl on  FlowPackageList.packageID=fl.packageID
      --left join flowfetch f on fl.FetchID=f.FetchID
      where 1=1 {0}
      order by RecycleDate Desc
    </Content>
    <Content Key="FlowRecycleEXPDatePackageGrid" Desc="回收已过期包统计" DataBaseType="Oracle">
      SELECT
      Warehouse.OrgID AS RECYCLEORG,
      RecycleOrg.Name AS RECYCLEORGTEXT,
      FlowPackageList.CargoTypeID AS CARGOTYPEID,
      CST.TypeName AS CARGOTOPTYPETEXT,
      CK.KindName AS CARGOTYPEKINDTEXT,
      CargoType.CargoTypeName AS CARGOTYPETEXT,
      nvl(CargoType.InstrumentsNumber,0) AS INSTRUMENTSNUMBER,
      1   AS RECYCLEQTY,
      RecycleUser.FNames,
      RecycleDate,
      RecycleOrg.Name,
      sl.EXPDate,
      f.FetchType,
      Case when FlowRecycle.FISPDADATA = 0 then '供应室' when FlowRecycle.FISPDADATA = 1 then 'PDA' end as FISPDA--回收方式
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      INNER JOIN  StorageList sl ON FlowPackageList.StorageID=sl.StorageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      left join flowfetchlist fl on  FlowPackageList.packageID=fl.packageID
      left join flowfetch f on fl.FetchID=f.FetchID
      where 1=1 {0}
      order by RecycleDate Desc
    </Content>
    <Content Key="ReportProvideGrid" Desc="发放报表" DataBaseType="SqlServer">
      <![CDATA[
        select awp.FNames PROVIDENAME,ct.CargoTypeName CARGOTYPETEXT,summary.PROVIDEDATE,summary.FISPDA,awo.FNames RECIPIENTNAME,ao.Name AREATEXT,lt.LocationName,summary.LENDFLAG,summary.QTY,summary.FPackageName,summary.ISOK,ct.amount AS Price 
        ,pcl.FName as PackageFLevel,summary.TypeName as SterilizationMethod
        from (
              SELECT AC_WorkGroup.FID ProviderID ,-- 发放人员
		        CargoType.CargoTypeID , --器械包类型
		        CONVERT(CHAR(20),FlowProvide.ProvideDate,120) AS PROVIDEDATE, --发放日期
		        Case when FlowProvide.FISPDADATA = 0 then '供应室' when FlowProvide.FISPDADATA = 1 then 'PDA' end as FISPDA,--发放方式
		        us.FID as OrgUserID, -- 科室人员（交接人）
		        Area.ID AS OrgID, --科室名称
		        case FlowPackageList.LendFlag when 0 then '否' when 1 then '是' End as LENDFLAG,--是否借用
		        FlowProvide.LocationID,
		        COUNT(1) AS QTY--数量
            ,fpi.FPackageName--标签名称
				    ,SystemTypeParameter.TypeName  AS ISOK--生物检测
            ,stp.TypeName
              FROM FlowProvideList WITH (NOLOCK)
              INNER JOIN FlowProvide WITH (NOLOCK)  on FlowProvide.ProvideID = FlowProvideList.ProvideID
              INNER JOIN FlowPackageList WITH (NOLOCK)  on FlowProvideList.PackageID = FlowPackageList.PackageID
              LEFT JOIN PackageType WITH (NOLOCK)  on FlowPackageList.packagetypeid = PackageType.PTypeID
              LEFT JOIN AC_ORG AS Area WITH (NOLOCK)  on FlowProvide.OrgID = Area.ID
              LEFT JOIN CargoType WITH (NOLOCK)  on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
              LEFT JOIN CargoTypeKind WITH (NOLOCK) ON CargoType.CargoTypeKind = CargoTypeKind.ID
              LEFT JOIN SystemTypeParameter AS CargoTopType WITH (NOLOCK) ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
              LEFT JOIN FlowSterilizationList WITH (NOLOCK)  on FlowSterilizationList.PackageID = FlowPackageList.PackageID
              LEFT JOIN DevicesUseLog  WITH (NOLOCK) on FlowSterilizationList.SterilizationLogID = DevicesUseLog.LogID
              LEFT JOIN Devices WITH (NOLOCK)  on DevicesUseLog.DeviceID = Devices.DeviceID
              INNER JOIN StorageList WITH (NOLOCK)  on FlowPackageList.StorageID = StorageList.StorageID
              --LEFT JOIN AC_User  WITH (NOLOCK) on FlowProvide.OPID = AC_User.ID
              LEFT JOIN AC_WorkGroup  WITH (NOLOCK) on FlowProvide.OPID = AC_WorkGroup.FID
              LEFT JOIN AC_WorkGroup us  WITH (NOLOCK) on FlowProvide.RECIPIENTID = us.FID
              LEFT OUTER JOIN FlowPackageIn fpi WITH(NOLOCK) ON fpi.FPackageID = FlowPackageList.FPackageID
				      LEFT OUTER JOIN SystemTypeParameter ON DevicesUseLog.ISOK = SystemTypeParameter.TypeValue	AND SystemTypeParameter.TypeKey = 'IsOK'
              left outer join SystemTypeParameter stp on Devices.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
              Where 1 = 1 {0}  -- 可能需要震泽及其下属所有科室
              Group By
              AC_WorkGroup.FID,-- 发放人员
              CargoType.CargoTypeID, --器械包类型
              FlowProvide.ProvideDate, --发放日期
              FlowProvide.FISPDADATA,--发放方式
              us.FID, -- 科室人员（交接人）
              Area.ID, --科室名称
              FlowPackageList.LendFlag--是否借用
              ,FlowProvide.LocationID
              ,fpi.FPackageName--标签名称
              ,SystemTypeParameter.TypeName--生物检测
              ,stp.TypeName
        ) summary
        Left Join AC_WorkGroup awp on awp.FID=summary.ProviderID
        Left Join CargoType ct on ct.CargoTypeID=summary.CargoTypeID
        Left Join AC_WorkGroup awo on awo.FID=summary.OrgUserID
        Left Join AC_Org ao on ao.ID=summary.OrgID
        Left Join Location lt on lt.LocationID=summary.LocationID
        left join PackageCostLevel pcl on ct.FLevel=pcl.FID
      ]]>
    </Content>
    <Content Key="ReportProvideGrid" Desc="发放报表" DataBaseType="Oracle">
      <![CDATA[
        select awp.FNames PROVIDENAME,ct.CargoTypeName CARGOTYPETEXT,summary.PROVIDEDATE,summary.FISPDA,awo.FNames RECIPIENTNAME,ao.Name AREATEXT,lt.LocationName,summary.LENDFLAG,summary.QTY,summary.FPackageName,summary.ISOK,ct.amount AS Price 
        ,pcl.FName as PackageFLevel,summary.TypeName as SterilizationMethod
        from (
              SELECT AC_WorkGroup.FID ProviderID ,-- 发放人员
		        CargoType.CargoTypeID , --器械包类型
		        to_char(FlowProvide.ProvideDate,'yyyy-MM-DD') AS PROVIDEDATE, --发放日期
		        Case when FlowProvide.FISPDADATA = 0 then '供应室' when FlowProvide.FISPDADATA = 1 then 'PDA' end as FISPDA,--发放方式
		        us.FID as OrgUserID, -- 科室人员（交接人）
		        Area.ID AS OrgID, --科室名称
		        case FlowPackageList.LendFlag when 0 then '否' when 1 then '是' End as LENDFLAG,--是否借用
		        FlowProvide.LocationID,
		        COUNT(1) AS QTY--数量
            ,fpi.FPackageName--标签名称
				    ,SystemTypeParameter.TypeName  AS ISOK--生物检测
            ,stp.TypeName
              FROM FlowProvideList 
              INNER JOIN FlowProvide   on FlowProvide.ProvideID = FlowProvideList.ProvideID
              INNER JOIN FlowPackageList   on FlowProvideList.PackageID = FlowPackageList.PackageID
              LEFT JOIN PackageType   on FlowPackageList.packagetypeid = PackageType.PTypeID
              LEFT JOIN AC_ORG Area   on FlowProvide.OrgID = Area.ID
              LEFT JOIN CargoType   on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
              LEFT JOIN CargoTypeKind  ON CargoType.CargoTypeKind = CargoTypeKind.ID
              LEFT JOIN SystemTypeParameter  CargoTopType  ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
              LEFT JOIN FlowSterilizationList   on FlowSterilizationList.PackageID = FlowPackageList.PackageID
              LEFT JOIN DevicesUseLog   on FlowSterilizationList.SterilizationLogID = DevicesUseLog.LogID
              LEFT JOIN Devices   on DevicesUseLog.DeviceID = Devices.DeviceID
              INNER JOIN StorageList   on FlowPackageList.StorageID = StorageList.StorageID
              --LEFT JOIN AC_User   on FlowProvide.OPID = AC_User.ID
              LEFT JOIN AC_WorkGroup   on FlowProvide.OPID = AC_WorkGroup.FID
              LEFT JOIN AC_WorkGroup us   on FlowProvide.RECIPIENTID = us.FID
              LEFT OUTER JOIN FlowPackageIn fpi ON fpi.FPackageID = FlowPackageList.FPackageID
              LEFT OUTER JOIN SystemTypeParameter ON DevicesUseLog.ISOK = SystemTypeParameter.TypeValue	AND SystemTypeParameter.TypeKey = 'IsOK'
              left outer join SystemTypeParameter stp on Devices.DeviceType=stp.TypeValue and stp.TYPEKEY = 'DeviceType' and stp.TypeValue between 4 and 6
              Where 1 = 1 {0}  -- 可能需要震泽及其下属所有科室
              Group By
              AC_WorkGroup.FID,-- 发放人员
              CargoType.CargoTypeID, --器械包类型
              FlowProvide.ProvideDate, --发放日期
              FlowProvide.FISPDADATA,--发放方式
              us.FID, -- 科室人员（交接人）
              Area.ID, --科室名称
              FlowPackageList.LendFlag--是否借用
              ,FlowProvide.LocationID
              ,fpi.FPackageName--标签名称
              ,SystemTypeParameter.TypeName--生物检测
              ,stp.TypeName
        ) summary
        Left Join AC_WorkGroup awp on awp.FID=summary.ProviderID
        Left Join CargoType ct on ct.CargoTypeID=summary.CargoTypeID
        Left Join AC_WorkGroup awo on awo.FID=summary.OrgUserID
        Left Join AC_Org ao on ao.ID=summary.OrgID
        Left Join Location lt on lt.LocationID=summary.LocationID
        left join PackageCostLevel pcl on ct.FLevel=pcl.FID
      ]]>
    </Content>
	  <Content Key="ReportProvideNotConfirmGrid" Desc="发放未确认报表" DataBaseType="SqlServer">
		  <![CDATA[
      SELECT
      Area.Name  AREATEXT,
    AC_WorkGroup.Fnames as PROVIDENAME,
    CONVERT(CHAR(20),FlowProvide.ProvideDate,120) AS PROVIDEDATE, --发放日期
    Case when FlowProvide.FISPDADATA = 0 then '供应室' when FlowProvide.FISPDADATA = 1 then 'PDA' end as FISPDA,--发放方式
      l.LOCATIONNAME,
      StorageList.barcode BARCODE,       
      ct.CargoTypeText  CARGOTYPETEXT,
	  1 QTY
      FROM FlowProvideList
      INNER JOIN FlowProvide  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      INNER JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID 
      left join view_cargotype ct on ct.cargotypeid=FlowPackageList.Cargotypeid
      LEFT JOIN AC_ORG  Area  on FlowProvide.OrgID = Area.ID 
      INNER JOIN StorageList  on FlowPackageList.StorageID = StorageList.StorageID  
      Left join Location l  on FlowProvide.LocationID = l.LocationID
      LEFT JOIN AC_WorkGroup    on FlowProvide.OPID = AC_WorkGroup.FID
      Where   FlowProvideList.status=0  {0}
      Order By AreaText,CargoTypeText,providedate desc
      ]]>
	  </Content>
	  <Content Key="ReportProvideNotConfirmGrid" Desc="发放未确认报表" DataBaseType="Oracle">
		  <![CDATA[
      SELECT
      Area.Name  AREATEXT,
    AC_WorkGroup.Fnames as PROVIDENAME,
    to_char(FlowProvide.ProvideDate,'yyyy-MM-DD') AS PROVIDEDATE, --发放日期
    Case when FlowProvide.FISPDADATA = 0 then '供应室' when FlowProvide.FISPDADATA = 1 then 'PDA' end as FISPDA,--发放方式
      l.LOCATIONNAME,
      StorageList.barcode BARCODE,       
      ct.CargoTypeText  CARGOTYPETEXT,
	  1 QTY
      FROM FlowProvideList
      INNER JOIN FlowProvide  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      INNER JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID 
      left join view_cargotype ct on ct.cargotypeid=FlowPackageList.Cargotypeid
      LEFT JOIN AC_ORG  Area  on FlowProvide.OrgID = Area.ID 
      INNER JOIN StorageList  on FlowPackageList.StorageID = StorageList.StorageID  
      Left join Location l  on FlowProvide.LocationID = l.LocationID
      LEFT JOIN AC_WorkGroup    on FlowProvide.OPID = AC_WorkGroup.FID
      Where   FlowProvideList.status=0  {0}
      Order By AreaText,CargoTypeText,providedate desc
      ]]>
	  </Content>
    <Content Key="ReportSterilizePrepareSummary" Desc="灭菌准备报表" DataBaseType="SqlServer">
      <![CDATA[
     select fcp.ReadyDate READYDATE,c.BarCode CODE,st.Barcode BARCODE,u.Name NAME,1 as QTY from  FlowContainerPackage fcp
inner join FlowContainerPackageList fcpl
on fcp.ContainerPackageID=fcpl.ContainerPackageID
inner join Container c on c.ContainerID=fcp.ContainerID
inner join AC_User u on fcp.CreateBy=u.ID
inner join StorageList st on fcpl.PackageID=st.StorageID
where 1=1 {0}
order by fcp.ReadyDate desc
      ]]>
    </Content>
    <Content Key="ReportSterilizePrepareSummary" Desc="灭菌准备报表" DataBaseType="Oracle">
      <![CDATA[
     select fcp.ReadyDate READYDATE,c.BarCode CODE,st.Barcode BARCODE,u.Name NAME,1 QTY from  FlowContainerPackage fcp
inner join FlowContainerPackageList fcpl
on fcp.ContainerPackageID=fcpl.ContainerPackageID
inner join Container c on c.ContainerID=fcp.ContainerID
inner join AC_User u on fcp.CreateBy=u.ID
inner join StorageList st on fcpl.PackageID=st.StorageID
where 1=1 {0}
order by fcp.ReadyDate desc
      ]]>
    </Content>
    <Content Key="QueryDeviceTrack" Desc="设备的追溯" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      select distinct
      fl.PACKAGEID,
      fl.STORAGEID,
      sl.MAEDate as PACKAGEDATE,
      uu.FNames as FLOWPACKAGELISTUSERNAME,
      fl.USEDATE ,
      SBADFLAG.TypeName AS BADFLAGSHOW,
      fl.VALIDDATE,
      sl.EXPDATE,
      l.LOCATIONNAME,
      sl.STATUS,
      SSTATUS.TypeName AS STORAGESTATUS,
      sl.Barcode as STORAGEBARCODE,
      c.CargoTypeName as CARGOTYPENAME,
      ddul.begindate as WASHDATE,
      sdul.BEGINDATE
      from StorageList sl inner join FlowPackageList fl on sl.StorageID = fl.StorageID
      inner join CargoType c on fl.CargoTypeID = c.CargoTypeID
      left join AC_WorkGroup uu ON FL.UserID = uu.FID
      inner join SystemTypeParameter SBADFLAG ON FL.BadFlag = SBADFLAG.TypeValue AND SBADFLAG.TypeKey = 'QualifiedNO'
      left join Location l on sl.LocationID = l.LocationID
      inner join SystemTypeParameter SSTATUS ON SL.Status = SSTATUS.TypeValue AND SSTATUS.TypeKey = 'StorageStatus'
      --left join FlowPackageListDisinfect fld on fl.PackageID= fld.PackageID
      /*----*/
      left join FlowRecycleList frl on frl.PackageID=fl.PackageID
      left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      /*----*/

      left join FlowDisinfectContainerList fdc on fdc.FRecycleID = fr.FRecycleID
      left join FlowDisinfect fd on fd.FDisinfectID = fdc.FDisinfectID
      left join DevicesUseLog ddul on fd.LogID = ddul.LogID
      left join Devices dd on ddul.DeviceID = dd.DeviceID
      left join AC_WorkGroup du on ddul.UserID = du.FID
      left join FlowSterilizationList fsl on fl.PackageID = fsl.PackageID
      left join DevicesUseLog sdul on fsl.SterilizationLogID = sdul.LogID
      left join Devices sd on sdul.DeviceID = sd.DeviceID
      left join AC_WorkGroup su on sdul.UserID = su.FID Where 1=1 {0}
    </Content>
    <Content Key="QueryDeviceTrack" Desc="设备的追溯" DataBaseType="Oracle">
      select distinct
      fl.PACKAGEID,
      fl.STORAGEID,
      sl.MAEDate as PACKAGEDATE,
      uu.FNames as FLOWPACKAGELISTUSERNAME,
      fl.USEDATE ,
      SBADFLAG.TypeName AS BADFLAGSHOW,
      fl.VALIDDATE,
      sl.EXPDATE,
      l.LOCATIONNAME,
      sl.STATUS,
      SSTATUS.TypeName AS STORAGESTATUS,
      sl.Barcode as STORAGEBARCODE,
      c.CargoTypeName as CARGOTYPENAME,
      ddul.begindate as WASHDATE,
      sdul.BEGINDATE
      from StorageList sl inner join FlowPackageList fl on sl.StorageID = fl.StorageID
      inner join CargoType c on fl.CargoTypeID = c.CargoTypeID
      left join AC_WorkGroup uu ON FL.UserID = uu.FID
      inner join SystemTypeParameter SBADFLAG ON FL.BadFlag = SBADFLAG.TypeValue AND SBADFLAG.TypeKey = 'QualifiedNO'
      left join Location l on sl.LocationID = l.LocationID
      inner join SystemTypeParameter SSTATUS ON SL.Status = SSTATUS.TypeValue AND SSTATUS.TypeKey = 'StorageStatus'
      --left join FlowPackageListDisinfect fld on fl.PackageID= fld.PackageID
      /*----*/
      left join FlowRecycleList frl on frl.PackageID=fl.PackageID
      left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      /*----*/

      left join FlowDisinfectContainerList fdc on fdc.FRecycleID = fr.FRecycleID
      left join FlowDisinfect fd on fd.FDisinfectID = fdc.FDisinfectID
      left join DevicesUseLog ddul on fd.LogID = ddul.LogID
      left join Devices dd on ddul.DeviceID = dd.DeviceID
      left join AC_WorkGroup du on ddul.UserID = du.FID
      left join FlowSterilizationList fsl on fl.PackageID = fsl.PackageID
      left join DevicesUseLog sdul on fsl.SterilizationLogID = sdul.LogID
      left join Devices sd on sdul.DeviceID = sd.DeviceID
      left join AC_WorkGroup su on sdul.UserID = su.FID Where 1=1 {0}
    </Content>

    <Content Key="SummaryStockPackageApproximate" Desc="备包数" DataBaseType="SqlServer">
      <![CDATA[
        select A.ORGID,O.NAME AS ORGNAME,A.CARGOTYPEID,C.CARGOTYPENAME
		        ,(A.RECYCLEQTY - A.PROVIDEQTY) as SUPPLYQTY
		        ,(A.RECYCLEQTY - A.PROVIDEQTY + A.QTY - A.LOSTQTY) as SUMQTY
		        ,A.LOSTQTY
		        ,A.QTY
		        ,ISNULL(S.BASEQTY,0) as BASEQTY
            ,A.USEQTY
        FROM
        (	
          select ORGID,CARGOTYPEID
					  ,SUM(PROVIDEQTY) AS PROVIDEQTY
					  ,SUM(RECYCLEQTY) AS RECYCLEQTY
					  ,SUM(LOSTQTY) AS LOSTQTY
					  ,SUM(QTY) AS QTY
            ,SUM(USEQTY) AS USEQTY
			    FROM 
			    (
	          select fpv.OrgID as ORGID,pl.CARGOTYPEID,COUNT(1) as PROVIDEQTY,0 as RECYCLEQTY,0 as LOSTQTY,0 as QTY,0 as USEQTY
	          from FlowProvide fpv with (nolock) 
			          inner join FlowProvideList fpvl with (nolock) on fpv.ProvideID = fpvl.ProvideID
			          inner join FlowPackageList pl with (nolock) on fpvl.PackageID = pl.PackageID
	          WHERE pl.IsTemp = 0
	          group by fpv.OrgID,pl.CARGOTYPEID
	          union all
	          select w.OrgID as ORGID,pl.CARGOTYPEID,0 AS PROVIDEQTY,count(1) as RECYCLEQTY,sum(case pl.IsTemp when 1 THEN 1 ELSE 0 END) as LOSTQTY,0 AS QTY,0 as USEQTY
	          from FlowRecycleList frl with (nolock)
			          inner join FlowPackageList pl with (nolock) on frl.PackageID = pl.PackageID
			          inner join StorageList sl with (nolock) on pl.StorageID = sl.StorageID
			          inner join Warehouse w with (nolock) on sl.WarehouseID = w.WarehouseID	          where IsTemp = 1 or IsTemp = 0
	          group by w.OrgID,pl.CARGOTYPEID		
          union all
	          select w.OrgID as ORGID,pl.CARGOTYPEID,0 AS PROVIDEQTY,0 as RECYCLEQTY,0 as LOSTQTY,COUNT(1) AS QTY,sum(case sl.status when 70 then 1 else 0 end ) as USEQTY
	          from FlowPackageList pl with (nolock) 
			          inner join StorageList sl with (nolock) on pl.StorageID = sl.StorageID
			          inner join Warehouse w with (nolock) on sl.WarehouseID = w.WarehouseID
	          where sl.Status in (60,70)
	          group by w.OrgID,pl.CARGOTYPEID
          ) B
	        GROUP BY ORGID,CARGOTYPEID
        ) 
        A LEFT JOIN SAFESTOCK S with (nolock) on (A.ORGID = S.OrgID AND A.CargoTypeID = S.CargoTypeID)
          INNER JOIN CARGOTYPE C with (nolock) on (A.CARGOTYPEID = C.CARGOTYPEID)
          INNER JOIN AC_ORG O with (nolock) on (A.ORGID = O.ID)
          LEFT JOIN CargoTypeKind K with (nolock) on (C.CargoTypeKind = K.ID)
        where 1 = 1 {0}
      ]]>
    </Content>
    <Content Key="SummaryStockPackageApproximate" Desc="备包数" DataBaseType="Oracle">
      <![CDATA[
       select A.ORGID,O.NAME AS ORGNAME,A.CARGOTYPEID,C.CARGOTYPENAME
		        ,(A.RECYCLEQTY - A.PROVIDEQTY) as SUPPLYQTY
		        ,(A.RECYCLEQTY - A.PROVIDEQTY + A.QTY - A.LOSTQTY) as SUMQTY
		        ,A.LOSTQTY
		        ,A.QTY
		        ,nvl(S.BASEQTY,0) as BASEQTY
            ,A.USEQTY
        FROM
        (	
          select ORGID,CARGOTYPEID
					  ,SUM(PROVIDEQTY) AS PROVIDEQTY
					  ,SUM(RECYCLEQTY) AS RECYCLEQTY
					  ,SUM(LOSTQTY) AS LOSTQTY
					  ,SUM(QTY) AS QTY
            ,SUM(USEQTY) AS USEQTY
			    FROM 
			    (
	          select fpv.OrgID as ORGID,pl.CARGOTYPEID,COUNT(1) as PROVIDEQTY,0 as RECYCLEQTY,0 as LOSTQTY,0 as QTY,0 as USEQTY
	          from FlowProvide fpv 
			          inner join FlowProvideList fpvl on fpv.ProvideID = fpvl.ProvideID
			          inner join FlowPackageList pl on fpvl.PackageID = pl.PackageID
	          WHERE pl.IsTemp = 0
	          group by fpv.OrgID,pl.CARGOTYPEID
	          union all
	          select w.OrgID as ORGID,pl.CARGOTYPEID,0 AS PROVIDEQTY,count(1) as RECYCLEQTY,sum(case pl.IsTemp when 1 THEN 1 ELSE 0 END) as LOSTQTY,0 AS QTY,0 as USEQTY
	          from FlowRecycleList frl
			          inner join FlowPackageList pl on frl.PackageID = pl.PackageID
			          inner join StorageList sl on pl.StorageID = sl.StorageID
			          inner join Warehouse w on sl.WarehouseID = w.WarehouseID
	          where IsTemp = 1 or IsTemp = 0
	          group by w.OrgID,pl.CARGOTYPEID		
	          union all
	          select w.OrgID as ORGID,pl.CARGOTYPEID,0 AS PROVIDEQTY,0 as RECYCLEQTY,0 as LOSTQTY,COUNT(1) AS QTY,sum(case sl.status when 70 then 1 else 0 end ) as USEQTY
	          from FlowPackageList pl 
			          inner join StorageList sl on pl.StorageID = sl.StorageID
			          inner join Warehouse w on sl.WarehouseID = w.WarehouseID
	          where sl.Status in (60,70)
	          group by w.OrgID,pl.CARGOTYPEID
          ) B
	        GROUP BY ORGID,CARGOTYPEID
        ) 
        A LEFT JOIN SAFESTOCK S on (A.ORGID = S.OrgID AND A.CargoTypeID = S.CargoTypeID)
          INNER JOIN CARGOTYPE C on (A.CARGOTYPEID = C.CARGOTYPEID)
          INNER JOIN AC_ORG O on (A.ORGID = O.ID)
          LEFT JOIN CargoTypeKind K on (C.CargoTypeKind = K.ID)
        where 1 = 1 {0}
      ]]>
    </Content>

    <Content Key="SummaryStockPackage" Desc="器械包" DataBaseType="SqlServer">
      <![CDATA[
      select * from 
      (SELECT SL.STORAGEID,C.CARGOTYPENAME,C.CARGOTOPTYPE,C.CARGOTYPEKIND,SL.BARCODE,SL.QUANTITY,L.LOCATIONNAME,W.WAREHOUSENAME,ST.TypeName AS STATUSNAME,Datediff(DAY,GETDATE(),SL.EXPDate) AS EXPIREDAYS,SL.EXPDATE
      FROM STORAGELIST SL WITH (NOLOCK) INNER JOIN CARGOTYPE C WITH (NOLOCK) ON SL.CARGOTYPEID = C.CARGOTYPEID
      INNER JOIN FLOWPACKAGELIST FPL WITH (NOLOCK) ON SL.STORAGEID = FPL.STORAGEID
      INNER JOIN LOCATION L WITH (NOLOCK) ON SL.LOCATIONID = L.LOCATIONID
      INNER JOIN WAREHOUSE W WITH (NOLOCK) ON SL.WAREHOUSEID = W.WAREHOUSEID
      INNER JOIN SystemTypeParameter ST WITH (NOLOCK) ON SL.Status = ST.TypeValue AND ST.TypeKey = 'StorageStatus'
      WHERE SL.Status <> 20 and SL.Status <1000 and FPL.ISTEMP <> 99 AND FPL.ISTEMP <> 1) Stock where 1=1 {0}
      ]]>
    </Content>
    <Content Key="SummaryStockPackage" Desc="器械包" DataBaseType="Oracle">
      <![CDATA[
      select * from 
      (SELECT SL.STORAGEID,C.CARGOTYPENAME,C.CARGOTOPTYPE,C.CARGOTYPEKIND,SL.BARCODE,SL.QUANTITY,L.LOCATIONNAME,W.WAREHOUSENAME,ST.TypeName AS STATUSNAME,datediff('D',SL.EXPDate,sysdate) AS EXPIREDAYS,SL.EXPDATE
      FROM STORAGELIST SL  INNER JOIN CARGOTYPE C  ON SL.CARGOTYPEID = C.CARGOTYPEID
      INNER JOIN FLOWPACKAGELIST FPL  ON SL.STORAGEID = FPL.STORAGEID
      INNER JOIN LOCATION L  ON SL.LOCATIONID = L.LOCATIONID
      INNER JOIN WAREHOUSE W  ON SL.WAREHOUSEID = W.WAREHOUSEID
      INNER JOIN SystemTypeParameter ST  ON SL.Status = ST.TypeValue AND ST.TypeKey = 'StorageStatus'
      WHERE SL.Status <> 20 and SL.Status <1000 and FPL.ISTEMP <> 99 AND FPL.ISTEMP <> 1 ) Stock where 1=1 {0}
      ]]>
    </Content>

    <Content Key="GetFlowDisinfectDevices" Desc="清洗消毒追溯" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT pl.PACKAGEID
      ,fdcl.CHECKID
      ,uchecker.FNames as FLOWRECYCLECONTAINERCHECKNAME
      ,fdcl.CHECKDATE
      ,c.CONTAINERNAME
      ,fdcl.WASHTYPE
      ,stpwashtype.TypeName as  WASHTYPENAME
      ,dl.LOGID
      ,udluser.FNames as CLEANUSERNAME
      ,d.DeviceName as FLOWRECYCLECONTAINERLOGNAME
      ,fdcl.STATUS
      ,stpcontainerstatus.TYPENAME AS CONTAINERSTATUS
      ,sl.Barcode as STORAGEBARCODE
      ,ct.CARGOTYPENAME
      ,fdcl.WASHDATE
      ,isnull(prule.RuleName,'') as RULENAME
      ,w.WAREHOUSENAME
      ,pluser.FNames as FLOWPACKAGELISTUSERNAME
      ,pstatus.TypeName as STATUSNAME
      ,pl.PATIENTID
      ,Patient.PATIENTNAME
      FROM
      FlowPackageList pl inner join StorageList sl on pl.StorageID = sl.StorageID
      inner JOIN FLOWPACKAGELISTDISINFECT pld ON pld.PACKAGEID = pl.PACKAGEID
      inner join FlowDisinfectContainerList fdcl on pld.FRecycleID = fdcl.FRecycleID
      inner join DevicesUseLog dl on fdcl.DeviceLogID = dl.LogID
      inner join Devices d on dl.DeviceID = d.DeviceID
      inner join Container c on fdcl.ContainerID = c.ContainerID
      inner join CargoType ct on pl.CargoTypeID = ct.CargoTypeID
      left join AC_WorkGroup uchecker on fdcl.CheckID = uchecker.FID
      left join SYSTEMTYPEPARAMETER stpwashtype on stpwashtype.typevalue = fdcl.WASHTYPE  and stpwashtype.TYPEKEY='WashType'
      left join AC_WorkGroup udluser on dl.UserID = udluser.FID
      left join SystemTypeParameter stpcontainerstatus on stpcontainerstatus.TypeValue = fdcl.STATUS and stpcontainerstatus.TYPEKEY='ContainerStatus'
      LEFT JOIN DEVICEPROCESSRULE prule ON dl.DEVICEPROCESSRULEID = prule.RULEID
      left join Warehouse w on pl.LastWarehouseID = w.WarehouseID
      left join AC_WorkGroup pluser on pl.UserID = pluser.FID
      left join SystemTypeParameter pstatus on pstatus.TypeValue = sl.Status and pstatus.TypeKey = 'StorageStatus'
      left join PatientList Patient on pl.PatientID =Patient.PatientID
      WHERE 1=1 {0}
    </Content>
    <Content Key="GetFlowDisinfectDevices" Desc="清洗消毒追溯" DataBaseType="Oracle">
      SELECT pl.PACKAGEID
      ,fdcl.CHECKID
      ,uchecker.FNames as FLOWRECYCLECONTAINERCHECKNAME
      ,fdcl.CHECKDATE
      ,c.CONTAINERNAME
      ,fdcl.WASHTYPE
      ,stpwashtype.TypeName as  WASHTYPENAME
      ,dl.LOGID
      ,udluser.FNames as CLEANUSERNAME
      ,d.DeviceName as FLOWRECYCLECONTAINERLOGNAME
      ,fdcl.STATUS
      ,stpcontainerstatus.TYPENAME AS CONTAINERSTATUS
      ,sl.Barcode as STORAGEBARCODE
      ,ct.CARGOTYPENAME
      ,fdcl.WASHDATE
      ,nvl(prule.RuleName,'') as RULENAME
      ,w.WAREHOUSENAME
      ,pluser.FNames as FLOWPACKAGELISTUSERNAME
      ,pstatus.TypeName as STATUSNAME
      ,pl.PATIENTID
      ,Patient.PATIENTNAME
      FROM
      FlowPackageList pl inner join StorageList sl on pl.StorageID = sl.StorageID
      inner JOIN FLOWPACKAGELISTDISINFECT pld ON pld.PACKAGEID = pl.PACKAGEID
      inner join FlowDisinfectContainerList fdcl on pld.FRecycleID = fdcl.FRecycleID
      inner join DevicesUseLog dl on fdcl.DeviceLogID = dl.LogID
      inner join Devices d on dl.DeviceID = d.DeviceID
      inner join Container c on fdcl.ContainerID = c.ContainerID
      inner join CargoType ct on pl.CargoTypeID = ct.CargoTypeID
      left join AC_WorkGroup uchecker on fdcl.CheckID = uchecker.FID
      left join SYSTEMTYPEPARAMETER stpwashtype on stpwashtype.typevalue = fdcl.WASHTYPE  and stpwashtype.TYPEKEY='WashType'
      left join AC_WorkGroup udluser on dl.UserID = udluser.FID
      left join SystemTypeParameter stpcontainerstatus on stpcontainerstatus.TypeValue = fdcl.STATUS and stpcontainerstatus.TYPEKEY='ContainerStatus'
      LEFT JOIN DEVICEPROCESSRULE prule ON dl.DEVICEPROCESSRULEID = prule.RULEID
      left join Warehouse w on pl.LastWarehouseID = w.WarehouseID
      left join AC_WorkGroup pluser on pl.UserID = pluser.FID
      left join SystemTypeParameter pstatus on pstatus.TypeValue = sl.Status and pstatus.TypeKey = 'StorageStatus'
      left join PatientList Patient on pl.PatientID =Patient.PatientID
      WHERE 1=1 {0}
    </Content>

    <Content Key="GetFlowSterilizeDevices" Desc="灭菌追溯" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      select pl.PACKAGEID
      ,dl.LOGID
      ,d.DEVICEID
      ,d.DEVICENAME
      ,dl.BEGINDATE
      ,dl.ENDDATE
      ,dluser.FID as DEVICESUSELOGUSERID
      ,dluser.FNames as DEVICESUSELOGUSERNAME
      ,pisok.TypeName as ISOK
      ,dl.USETIMES
      ,dl.TODAYUSETIMES
      ,dl.AFTERMAINTAINUSETIMES
      ,sl.Barcode as STORAGEBARCODE
      ,dlchecker.FID as DEVICESUSELOGCHECKID
      ,dlchecker.FNames as DEVICESUSELOGCHECKNAME
      ,pl.PATIENTID
      ,Patient.PATIENTNAME
      ,dl.CHECKDATE
      ,pbadflag.TypeName as BADFLAGSHOW
      ,w.WAREHOUSENAME
      ,sl.Barcode as STORAGEBARCODE
      ,pluser.FNames as FLOWPACKAGELISTUSERNAME
      ,pstatus.TYPENAME
      ,isnull(prule.RULENAME,'') as RULENAME
      ,c.CARGOTYPENAME
      ,d.LASTBPCDDATE,PATIENT.MEDICALRECORDCODE,PATIENT.BEDNO
      from FlowPackageList pl inner join StorageList sl on pl.StorageID = sl.StorageID
      inner join FlowSterilizationList fsl on pl.PackageID = fsl.PackageID
      inner join DevicesUseLog dl on fsl.SterilizationLogID = dl.LogID
      inner join Devices d on dl.DeviceID = d.DeviceID
      inner join AC_WorkGroup dluser on dl.UserID = dluser.FID
      LEFT join AC_WorkGroup dlchecker on dl.CheckID = dlchecker.FID
      LEFT join SystemTypeParameter pisok on dl.IsOk = pisok.TypeValue and pisok.TypeKey = 'IsOK'
      left join SystemTypeParameter pbadflag on pl.BadFlag = pbadflag.TypeValue and pbadflag.TypeKey = 'QualifiedNO'
      left join PatientList Patient on pl.PatientID =Patient.PatientID
      left join Warehouse w on pl.LastWarehouseID = w.WarehouseID
      left join AC_WorkGroup pluser on pl.UserID = pluser.FID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      left join SystemTypeParameter pstatus on pstatus.TypeValue = sl.Status and pstatus.TypeKey = 'StorageStatus'
      LEFT JOIN DEVICEPROCESSRULE prule ON dl.DEVICEPROCESSRULEID = prule.RULEID
      where 1=1 {0}
    </Content>
    <Content Key="GetFlowSterilizeDevices" Desc="灭菌追溯" DataBaseType="Oracle">
      select pl.PACKAGEID
      ,dl.LOGID
      ,d.DEVICEID
      ,d.DEVICENAME
      ,dl.BEGINDATE
      ,dl.ENDDATE
      ,dluser.FID as DEVICESUSELOGUSERID
      ,dluser.FNames as DEVICESUSELOGUSERNAME
      ,pisok.TypeName as ISOK
      ,dl.USETIMES
      ,dl.TODAYUSETIMES
      ,dl.AFTERMAINTAINUSETIMES
      ,sl.Barcode as STORAGEBARCODE
      ,dlchecker.FID as DEVICESUSELOGCHECKID
      ,dlchecker.FNames as DEVICESUSELOGCHECKNAME
      ,pl.PATIENTID
      ,Patient.PATIENTNAME
      ,dl.CHECKDATE
      ,pbadflag.TypeName as BADFLAGSHOW
      ,w.WAREHOUSENAME
      ,sl.Barcode as STORAGEBARCODE
      ,pluser.FNames as FLOWPACKAGELISTUSERNAME
      ,pstatus.TYPENAME
      ,nvl(prule.RULENAME,'') as RULENAME
      ,c.CARGOTYPENAME
      ,d.LASTBPCDDATE,PATIENT.MEDICALRECORDCODE,PATIENT.BEDNO
      from FlowPackageList pl inner join StorageList sl on pl.StorageID = sl.StorageID
      inner join FlowSterilizationList fsl on pl.PackageID = fsl.PackageID
      inner join DevicesUseLog dl on fsl.SterilizationLogID = dl.LogID
      inner join Devices d on dl.DeviceID = d.DeviceID
      inner join AC_WorkGroup dluser on dl.UserID = dluser.FID
      LEFT join AC_WorkGroup dlchecker on dl.CheckID = dlchecker.FID
      LEFT join SystemTypeParameter pisok on dl.IsOk = pisok.TypeValue and pisok.TypeKey = 'IsOK'
      left join SystemTypeParameter pbadflag on pl.BadFlag = pbadflag.TypeValue and pbadflag.TypeKey = 'QualifiedNO'
      left join PatientList Patient on pl.PatientID =Patient.PatientID
      left join Warehouse w on pl.LastWarehouseID = w.WarehouseID
      left join AC_WorkGroup pluser on pl.UserID = pluser.FID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      left join SystemTypeParameter pstatus on pstatus.TypeValue = sl.Status and pstatus.TypeKey = 'StorageStatus'
      LEFT JOIN DEVICEPROCESSRULE prule ON dl.DEVICEPROCESSRULEID = prule.RULEID
      where 1=1 {0}
    </Content>

    <Content Key="GetFlowRecyclePackageCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      where 1=1
    </Content>
    <Content Key="GetFlowRecyclePackageCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      where 1=1
    </Content>

    <Content Key="GetFlowRecyclePackageCountByDateID" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      inner join FLOWPACKAGELIST FP on fp.PackageID=rl.PackageID
      where 1=1
    </Content>
    <Content Key="GetFlowRecyclePackageCountByDateID" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      inner join FLOWPACKAGELIST FP on fp.PackageID=rl.PackageID
      where 1=1
    </Content>

    <Content Key="GetFlowWaitDisinfectPackageCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      where 1=1 and
      not exists (select 1 from FlowRecycleContainer cd  where cd.FRecycleID =  r.FRecycleID  and  cd.LastFDisinfectID is not null )
    </Content>
    <Content Key="GetFlowWaitDisinfectPackageCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      where 1=1 and
      not exists (select 1 from FlowRecycleContainer cd  where cd.FRecycleID =  r.FRecycleID  and  cd.LastFDisinfectID is not null )
    </Content>

    <Content Key="GetFlowDisinfectedPackageCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      where 1=1 and
      not exists (select 1 from FlowRecycleContainer cd  where cd.FRecycleID =  r.FRecycleID  and  cd.LastFDisinfectID is  null )
    </Content>
    <Content Key="GetFlowDisinfectedPackageCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowRecycle r  inner join FlowRecycleList rl  on r.FRecycleID = rl.FRecycleID
      where 1=1 and
      not exists (select 1 from FlowRecycleContainer cd  where cd.FRecycleID =  r.FRecycleID  and  cd.LastFDisinfectID is  null )
    </Content>

    <Content Key="GetFlowPackageCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowPackageList fl  inner join FlowPackage fp  on fl.FPackageID = fp.FPackageID
      where 1=1
    </Content>
    <Content Key="GetFlowPackageCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowPackageList fl  inner join FlowPackage fp  on fl.FPackageID = fp.FPackageID
      where 1=1
    </Content>

    <Content Key="GetFlowPackageCountByDateID" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowPackageList fl  inner join FlowPackage fp  on fl.FPackageID = fp.FPackageID
      where 1=1
    </Content>
    <Content Key="GetFlowPackageCountByDateID" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowPackageList fl  inner join FlowPackage fp  on fl.FPackageID = fp.FPackageID
      where 1=1
    </Content>

    <Content Key="GetWaitSterilizeCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowPackageList fl  inner join FlowPackage fp  on fl.FPackageID = fp.FPackageID
      where 1=1 and
      not exists (select 1 from FlowSterilizationList sl where sl. PackageID = fl. PackageID)
    </Content>
    <Content Key="GetWaitSterilizeCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowPackageList fl  inner join FlowPackage fp  on fl.FPackageID = fp.FPackageID
      where 1=1 and
      not exists (select 1 from FlowSterilizationList sl where sl. PackageID = fl. PackageID)
    </Content>

    <Content Key="GetSterilizingCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowSterilizationList sl  inner join FlowPackageList p  on sl.PackageID = p.PackageID
      inner join DevicesUseLog dl  on sl.SterilizationLogID = dl.LogID
      where  dl.IsOk =0
    </Content>
    <Content Key="GetSterilizingCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowSterilizationList sl  inner join FlowPackageList p  on sl.PackageID = p.PackageID
      inner join DevicesUseLog dl  on sl.SterilizationLogID = dl.LogID
      where  dl.IsOk =0
    </Content>

    <Content Key="GetSterilizedCountByDate" Desc="" DataBaseType="SqlServer">
      select COUNT(1)
      from FlowSterilizationList sl  inner join FlowPackageList p  on sl.PackageID = p.PackageID
      inner join DevicesUseLog dl  on sl.SterilizationLogID = dl.LogID
      where   dl.IsOk =1
    </Content>
    <Content Key="GetSterilizedCountByDate" Desc="" DataBaseType="Oracle">
      select COUNT(1)
      from FlowSterilizationList sl  inner join FlowPackageList p  on sl.PackageID = p.PackageID
      inner join DevicesUseLog dl  on sl.SterilizationLogID = dl.LogID
      where   dl.IsOk =1
    </Content>

    <Content Key="GetProvideCountByDate" Desc="" DataBaseType="SqlServer">
      select  COUNT(1)
      from FlowProvide p  inner join FlowProvideList pl  on p.ProvideID = pl.ProvideID
      where 1=1
    </Content>
    <Content Key="GetProvideCountByDate" Desc="" DataBaseType="Oracle">
      select  COUNT(1)
      from FlowProvide p  inner join FlowProvideList pl  on p.ProvideID = pl.ProvideID
      where 1=1
    </Content>

    <Content Key="Report_GetUserFlowPackageTrackA" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      select  AC_User.Name NAME,AC_User.Code CODE
      ,w.RecycleNum RECYCLENUM,e.PackageNum PACKAGENUM,r.ProvideNum PROVIDENUM,t.SterilizeNum STERILIZENUM,y.Num NUM
      from AC_User left join AC_OrgUser
      on
      AC_User.ID=AC_OrgUser.UserID
      left join (select a.OPID,count(b.PackageID) RecycleNum from FlowRecycle  a  inner join FlowRecycleList  b
      on
      a.FRecycleID=b.FRecycleID
      where  RecycleDate  between @useData1  and @useData2
      
      group by a.OPID) w
      on
      AC_User.ID=w.OPID
      full join (select FlowPackage.OPID,COUNT(PackageID) PackageNum from FlowPackageList
      inner join FlowPackage on FlowPackageList.FPackageID =FlowPackage.FPackageID
      where FlowPackage.PackageDate  between @useData1  and @useData2
      
      group by FlowPackage.OPID) e
      on
      AC_User.ID=e.OPID full join
      (Select OPID,count(b.PackageID)ProvideNum from FlowProvide  a inner join FlowProvideList  b
      on
      a.ProvideID=b.ProvideID
      where ProvideDate between @useData1  and @useData2
      
      group by OPID) r
      on
      AC_User.ID=r.OPID full join
      (select ou.ID,sum(dl.TodayUseTimes)  SterilizeNum From DevicesUseLog dl inner join Devices d on dl.DeviceID = d.deviceid
      Inner join AC_User ou on dl. UserID= ou.id
      Where d.DeviceType >= 4 and dl.BeginDate between @useData1  and @useData2
      
      group by ou.ID) t
      on
      AC_User.ID=t.ID full join
      (select a.UserID,COUNT(e.ContainerID)  Num
      from DevicesUseLog  a left join Devices  b
      on
      a.DeviceID=b.DeviceID
      left join FlowDisinfect  c
      on
      a.LogID=c.LogID left join FlowDisinfectContainerList  d
      on
      c.FDisinfectID=d.FDisinfectID
      left join Container  e
      on
      d.ContainerID=e.ContainerID
      where DeviceType < 3  and a.BeginDate between @useData1  and @useData2
      
      group by a.UserID) y
      on
      AC_User.ID=y.UserID
      where (w.RecycleNum is  not null or r.ProvideNum is  not null or  e.PackageNum is  not null
      and t.SterilizeNum is not null or y.Num is  not null) and AC_User.FlowOrgID=@floworgid
      
      ]]>
    </Content>
    <Content Key="Report_GetUserFlowPackageTrackA" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select  AC_User.Name NAME,AC_User.Code CODE
      ,w.RecycleNum RECYCLENUM,e.PackageNum PACKAGENUM,r.ProvideNum PROVIDENUM,t.SterilizeNum STERILIZENUM,y.Num NUM
      from AC_User left join AC_OrgUser
      on
      AC_User.ID=AC_OrgUser.UserID
      left join (select a.OPID,count(b.PackageID) RecycleNum from FlowRecycle  a  inner join FlowRecycleList  b
      on
      a.FRecycleID=b.FRecycleID
      where  RecycleDate  between :useData1  and :useData2
      
      group by a.OPID) w
      on
      AC_User.ID=w.OPID
      full join (select FlowPackage.OPID,COUNT(PackageID) PackageNum from FlowPackageList
      inner join FlowPackage on FlowPackageList.FPackageID =FlowPackage.FPackageID
      where FlowPackage.PackageDate  between :useData1  and :useData2
      
      group by FlowPackage.OPID) e
      on
      AC_User.ID=e.OPID full join
      (Select OPID,count(b.PackageID)ProvideNum from FlowProvide  a inner join FlowProvideList  b
      on
      a.ProvideID=b.ProvideID
      where ProvideDate between :useData1 and :useData2
      
      group by OPID) r
      on
      AC_User.ID=r.OPID full join
      (select ou.ID,sum(dl.TodayUseTimes)  SterilizeNum From DevicesUseLog dl inner join Devices d on dl.DeviceID = d.deviceid
      Inner join AC_User ou on dl. UserID= ou.id
      Where d.DeviceType >= 4 and dl.BeginDate between :useData1  and :useData2
      
      group by ou.ID) t
      on
      AC_User.ID=t.ID full join
      (select a.UserID,COUNT(e.ContainerID)  Num
      from DevicesUseLog  a left join Devices  b
      on
      a.DeviceID=b.DeviceID
      left join FlowDisinfect  c
      on
      a.LogID=c.LogID left join FlowDisinfectContainerList  d
      on
      c.FDisinfectID=d.FDisinfectID
      left join Container  e
      on
      d.ContainerID=e.ContainerID
      where DeviceType < 3  and a.BeginDate between :useData1  and :useData2
      
      group by a.UserID) y
      on
      AC_User.ID=y.UserID
      where (w.RecycleNum is  not null or r.ProvideNum is  not null or  e.PackageNum is  not null
      and t.SterilizeNum is not null or y.Num is  not null) and AC_User.FlowOrgID=:floworgid
      
      ]]>
    </Content>

    <Content Key="Report_GetUserFlowPackageTrackB" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      select  AC_User.Name NAME,AC_User.Code CODE
      ,w.RecycleNum RECYCLENUM,e.PackageNum PACKAGENUM,r.ProvideNum PROVIDENUM,t.SterilizeNum STERILIZENUM,y.Num NUM
      from AC_User left join AC_OrgUser
      on
      AC_User.ID=AC_OrgUser.UserID
      left join (select a.OPID,count(b.PackageID) RecycleNum from FlowRecycle  a  inner join FlowRecycleList  b
      on
      a.FRecycleID=b.FRecycleID
      where  RecycleDate  between @useData1  and @useData2
      and a.OPID=@useID
      
      group by a.OPID) w
      on
      AC_User.ID=w.OPID
      full join (select FlowPackage.OPID,COUNT(PackageID) PackageNum from FlowPackageList
      inner join FlowPackage on FlowPackageList.FPackageID =FlowPackage.FPackageID
      where FlowPackage.PackageDate  between @useData1  and @useData2
      and OPID=@useID
      
      group by FlowPackage.OPID) e
      on
      AC_User.ID=e.OPID full join
      (Select OPID,count(b.PackageID)ProvideNum from FlowProvide  a inner join FlowProvideList  b
      on
      a.ProvideID=b.ProvideID
      where ProvideDate between @useData1  and @useData2
      and a.OPID=@useID
      
      group by OPID) r
      on
      AC_User.ID=r.OPID full join
      (select ou.ID,sum(dl.TodayUseTimes)  SterilizeNum From DevicesUseLog dl inner join Devices d on dl.DeviceID = d.deviceid
      Inner join AC_User ou on dl. UserID= ou.id
      Where d.DeviceType >= 4 and dl.BeginDate between @useData1  and @useData2
      and ou.ID=@useID
      
      group by ou.ID) t
      on
      AC_User.ID=t.ID full join
      (select a.UserID,COUNT(e.ContainerID)  Num
      from DevicesUseLog  a left join Devices  b
      on
      a.DeviceID=b.DeviceID
      left join FlowDisinfect  c
      on
      a.LogID=c.LogID left join FlowDisinfectContainerList  d
      on
      c.FDisinfectID=d.FDisinfectID
      left join Container  e
      on
      d.ContainerID=e.ContainerID
      where DeviceType < 3  and a.BeginDate between @useData1  and @useData2
      and a.UserID=@useID
      
      group by a.UserID) y
      on
      AC_User.ID=y.UserID
      where (w.RecycleNum is  not null or r.ProvideNum is  not null or  e.PackageNum is  not null
      and t.SterilizeNum is not null or y.Num is  not null) and AC_User.FlowOrgID=@floworgid
      
      ]]>
    </Content>
    <Content Key="Report_GetUserFlowPackageTrackB" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select  AC_User.Name NAME,AC_User.Code CODE
      ,w.RecycleNum RECYCLENUM,e.PackageNum PACKAGENUM,r.ProvideNum PROVIDENUM,t.SterilizeNum STERILIZENUM,y.Num NUM
      from AC_User left join AC_OrgUser
      on
      AC_User.ID=AC_OrgUser.UserID
      left join (select a.OPID,count(b.PackageID) RecycleNum from FlowRecycle  a  inner join FlowRecycleList  b
      on
      a.FRecycleID=b.FRecycleID
      where  RecycleDate  between :useData1  and :useData2
      and a.OPID=:useID
      
      group by a.OPID) w
      on
      AC_User.ID=w.OPID
      full join (select FlowPackage.OPID,COUNT(PackageID) PackageNum from FlowPackageList
      inner join FlowPackage on FlowPackageList.FPackageID =FlowPackage.FPackageID
      where FlowPackage.PackageDate  between :useData1  and :useData2
      and OPID=:useID
      
      group by FlowPackage.OPID) e
      on
      AC_User.ID=e.OPID full join
      (Select OPID,count(b.PackageID)ProvideNum from FlowProvide  a inner join FlowProvideList  b
      on
      a.ProvideID=b.ProvideID
      where ProvideDate between :useData1 and :useData2
      and a.OPID=:useID
      
      group by OPID) r
      on
      AC_User.ID=r.OPID full join
      (select ou.ID,sum(dl.TodayUseTimes)  SterilizeNum From DevicesUseLog dl inner join Devices d on dl.DeviceID = d.deviceid
      Inner join AC_User ou on dl. UserID= ou.id
      Where d.DeviceType >= 4 and dl.BeginDate between :useData1  and :useData2
      and ou.ID=:useID
      
      group by ou.ID) t
      on
      AC_User.ID=t.ID full join
      (select a.UserID,COUNT(e.ContainerID)  Num
      from DevicesUseLog  a left join Devices  b
      on
      a.DeviceID=b.DeviceID
      left join FlowDisinfect  c
      on
      a.LogID=c.LogID left join FlowDisinfectContainerList  d
      on
      c.FDisinfectID=d.FDisinfectID
      left join Container  e
      on
      d.ContainerID=e.ContainerID
      where DeviceType < 3  and a.BeginDate between :useData1  and :useData2
      and a.UserID=:useID
      
      group by a.UserID) y
      on
      AC_User.ID=y.UserID
      where (w.RecycleNum is  not null or r.ProvideNum is  not null or  e.PackageNum is  not null
      and t.SterilizeNum is not null or y.Num is  not null) and AC_User.FlowOrgID=:floworgid
      
      ]]>
    </Content>

    <Content Key="Report_Recycletotal" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      select SUM(isnull(c.InstrumentsNumber,1)) As RECYCLETOTAL
      from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
      inner join FlowPackageList pl on frl.PackageID = pl.PackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where fr.RecycleDate between  @begindate  and  @enddate and fr.FlowOrgID=@floworgid
      ]]>
    </Content>

    <Content Key="Report_Recycletotal" Desc="" DataBaseType="Oracle">      
      <![CDATA[
     select SUM(nvl(c.InstrumentsNumber,1)) As RECYCLETOTAL
      from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
      inner join FlowPackageList pl on frl.PackageID = pl.PackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where fr.RecycleDate between  :begindate  and  :enddate and fr.FlowOrgID= :floworgid
       ]]>
    </Content>

    <Content Key="Report_Packagetotal" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      select SUM(isnull(c.InstrumentsNumber,1)) As PACKAGETOTAL
      from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where p.PackageDate between @begindate and @enddate  and istemp = 0  and p.FlowOrgID = @floworgid
      ]]>
    </Content>
    
    <Content Key="Report_Packagetotal" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select SUM(nvl(c.InstrumentsNumber,1)) As PACKAGETOTAL
      from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where p.PackageDate between :begindate and :enddate  and istemp = 0  and p.FlowOrgID = :floworgid
      ]]>
    </Content> 

    <Content Key="Report_Sterilizationtotal" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      select SUM(isnull(c.InstrumentsNumber,1)) As STERILIZATIONTOTAL
      from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
      inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where dl.BeginDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid
      ]]>
    </Content>

    <Content Key="Report_Sterilizationtotal" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select SUM(nvl(c.InstrumentsNumber,1)) As STERILIZATIONTOTAL
      from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
      inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where dl.BeginDate between  :begindate  and  :enddate and pl.FlowOrgID= :floworgid
      ]]>
    </Content>

    <Content Key="Report_Providetotal" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      select SUM(isnull(c.InstrumentsNumber,1)) As PROVIDETOTAL
      from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
      inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where fp.ProvideDate between  @begindate  and  @enddate and fp.FlowOrgID=@floworgid
      ]]>
    </Content>

    <Content Key="Report_Providetotal" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select SUM(nvl(c.InstrumentsNumber,1)) As PROVIDETOTAL
      from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
      inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
      inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
      where fp.ProvideDate between  :begindate  and  :enddate and fp.FlowOrgID= :floworgid
      ]]>
    </Content>
    
    <Content Key="Report_UserTeamWorkReportA" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;	  
      
	  select 'A.回收清洗' as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@recycletotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fr.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fr.FlowOrgID=we.FlowOrgID
      where fr.RecycleDate between  @begindate  and  @enddate and fr.FlowOrgID=@floworgid  and we.WeightTypeID=0
      group by u.ID,u.Name
      union all
      select 'B.配包'  as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@packagetotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
							  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
							  inner join AC_WorkGroup g   on p.opid = g.FID
							  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
							  inner join AC_User u on gu.FUserID=u.ID
							  inner join Weight we on p.FlowOrgID=we.FlowOrgID
      where p.PackageDate between @begindate and @enddate  and istemp = 0  and p.FlowOrgID=@floworgid and we.WeightTypeID=2
      group by u.ID,u.Name
      union all
      select 'C.灭菌'  as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@sterilizationtotal * 100 AS VALUE,
       sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on dl.UserID = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on pl.FlowOrgID=we.FlowOrgID
      where dl.BeginDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid  and we.WeightTypeID=3
      group by u.ID,u.Name
      union all
      select 'D.发放' as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@providetotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fp.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fp.FlowOrgID=we.FlowOrgID
      where fp.ProvideDate between @begindate and @enddate  and fp.FlowOrgID=@floworgid and we.WeightTypeID=4
      group by u.ID,u.Name
      
      ]]>
    </Content>
    <Content Key="Report_UserTeamWorkReportA" Desc="" DataBaseType="Oracle">
      <![CDATA[     		
     		
	  select 'A.回收清洗' as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :recycletotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fr.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fr.FlowOrgID=we.FlowOrgID
      where fr.RecycleDate between  :begindate  and  :enddate and fr.FlowOrgID=  :floworgid  and we.WeightTypeID=0
      group by u.ID,u.Name
      union all
      select 'B.配包'  as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :packagetotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
							  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
							  inner join AC_WorkGroup g   on p.opid = g.FID
							  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
							  inner join AC_User u on gu.FUserID=u.ID
							  inner join Weight we on p.FlowOrgID=we.FlowOrgID
      where p.PackageDate between :begindate and :enddate  and istemp = 0  and p.FlowOrgID=  :floworgid and we.WeightTypeID=2
      group by u.ID,u.Name
      union all
      select 'C.灭菌'  as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :sterilizationtotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on dl.UserID = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on pl.FlowOrgID=we.FlowOrgID
      where dl.BeginDate between  :begindate  and  :enddate and pl.FlowOrgID= :floworgid  and we.WeightTypeID=3
      group by u.ID,u.Name
      union all
      select 'D.发放' as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :providetotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fp.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fp.FlowOrgID=we.FlowOrgID
      where fp.ProvideDate between :begindate and :enddate  and fp.FlowOrgID= :floworgid and we.WeightTypeID=4
      group by u.ID,u.Name
      
      
      ]]>
    </Content>

        
    <Content Key="Report_UserTeamWorkReportB" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
          
	  select 'A.回收清洗' as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@recycletotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fr.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fr.FlowOrgID=we.FlowOrgID
      where fr.RecycleDate between  @begindate  and  @enddate and fr.FlowOrgID=@floworgid and u.ID = @userid and we.WeightTypeID=0
      group by u.ID,u.Name
      union all
      select 'B.配包'  as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@packagetotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
							  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
							  inner join AC_WorkGroup g   on p.opid = g.FID
							  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
							  inner join AC_User u on gu.FUserID=u.ID
							  inner join Weight we on p.FlowOrgID=we.FlowOrgID
      where p.PackageDate between @begindate and @enddate  and istemp = 0  and p.FlowOrgID=@floworgid and u.ID = @userid and we.WeightTypeID=2
      group by u.ID,u.Name
      union all
      select 'C.灭菌'  as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@sterilizationtotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on dl.UserID = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on pl.FlowOrgID=we.FlowOrgID
      where dl.BeginDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and u.ID = @userid  and we.WeightTypeID=3
      group by u.ID,u.Name
      union all
      select 'D.发放' as WORKTYPE,u.Name as USERNAME,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/@providetotal * 100 AS VALUE,
      sum(isnull(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fp.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fp.FlowOrgID=we.FlowOrgID
      where fp.ProvideDate between @begindate and @enddate  and fp.FlowOrgID=@floworgid and u.ID = @userid and we.WeightTypeID=4
      group by u.ID,u.Name
      ]]>
    </Content>
    <Content Key="Report_UserTeamWorkReportB" Desc="" DataBaseType="Oracle">
      <![CDATA[      
      
	  select 'A.回收清洗' as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :recycletotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fr.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fr.FlowOrgID=we.FlowOrgID
      where fr.RecycleDate between  :begindate  and  :enddate and fr.FlowOrgID=  :floworgid and u.ID =  :userid  and we.WeightTypeID=0
      group by u.ID,u.Name    
      union all
      select 'B.配包'  as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :packagetotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
							  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
							  inner join AC_WorkGroup g   on p.opid = g.FID
							  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
							  inner join AC_User u on gu.FUserID=u.ID
							  inner join Weight we on p.FlowOrgID=we.FlowOrgID
      where p.PackageDate between  :begindate and  :enddate  and istemp = 0  and p.FlowOrgID=  :floworgid and u.ID =  :userid  and we.WeightTypeID=2
      group by u.ID,u.Name
      union all
      select 'C.灭菌'  as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :sterilizationtotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on dl.UserID = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on pl.FlowOrgID=we.FlowOrgID
      where dl.BeginDate between  :begindate  and  :enddate and pl.FlowOrgID=  :floworgid and u.ID =  :userid   and we.WeightTypeID=3
      group by u.ID,u.Name
      union all
      select 'D.发放' as WORKTYPE,u.Name as USERNAME,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber*we.WeightValue)/  :providetotal * 100 AS VALUE,
      sum(nvl(c.InstrumentsNumber,1)/g.FNumber) AS QUANTITY
      from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
						  inner join AC_WorkGroup g   on fp.opid = g.FID
						  inner join AC_UserWorkGroup gu on g.FID=gu.FGroupID
						  inner join AC_User u on gu.FUserID=u.ID
						  inner join Weight we on fp.FlowOrgID=we.FlowOrgID
      where fp.ProvideDate between  :begindate and  :enddate  and fp.FlowOrgID=  :floworgid and u.ID =  :userid  and we.WeightTypeID=4
      group by u.ID,u.Name
      ]]>
    </Content>


    <Content Key="Report_SHCHUserWorkReport" Desc="" DataBaseType="SqlServer">
      <![CDATA[ 
      SELECT a.id,b.name NAME,SUM(ISNULL(recyclenum,0)) RECYCLENUM, SUM(ISNULL(disinfectnum,0)) DISINFECTNUM,SUM(ISNULL(packagenum,0)) PACKAGENUM,
 SUM(ISNULL(sterilizenum,0)) STERILIZENUM,SUM(ISNULL(providenum,0)) PROVIDENUM,SUM(ISNULL(fetch0num,0)) FETCH0NUM,SUM(ISNULL(fetch1num,0)) FETCH1NUM ,SUM(ISNULL(fetch2num,0)) FETCH2NUM
 ,SUM(ISNULL(containerpackagenum,0)) as CONTAINERPACKAGENUM,SUM(ISNULL(fetchnum,0)) as FETCHNUM
 from  worksummary a
 left join AC_User b on a.id=b.ID and b.IsDisabled=0
 where summarydate  between @bd and @ed
 group by a.id,b.Name 
      ]]>
    </Content>
    <Content Key="Report_UserWorkReportA" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      select 'A.回收包'  WORKTYPE,au.Name  USERNAME,t.CargoTypeName  INFONAME,
      --d.QUANTITY ,
      d.QUANTITY/u.FNumber QUANTITY,
      w.WarehouseName  INFO1,d.Barcode  INFO2, we.WeightValue  ,d.QUANTITY*t.InstrumentsNumber INSTRUMENTSNUMBER
      from FlowRecycle  a   inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      inner join CargoType  t   on d.CargoTypeid = t.CargoTypeid
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID 
      where a.RecycleDate between  @begindate  and  @enddate and a.FlowOrgID=@floworgid  and we.WeightTypeID=0

      union all
      select 'B.自动清洗次数'  WORKTYPE,au.Name  USERNAME,dv.DEVICENAME  INFONAME,
      --1  QUANTITY, 
      1/u.FNumber QUANTITY,
      cast(du.todayusetimes as nvarchar)  INFO1,cast(du.isok as nvarchar)  INFO2, we.WeightValue ,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du  on d.LogID = du.LogID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Devices dv   on du.DeviceID = dv.DeviceID
      where d.washtype <> 0 and du.BeginDate between @begindate and @enddate  and d.FlowOrgID=@floworgid and we.WeightTypeID=1

      union all
      select 'C.人工清洗网篮'  WORKTYPE,au.Name  USERNAME,c.ContainerName  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      cast(du.todayusetimes as nvarchar) INFO1,cast(dl.status as nvarchar)  INFO2, we.WeightValue ,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where d.washtype = 0 and du.BeginDate between @begindate and @enddate  and d.FlowOrgID=@floworgid and we.WeightTypeID=1
      
      union all
      select 'D.审核网篮'  WORKTYPE,au.Name  USERNAME,c.ContainerName  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      cast(du.todayusetimes as nvarchar)   INFO1,cast(dl.status as nvarchar) INFO2, 0  WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d   inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on dl.checkid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where dl.CheckDate between @begindate and @enddate  and d.FlowOrgID=@floworgid 
      
      union all
      select 'E.配包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2, we.WeightValue ,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d on a.FPackageID = d.FPackageID
      inner join AC_WorkGroup u   on d.OPID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between @begindate and @enddate  and istemp = @istempkind  and a.FlowOrgID=@floworgid and we.WeightTypeID=2
       
      union all
      select 'F.包包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2, we.WeightValue ,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d on a.FPackageID = d.FPackageID
      inner join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between @begindate and @enddate  and istemp = @istempkind  and a.FlowOrgID=@floworgid and we.WeightTypeID=2
      union all
      select 'G.灭菌'  WORKTYPE,au.Name  USERNAME,e.DeviceName  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      cast(c.TodayUseTimes as nvarchar)  INFO1,''  INFO2, we.WeightValue ,1*1 INSTRUMENTSNUMBER
      from  FlowSterilizationList a   inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on b.FlowOrgID=we.FlowOrgID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      where c.BeginDate between @begindate and @enddate  and b.FlowOrgID=@floworgid and we.WeightTypeID=3
      
      union all
      select 'H.发放'  WORKTYPE,au.Name  USERNAME,e.CARGOTYPENAME  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      g.NAME  INFO1,''  INFO2, we.WeightValue ,1*1 INSTRUMENTSNUMBER
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where a.ProvideDate between @begindate and @enddate  and a.FlowOrgID=@floworgid and we.WeightTypeID=4
      
      ]]>
    </Content>
    <Content Key="Report_UserWorkReportA" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select 'A.回收包'  WorkType,au.Name  UserName,t.CargoTypeName  InfoName,
      --d.Quantity , 
      d.QUANTITY/u.FNumber QUANTITY,
      to_char(w.WarehouseName)  Info1,to_char(d.Barcode)  Info2, we.WeightValue,d.QUANTITY*t.InstrumentsNumber INSTRUMENTSNUMBER
      from FlowRecycle  a   inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      inner join CargoType  t   on d.CargoTypeid = t.CargoTypeid
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID
      where a.RecycleDate between  :begindate  and  :enddate  and a.FlowOrgID=:floworgid and we.WeightTypeID=0

      union all
      select 'B.自动清洗次数'  WorkType,au.Name  UserName,dv.DeviceName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(du.todayusetimes) Info1,to_char(du.isok)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du  on d.LogID = du.LogID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Devices dv   on du.DeviceID = dv.DeviceID
      where d.washtype <> 0 and du.BeginDate between :begindate and :enddate  and d.FlowOrgID=:floworgid and we.WeightTypeID=1
      
      union all
      select 'C.人工清洗网篮'  WorkType,au.Name  UserName,c.ContainerName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(du.todayusetimes)  Info1,to_char(dl.status)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where d.washtype = 0 and du.BeginDate between :begindate and :enddate  and d.FlowOrgID=:floworgid and we.WeightTypeID=1
      
      union all
      select 'D.审核网篮'  WorkType,au.Name  UserName,c.ContainerName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(du.todayusetimes)  Info1,to_char(dl.status)  Info2, 0 WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d   inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on dl.checkid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where dl.CheckDate between :begindate and :enddate  and d.FlowOrgID=:floworgid
      
      union all
      select 'E.配包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(b.barcode)  Info1,to_char(expdate)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d  on a.FPackageID =d.FPackageID
      inner join AC_WorkGroup u   on d.OPID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between :begindate and :enddate  and istemp = :istempkind  and a.FlowOrgID=:floworgid and we.WeightTypeID=2
      
      union all
      select 'F.包包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(b.barcode)  Info1,to_char(expdate)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d  on a.FPackageID =d.FPackageID
      inner join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between :begindate and :enddate  and istemp = :istempkind  and a.FlowOrgID=:floworgid and we.WeightTypeID=2
      union all
      select 'G.灭菌'  WorkType,au.Name  UserName,e.DeviceName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(c.TodayUseTimes)  Info1,''  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from  FlowSterilizationList a   inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on b.FlowOrgID=we.FlowOrgID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      where c.BeginDate between :begindate and :enddate  and b.FlowOrgID=:floworgid and we.WeightTypeID=3
      
      union all
      select 'H.发放'  WorkType,au.Name  UserName,e.CargoTypeName  InfoName,
      --1  Quantity,
       1/u.FNumber QUANTITY,
      to_char(g.Name)  Info1,''  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where a.ProvideDate between :begindate and :enddate  and a.FlowOrgID=:floworgid and we.WeightTypeID=4
      
      ]]>
    </Content>

    <Content Key="Report_UserWorkReportB" Desc="" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      select 'A.回收包'  WORKTYPE,au.Name  USERNAME,t.CargoTypeName  INFONAME,
      --d.QUANTITY ,
       d.QUANTITY/u.FNumber QUANTITY,
      w.WarehouseName  INFO1,d.Barcode  INFO2, we.WeightValue ,d.QUANTITY*t.InstrumentsNumber INSTRUMENTSNUMBER
      from FlowRecycle  a   inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      inner join CargoType  t   on d.CargoTypeid = t.CargoTypeid
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID
      where a.RecycleDate between  @begindate  and  @enddate
      and u.FID=@userid  and a.FlowOrgID=@floworgid and we.WeightTypeID=0

      union all
      select 'B.自动清洗次数'  WORKTYPE,au.Name  USERNAME,dv.DEVICENAME  INFONAME,
      --1  QUANTITY,
       1/u.FNumber QUANTITY,
      cast(du.todayusetimes as nvarchar)  INFO1,cast(du.isok as nvarchar)  INFO2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du  on d.LogID = du.LogID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Devices dv   on du.DeviceID = dv.DeviceID
      where d.washtype <> 0 and du.BeginDate between @begindate and @enddate
      and u.FID=@userid  and d.FlowOrgID=@floworgid and we.WeightTypeID=1

      union all
      select 'C.人工清洗网篮'  WORKTYPE,au.Name  USERNAME,c.ContainerName  INFONAME,
      --1  QUANTITY, 
      1/u.FNumber QUANTITY,
      cast(du.todayusetimes as nvarchar) INFO1,cast(dl.status as nvarchar)  INFO2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where d.washtype = 0 and du.BeginDate between @begindate and @enddate
      and u.FID=@userid  and d.FlowOrgID=@floworgid and we.WeightTypeID=1
      
      union all
      select 'D.审核网篮'  WORKTYPE,au.Name  USERNAME,c.ContainerName  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      cast(du.todayusetimes as nvarchar)   INFO1,cast(dl.status as nvarchar) INFO2, 0 WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d   inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on dl.checkid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where dl.CheckDate between @begindate and @enddate
      and u.FID=@userid  and d.FlowOrgID=@floworgid
      
      union all
      select 'E.配包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d on a.FPackageID = d.FPackageID
      inner join AC_WorkGroup u   on d.OPID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between @begindate and @enddate  and istemp = @istempkind
      and u.FID=@userid  and a.FlowOrgID=@floworgid and we.WeightTypeID=2
       
      union all
      select 'F.包包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d on a.FPackageID = d.FPackageID
      inner join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between @begindate and @enddate  and istemp = @istempkind
      and u.FID=@userid  and a.FlowOrgID=@floworgid and we.WeightTypeID=2
      
      union all
      select 'G.灭菌'  WORKTYPE,au.Name  USERNAME,e.DeviceName  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      cast(c.TodayUseTimes as nvarchar)  INFO1,''  INFO2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from  FlowSterilizationList a   inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on b.FlowOrgID=we.FlowOrgID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      where c.BeginDate between @begindate and @enddate
      and u.FID=@userid  and b.FlowOrgID=@floworgid and we.WeightTypeID=3
      
      union all
      select 'H.发放'  WORKTYPE,au.Name  USERNAME,e.CARGOTYPENAME  INFONAME,
      --1  QUANTITY,
      1/u.FNumber QUANTITY,
      g.NAME  INFO1,''  INFO2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where a.ProvideDate between @begindate and @enddate
      and u.FID=@userid  and a.FlowOrgID=@floworgid and we.WeightTypeID=4
      
      ]]>
    </Content>
    <Content Key="Report_UserWorkReportB" Desc="" DataBaseType="Oracle">
      <![CDATA[
      select 'A.回收包'  WorkType,au.Name  UserName,t.CargoTypeName  InfoName,
      --d.Quantity , 
      d.QUANTITY/u.FNumber QUANTITY,
      to_char(w.WarehouseName)  Info1,to_char(d.Barcode)  Info2, we.WeightValue,d.QUANTITY*t.InstrumentsNumber INSTRUMENTSNUMBER
      from FlowRecycle  a   inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      inner join CargoType  t   on d.CargoTypeid = t.CargoTypeid
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID
      where a.RecycleDate between  :begindate  and  :enddate
      and u.FID = :userid  and a.FlowOrgID=:floworgid and we.WeightTypeID=0

      union all
      select 'B.自动清洗次数'  WorkType,au.Name  UserName,dv.DeviceName  InfoName,
      --1  Quantity, 
      1/u.FNumber QUANTITY,
      to_char(du.todayusetimes) Info1,to_char(du.isok)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du  on d.LogID = du.LogID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Devices dv   on du.DeviceID = dv.DeviceID
      where d.washtype <> 0 and du.BeginDate between :begindate and :enddate
      and u.FID=:userid and d.FlowOrgID=:floworgid and we.WeightTypeID=1
      
      union all
      select 'C.人工清洗网篮'  WorkType,au.Name  UserName,c.ContainerName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      to_char(du.todayusetimes)  Info1,to_char(dl.status)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on du.UserID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on d.FlowOrgID=we.FlowOrgID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where d.washtype = 0 and du.BeginDate between :begindate and :enddate
      and u.FID=:userid and d.FlowOrgID=:floworgid and we.WeightTypeID=1
      
      union all
      select 'D.审核网篮'  WorkType,au.Name  UserName,c.ContainerName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      to_char(du.todayusetimes)  Info1,to_char(dl.status)  Info2,0 WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect d   inner join DevicesUseLog du   on d.LogID = du.LogID
      inner join FlowDisinfectContainerList dl   on d.FDisinfectID = dl.FDisinfectID
      inner join AC_WorkGroup u   on dl.checkid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Container c   on dl.ContainerID = c.ContainerID
      where dl.CheckDate between :begindate and :enddate
      and u.FID=:userid and d.FlowOrgID=:floworgid
      
      union all
      select 'E.配包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      to_char(b.barcode)  Info1,to_char(expdate)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d  on a.FPackageID =d.FPackageID
      inner join AC_WorkGroup u   on d.OPID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between :begindate and :enddate  and istemp = :istempkind
      and u.FID=:userid and a.FlowOrgID=:floworgid and we.WeightTypeID=2
     
      union all
      select 'F.包包'  WorkType,au.Name  UserName,c.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      to_char(b.barcode)  Info1,to_char(expdate)  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      inner join FlowPackage d  on a.FPackageID =d.FPackageID
      inner join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where d.PackageDate between :begindate and :enddate  and istemp = :istempkind
      and u.FID=:userid and a.FlowOrgID=:floworgid and we.WeightTypeID=2
      
      union all
      select 'G.灭菌'  WorkType,au.Name  UserName,e.DeviceName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      to_char(c.TodayUseTimes)  Info1,''  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from  FlowSterilizationList a   inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on b.FlowOrgID=we.FlowOrgID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      where c.BeginDate between :begindate and :enddate
      and u.FID=:userid and b.FlowOrgID=:floworgid and we.WeightTypeID=3
      
      union all
      select 'H.发放'  WorkType,au.Name  UserName,e.CargoTypeName  InfoName,
      --1  Quantity,
      1/u.FNumber QUANTITY,
      to_char(g.Name)  Info1,''  Info2, we.WeightValue,1*1 INSTRUMENTSNUMBER
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join Weight we on a.FlowOrgID=we.FlowOrgID
      where a.ProvideDate between :begindate and :enddate
      and u.FID=:userid and a.FlowOrgID=:floworgid and we.WeightTypeID=4
      
      ]]>
    </Content>

    <Content Key="ReceiveDetailInfo" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      dbo.fun_get_Date(FlowProvide.ProvideDate,'Daily') AS [Date],
      AC_Org.Name AS Area,
      CargoTopType.TypeName AS CargoTopTypeText,
      CargoTypeKind.KindName AS CargoTypeKindText,
      CargoType.CargoTypeName AS CargoTypeText,
      StorageList.Barcode AS BarCode,
      ISNULL(CargoType.Amount,0.00) AS UnitPrice,
      ISNULL(CargoType.Amount,0.00) * 1 AS TotalPrice,
      ISNULL(FlowProvideList.Status,0.00) AS ConfirmQty,
      1 AS Qty,
      PackageType.PName AS OutPacking
      ,Case when FlowProvideList.ProvideConfirmID = '00000000-0000-0000-0000-000000000000' THEN '未接收' ELSE '已接收' END as ConfirmText
      ,Case when FlowProvideList.ProvideConfirmID = '00000000-0000-0000-0000-000000000000' THEN 0 ELSE 1 END as ConfirmStatus
      FROM FlowProvide
      INNER JOIN FlowProvideList  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      INNER JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID
      LEFT JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN AC_ORG  on FlowProvide.OrgID = AC_Org.ID
      LEFT JOIN CargoType  on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind ON CargoType.CargoTypeKind = CargoTypeKind.ID
      LEFT JOIN SystemTypeParameter AS CargoTopType ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      LEFT JOIN FlowSterilizationList  on FlowSterilizationList.PackageID = FlowPackageList.PackageID
      LEFT JOIN DevicesUseLog  on FlowSterilizationList.SterilizationLogID = DevicesUseLog.LogID
      LEFT JOIN Devices  on DevicesUseLog.DeviceID = Devices.DeviceID
      INNER JOIN StorageList  on FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN AC_User  on FlowProvide.OPID = AC_User.ID
      Where 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      Order By FlowProvide.ProvideDate DESC,AC_Org.Name,CargoTypeText
    </Content>
    <Content Key="ReceiveDetailInfo" DataBaseType="Oracle">
      SELECT
      fun_get_Date(FlowProvide.ProvideDate,'Daily') AS ProvideDate,
      AC_Org.Name AS Area,
      CargoTopType.TypeName AS CargoTopTypeText,
      CargoTypeKind.KindName AS CargoTypeKindText,
      CargoType.CargoTypeName AS CargoTypeText,
      StorageList.Barcode AS BarCode,
      nvl(CargoType.Amount,0.00) AS UnitPrice,
      nvl(CargoType.Amount,0.00) * 1 AS TotalPrice,
      nvl(FlowProvideList.Status,0.00) AS ConfirmQty,
      1 AS Qty,
      PackageType.PName AS OutPacking
      from FlowProvide
      INNER JOIN FlowProvideList  on FlowProvide.ProvideID = FlowProvideList.ProvideID
      INNER JOIN FlowPackageList  on FlowProvideList.PackageID = FlowPackageList.PackageID
      LEFT JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      LEFT JOIN AC_ORG  on FlowProvide.OrgID = AC_Org.ID
      LEFT JOIN CargoType  on FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN CargoTypeKind ON CargoType.CargoTypeKind = CargoTypeKind.ID
      LEFT JOIN SystemTypeParameter  CargoTopType ON CargoTopType.TypeKey = 'CargoTopType' AND CargoType.CargoTopType = CargoTopType.TypeValue
      LEFT JOIN FlowSterilizationList  on FlowSterilizationList.PackageID = FlowPackageList.PackageID
      LEFT JOIN DevicesUseLog  on FlowSterilizationList.SterilizationLogID = DevicesUseLog.LogID
      LEFT JOIN Devices  on DevicesUseLog.DeviceID = Devices.DeviceID
      INNER JOIN StorageList  on FlowPackageList.StorageID = StorageList.StorageID
      INNER JOIN AC_WorkGroup  on FlowProvide.OPID = AC_WorkGroup.FID
      Where 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      Order By FlowProvide.ProvideDate DESC,AC_Org.Name,CargoTypeText
    </Content>

    <Content Key="StockDetailInfo" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      CARGOTOPTYPENAME AS CargoTopTypeText --种类
      , KindName AS CargoTypeKindText        --类别
      , CARGOTYPENAME AS CargoTypeText--无菌物品
      , PackageTypeName AS OutPacking --外包装
      , PTypeID
      , OrgID
      , OrgText --区域
      , OrgBarCode
      , STORAGEID
      , INID
      , INLISTID
      , CARGOTOPTYPE
      , CARGOTYPEID
      , LOCATIONID
      , QUANTITY
      , MODIFIER
      , MODIFYTIME
      , STATUS
      , BARCODE --条码
      , MANUFACTURERID
      , MAEDATE
      , EXPDATE --失效日期
      , LOTNUMBER
      , PRICE
      , AFTERMAINTAINUSETIMES
      , STERILIZEDATE
      , WAREHOUSEID
      , USETIMES
      , LASTMAINTAINDATE
      , WAREHOUSENAME
      , LOCATIONNAME
      , WarehouseName
      , STATUSNAME
      FROM View_StorageList
      Where Quantity>0  AND CargoTopType=16 AND Status IN (60,50)
      {0}
      Order by EXPDate
    </Content>
    <Content Key="StockDetailInfo" DataBaseType="Oracle">
      SELECT
      CARGOTOPTYPENAME AS CargoTopTypeText --种类
      , KindName AS CargoTypeKindText        --类别
      , CARGOTYPENAME AS CargoTypeText--无菌物品
      , PackageTypeName AS OutPacking --外包装
      , PTypeID
      , OrgID
      , OrgText --区域
      , OrgBarCode
      , STORAGEID
      , INID
      , INLISTID
      , CARGOTOPTYPE
      , CARGOTYPEID
      , LOCATIONID
      , QUANTITY
      , MODIFIER
      , MODIFYTIME
      , STATUS
      , BARCODE --条码
      , MANUFACTURERID
      , MAEDATE
      , EXPDATE --失效日期
      , LOTNUMBER
      , PRICE
      , AFTERMAINTAINUSETIMES
      , STERILIZEDATE
      , WAREHOUSEID
      , USETIMES
      , LASTMAINTAINDATE
      , WAREHOUSENAME
      , LOCATIONNAME
      , WarehouseName
      , STATUSNAME
      FROM View_StorageList
      Where Quantity>0  AND CargoTopType=16 AND Status IN (60,50)
      {0}
      Order by EXPDate
    </Content>

    <Content Key="PackageStockSummary" DataBaseType="SqlServer">
      <![CDATA[
      SELECT  
      AC_Org.Name AS AreaText
      , WAREHOUSE.WarehouseName AS WarehouseText
      , view_CargoType.CargoTopTypeText --种类
      , view_CargoType.CargoTypeKindText        --类别
      , view_CargoType.CargoTypeText--无菌物品
      , view_CargoType.CargoTypeID
      , view_CargoType.CargoTopType
      , view_CargoType.CargoTypeKind
      , SUM(QUANTITY) AS Qty -- 数量
      , StorageList.STATUS
      , ST.TypeName AS STATUSNAME
      FROM StorageList
      LEFT JOIN view_CargoType
      ON StorageList.CargoTypeID = view_CargoType.CargoTypeID
      INNER JOIN FlowPackageList
      ON StorageList.StorageID = FlowPackageList.StorageID
      INNER JOIN FlowProvideList
      ON FlowProvideList.PackageID = FlowPackageList.PackageID
      INNER JOIN FlowProvide
      ON FlowProvideList.ProvideID = FlowProvide.ProvideID
      INNER JOIN AC_Org
      ON FlowProvide.OrgID = AC_Org.ID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      INNER JOIN SystemTypeParameter  ST WITH (NOLOCK)  ON StorageList.Status = ST.TypeValue AND ST.TypeKey = 'StorageStatus'   
      WHERE Quantity>0 
      AND (StorageList.CargoTopType = 16 AND StorageList.STATUS IN (50,60))-- 灭菌包 & 已发放
      {0}
      GROUP BY AC_Org.Name,WarehouseName
      , view_CargoType.CargoTopTypeText --种类
      , view_CargoType.CargoTypeKindText        --类别
      , view_CargoType.CargoTypeText--无菌物品
      , view_CargoType.CargoTypeID
      , view_CargoType.CargoTopType
      , view_CargoType.CargoTypeKind
      , StorageList.STATUS
      , ST.TypeName 
      Order BY AreaText
      , view_CargoType.CargoTopTypeText --种类
      , view_CargoType.CargoTypeKindText        --类别
      , view_CargoType.CargoTypeText
      ]]>
    </Content>
    <Content Key="PackageStockSummary" DataBaseType="Oracle">
      <![CDATA[
      SELECT  
      AC_Org.Name AS AreaText
      , WAREHOUSE.WarehouseName AS WarehouseText
      , view_CargoType.CargoTopTypeText --种类
      , view_CargoType.CargoTypeKindText        --类别
      , view_CargoType.CargoTypeText--无菌物品
      , view_CargoType.CargoTypeID
      , view_CargoType.CargoTopType
      , view_CargoType.CargoTypeKind
      , SUM(QUANTITY) AS Qty -- 数量
      , StorageList.STATUS
      , ST.TypeName AS STATUSNAME
      FROM StorageList
      LEFT JOIN view_CargoType
      ON StorageList.CargoTypeID = view_CargoType.CargoTypeID
      INNER JOIN FlowPackageList
      ON StorageList.StorageID = FlowPackageList.StorageID
      INNER JOIN FlowProvideList
      ON FlowProvideList.PackageID = FlowPackageList.PackageID
      INNER JOIN FlowProvide
      ON FlowProvideList.ProvideID = FlowProvide.ProvideID
      INNER JOIN AC_Org
      ON FlowProvide.OrgID = AC_Org.ID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      INNER JOIN SystemTypeParameter  ST WITH (NOLOCK)  ON StorageList.Status = ST.TypeValue AND ST.TypeKey = 'StorageStatus'   
      WHERE Quantity>0 
      AND (StorageList.CargoTopType = 16 AND StorageList.STATUS IN (50,60))-- 灭菌包 & 已发放
     {0}
      GROUP BY AC_Org.Name,WarehouseName
      , view_CargoType.CargoTopTypeText --种类
      , view_CargoType.CargoTypeKindText        --类别
      , view_CargoType.CargoTypeText--无菌物品
      , view_CargoType.CargoTypeID
      , view_CargoType.CargoTopType
      , view_CargoType.CargoTypeKind
      , StorageList.STATUS
      , ST.TypeName 
      Order BY AreaText
      , view_CargoType.CargoTopTypeText --种类
      , view_CargoType.CargoTypeKindText        --类别
      , view_CargoType.CargoTypeText
      ]]>
    </Content>

    <Content Key="PersonnelDetailDaily" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Daily'
      SELECT
      WorkDetail.[Date] AS [Date]
      ,AC_Org.ID
      ,AC_Org.Name AS OrgText
      ,WorkDetail.OPID
      ,Employee.FNames AS UserText
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.[CargoTypeID]
      ,SUM([RecycleQty]) AS [RecycleQty]
      ,SUM([PackageQty]) AS [PackageQty]
      ,SUM([SterilizationQty]) AS [SterilizationQty]
      ,SUM([ProvideQty]) AS [ProvideQty]
      ,SUM([UseQty]) AS [UseQty]
      FROM [view_WorkDetail] AS WorkDetail
      LEFT JOIN view_CargoType AS CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN AC_WorkGroup AS Employee
      ON WorkDetail.OPID = Employee.FID
      LEFT JOIN AC_OrgUser
      ON WorkDetail.OPID = AC_OrgUser.UserID
      LEFT JOIN AC_Org
      ON AC_OrgUser.OrgID = AC_Org.ID
      WHERE 1 = 1 {0}
      GROUP BY WorkDetail.[Date],WorkDetail.OPID,Employee.FNames,AC_Org.ID,AC_Org.Name,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.[CargoTypeID]
      ORDER BY [Date] DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>
    <Content Key="PersonnelDetailDaily" DataBaseType="Oracle">
      SELECT
      WorkDetail.OpDate AS OpDate
      ,AC_Org.ID
      ,AC_Org.Name AS OrgText
      ,WorkDetail.OPID
      ,Employee.FNames AS UserText
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.CargoTypeID
      ,SUM(RecycleQty) AS RecycleQty
      ,SUM(PackageQty) AS PackageQty
      ,SUM(SterilizationQty) AS SterilizationQty
      ,SUM(ProvideQty) AS ProvideQty
      ,SUM(UseQty) AS UseQty
      FROM view_WorkDetail  WorkDetail
      LEFT JOIN view_CargoType  CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN AC_WorkGroup AS Employee
      ON WorkDetail.OPID = Employee.FID
      LEFT JOIN AC_OrgUser
      ON WorkDetail.OPID = AC_OrgUser.UserID
      LEFT JOIN AC_Org
      ON AC_OrgUser.OrgID = AC_Org.ID
      WHERE 1 = 1 {0}
      GROUP BY WorkDetail.OpDate,WorkDetail.OPID,Employee.FNames,AC_Org.ID,AC_Org.Name,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.CargoTypeID
      ORDER BY OpDate DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>

    <Content Key="ReportStorageValidity" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      SELECT
      CASE ISNULL(H.Name,'') WHEN '' THEN C.WAREHOUSENAME ELSE H.Name END AS AreaText,
      C.WAREHOUSENAME,
      D.LOCATIONNAME,
      A.CargoTypeID,
      A.Barcode,
      B.CARGOTYPENAME,
      G.ProvideDate,
      convert(varchar(10), A.EXPDATE ,120) AS EXPDATE,
      Datediff(DAY,GETDATE(),A.EXPDate) AS VALIDDATEDAYS,
      B.WarningDays,
      A.QUANTITY
      FROM STORAGELIST A
      LEFT JOIN CARGOTYPE B  ON A.CARGOTYPEID = B.CARGOTYPEID
      LEFT JOIN Warehouse  C on A.WarehouseID = C.WarehouseID
      LEFT JOIN Location D on D.LocationID = A.LocationID
      INNER JOIN FlowPackageList E ON E.StorageID = A.StorageID
      LEFT JOIN FlowProvideList F ON E.PackageID = F.PackageID
      LEFT JOIN FlowProvide G ON F.ProvideID = G.ProvideID
      LEFT JOIN AC_Org H ON H.ID = G.OrgID
      WHERE 1=1 AND A.CargoTopType = 16 AND A.[Status] IN (50,60) -- 灭菌包,已发放
      {0}
      ORDER BY AreaText,C.WAREHOUSENAME
    </Content>
    <Content Key="ReportStorageValidity" DataBaseType="Oracle">
      SELECT
      CASE nvl(H.Name,'') WHEN '' THEN C.WAREHOUSENAME ELSE H.Name END AS AreaText,
      C.WAREHOUSENAME,
      D.LOCATIONNAME,
      A.CargoTypeID,
      A.Barcode,
      B.CARGOTYPENAME,
      G.ProvideDate,
      to_char( A.EXPDATE,'yyyy-mm-dd') AS EXPDATE,
      datediff('D',A.EXPDate,sysdate) AS VALIDDATEDAYS,
      B.WarningDays,
      A.QUANTITY
      FROM STORAGELIST A
      LEFT JOIN CARGOTYPE B  ON A.CARGOTYPEID = B.CARGOTYPEID
      LEFT JOIN Warehouse  C on A.WarehouseID = C.WarehouseID
      LEFT JOIN Location D on D.LocationID = A.LocationID
      INNER JOIN FlowPackageList E ON E.StorageID = A.StorageID
      LEFT JOIN FlowProvideList F ON E.PackageID = F.PackageID
      LEFT JOIN FlowProvide G ON F.ProvideID = G.ProvideID
      LEFT JOIN AC_Org H ON H.ID = G.OrgID
      WHERE 1=1 AND A.CargoTopType = 16 AND A.Status IN (50,60) -- 灭菌包,已发放
      {0}
      ORDER BY AreaText,C.WAREHOUSENAME
    </Content>

    <Content Key="StorageSafe" DataBaseType="SqlServer">
      <![CDATA[
      SELECT C.WAREHOUSENAME, A.CARGOTYPENAME, A.SAFEQUANTITY,SUM(B.QUANTITY) AS Qty
      FROM CARGOTYPE A WITH (NOLOCK) INNER JOIN
      STORAGELIST B WITH (NOLOCK) ON A.CARGOTYPEID = B.CARGOTYPEID
      LEFT JOIN Warehouse  C on B.WarehouseID = C.WarehouseID
      WHERE 1=1 and A.SAFEQUANTITY <> 0 AND C.WarehouseID IS NOT NULL AND C.WarehouseID = '565869D8-9642-4ECD-A9BF-1F27A4EB4B7E'
      GROUP BY A.CARGOTYPENAME,C.WAREHOUSENAME,A.SAFEQUANTITY
      ]]>
    </Content>
    <Content Key="StorageSafe" DataBaseType="Oracle">
      <![CDATA[
      SELECT C.WAREHOUSENAME, A.CARGOTYPENAME, A.SAFEQUANTITY,SUM(B.QUANTITY) AS Qty
      FROM CARGOTYPE A  INNER JOIN
      STORAGELIST B WITH  ON A.CARGOTYPEID = B.CARGOTYPEID
      LEFT JOIN Warehouse  C on B.WarehouseID = C.WarehouseID
      WHERE 1=1 and A.SAFEQUANTITY <> 0 AND C.WarehouseID IS NOT NULL AND C.WarehouseID = '565869D8-9642-4ECD-A9BF-1F27A4EB4B7E'
      GROUP BY A.CARGOTYPENAME,C.WAREHOUSENAME,A.SAFEQUANTITY
      ]]>
    </Content>

    <Content Key="ContainerStatusReport" DataBaseType="SqlServer">
      select distinct
      c.BARCODE,--网篮编号
      c.ContainerName as CONTAINERNAME,--网篮名称
      s.TypeName as TYPENAME -- 网篮状态
      from  FlowRecycleContainer rc with (nolock) inner join Container c with (nolock) on c.Containerid = rc.Containerid
      inner join SystemTypeParameter s with (nolock) on c.Status = s.TypeValue and s.TypeKey = 'ContainerStatus'
      inner join FlowRecycle r with (nolock) on rc.FRecycleID = r.FRecycleID
      where 1 = 1{0}
    </Content>
    <Content Key="ContainerStatusReport" DataBaseType="Oracle">
      select distinct
      c.BARCODE,--网篮编号
      c.ContainerName as CONTAINERNAME,--网篮名称
      s.TypeName as TYPENAME -- 网篮状态
      from  FlowRecycleContainer rc inner join Container c on c.Containerid = rc.Containerid
      inner join SystemTypeParameter s on c.Status = s.TypeValue and s.TypeKey = 'ContainerStatus'
      inner join FlowRecycle r on rc.FRecycleID = r.FRecycleID
      where 1=1 {0}
    </Content>

    <Content Key="PackNoSterilize" DataBaseType="SqlServer">
      select
      sl.Barcode as BARCODE,--包条码
      ck.KindName AS KINDNAME,--类别
      c.CargoTypeName AS CARGOTYPENAME,--包类型
      sl.MAEDate AS MAEDATE,--配包日期
      pt.PName AS PNAME,--外包装
      pu.FNames as OPNAME,--配包人
      cu.FNames as CHECKERNAME, --审核人
      fl.ValidDate --准用日期，不需要显示
      from FlowPackageList fl with (nolock)
      inner join FlowPackage f with (nolock) on fl.FPackageID = f.FPackageID
      inner join StorageList sl with (nolock) on fl.StorageID = sl.StorageID
      inner join CargoType c with (nolock) on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck with (nolock) on c.CargoTypeKind = ck.ID
      inner join PackageType pt with (nolock) on fl.PackageTypeID = pt.PTypeID
      inner join AC_WorkGroup pu with (nolock) on f.OPID = pu.FID
      left join AC_WorkGroup cu with (nolock) on fl.CheckID = cu.FID
      --left join AC_OrgUser ou on pu.FID=ou.UserID
      where sl.Status = 40  and IsTemp = 0 {0}
      ORDER BY sl.MAEDate DESC
    </Content>
    <Content Key="PackNoSterilize" DataBaseType="Oracle">
      select
      sl.Barcode as BARCODE,--包条码
      ck.KindName AS KINDNAME,--类别
      c.CargoTypeName AS CARGOTYPENAME,--包类型
      sl.MAEDate AS MAEDATE,--配包日期
      pt.PName AS PNAME,--外包装
      pu.FNames as OPNAME,--配包人
      cu.FNames as CHECKERNAME, --审核人
      fl.ValidDate --准用日期，不需要显示
      from FlowPackageList fl
      inner join FlowPackage f  on fl.FPackageID = f.FPackageID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      inner join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck  on c.CargoTypeKind = ck.ID
      inner join PackageType pt  on fl.PackageTypeID = pt.PTypeID
      inner join AC_WorkGroup pu  on f.OPID = pu.FID
      left join AC_WorkGroup cu  on fl.CheckID = cu.FID
      --left join AC_OrgUser ou on pu.FID=ou.UserID
      where sl.Status = 40   and IsTemp = 0 {0}
      ORDER BY sl.MAEDate DESC
    </Content>

    <Content Key="Query_PackSterilizeing" DataBaseType="SqlServer">
      select
      sl.Barcode as BARCODE,--包条码
      ck.KindName AS KINDNAME,--类别
      c.CargoTypeName AS CARGOTYPENAME,--包类型
      sl.MAEDate AS MAEDATE,--配包日期
      pt.PName AS PNAME,--外包装
      pu.FNames as OPNAME,--配包人
      cu.FNames as CHECKERNAME, --审核人
      fl.ValidDate --准用日期，不需要显示
      from FlowPackageList fl with (nolock)
      inner join FlowPackage f with (nolock) on fl.FPackageID = f.FPackageID
      inner join StorageList sl with (nolock) on fl.StorageID = sl.StorageID
      inner join CargoType c with (nolock) on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck with (nolock) on c.CargoTypeKind = ck.ID
      inner join PackageType pt with (nolock) on fl.PackageTypeID = pt.PTypeID
      inner join AC_WorkGroup pu with (nolock) on f.OPID = pu.FID
      left join AC_WorkGroup cu with (nolock) on fl.CheckID = cu.FID
      where sl.Status = 40 and fl.BadFlag=-2 {0}
      ORDER BY sl.MAEDate DESC
    </Content>
    <Content Key="Query_PackSterilizeing" DataBaseType="Oracle">
      select
      sl.Barcode as BARCODE,--包条码
      ck.KindName AS KINDNAME,--类别
      c.CargoTypeName AS CARGOTYPENAME,--包类型
      sl.MAEDate AS MAEDATE,--配包日期
      pt.PName AS PNAME,--外包装
      pu.FNames as OPNAME,--配包人
      cu.FNames as CHECKERNAME, --审核人
      fl.ValidDate --准用日期，不需要显示
      from FlowPackageList fl
      inner join FlowPackage f  on fl.FPackageID = f.FPackageID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      inner join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck  on c.CargoTypeKind = ck.ID
      inner join PackageType pt  on fl.PackageTypeID = pt.PTypeID
      inner join AC_WorkGroup pu  on f.OPID = pu.FID
      left join AC_WorkGroup cu  on fl.CheckID = cu.FID
      where sl.Status = 40 and fl.BadFlag=-2 {0}
      ORDER BY sl.MAEDate DESC
    </Content>

    <Content Key="Query_PackageSterilizeingBPCD" DataBaseType="SqlServer">
      select
      sl.Barcode as BARCODE,--包条码
      ck.KindName AS KINDNAME,--类别
      c.CargoTypeName AS CARGOTYPENAME,--包类型
      sl.MAEDate AS MAEDATE,--配包日期
      pt.PName AS PNAME,--外包装
      pu.FNames as OPNAME,--配包人
      cu.FNames as CHECKERNAME, --审核人
      fl.ValidDate --准用日期，不需要显示
      ,sl.Status
      from FlowPackageList fl with (nolock)
      inner join FlowPackage f with (nolock) on fl.FPackageID = f.FPackageID
      inner join StorageList sl with (nolock) on fl.StorageID = sl.StorageID
      inner join CargoType c with (nolock) on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck with (nolock) on c.CargoTypeKind = ck.ID
      inner join PackageType pt with (nolock) on fl.PackageTypeID = pt.PTypeID
      inner join AC_WorkGroup pu with (nolock) on f.OPID = pu.FID
      left join AC_WorkGroup cu with (nolock) on fl.CheckID = cu.FID
      inner join
      (
      select fsl.PackageID,max(dul.TodayUseTimes) as TodayUseTimes,dul.IsBPCDOK from FlowSterilizationList fsl
      inner join DevicesUseLog dul with (nolock) on fsl.SterilizationLogID=dul.LogID
      group by fsl.PackageID,IsBPCDOK
      ) dl on fl.PackageID=dl.PackageID
      where sl.Status in(40,50) and c.IsNeedBCP=1 and dl.IsBPCDOK=0 {0}
      ORDER BY sl.MAEDate DESC
    </Content>
    <Content Key="Query_PackageSterilizeingBPCD" DataBaseType="Oracle">
      select
      sl.Barcode as BARCODE,--包条码
      ck.KindName AS KINDNAME,--类别
      c.CargoTypeName AS CARGOTYPENAME,--包类型
      sl.MAEDate AS MAEDATE,--配包日期
      pt.PName AS PNAME,--外包装
      pu.FNames as OPNAME,--配包人
      cu.FNames as CHECKERNAME, --审核人
      fl.ValidDate --准用日期，不需要显示
      ,sl.Status
      from FlowPackageList fl with (nolock)
      inner join FlowPackage f with (nolock) on fl.FPackageID = f.FPackageID
      inner join StorageList sl with (nolock) on fl.StorageID = sl.StorageID
      inner join CargoType c with (nolock) on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck with (nolock) on c.CargoTypeKind = ck.ID
      inner join PackageType pt with (nolock) on fl.PackageTypeID = pt.PTypeID
      inner join AC_WorkGroup pu with (nolock) on f.OPID = pu.FID
      left join AC_WorkGroup cu with (nolock) on fl.CheckID = cu.FID
      inner join
      (
      select fsl.PackageID,max(dul.TodayUseTimes) as TodayUseTimes,dul.IsBPCDOK from FlowSterilizationList fsl
      inner join DevicesUseLog dul with (nolock) on fsl.SterilizationLogID=dul.LogID
      group by fsl.PackageID,IsBPCDOK
      ) dl on fl.PackageID=dl.PackageID
      where sl.Status in(40,50) and c.IsNeedBCP=1 and dl.IsBPCDOK=0 {0}
      ORDER BY sl.MAEDate DESC
    </Content>

    <Content Key="PackageCodeRecycle" DataBaseType="SqlServer">
      select CONTENT,LOGTIME,FNames NAME,cargotypename as CARGOTYPETEXT from SysLog  left join  CargoType  on syslog.KeyID2=CargoType.cargotypeid
      inner join AC_WorkGroup pu  on syslog.Operator = pu.FID
      where LogType=17 {0} order by logtime desc
    </Content>
    <Content Key="PackageCodeRecycle" DataBaseType="Oracle">
      select CONTENT,LOGTIME,FNames NAME,cargotypename as CARGOTYPETEXT from SysLog  left join CargoType  on syslog.KeyID2=CargoType.cargotypeid
      inner join AC_WorkGroup pu  on syslog.Operator = pu.FID
      where LogType=17 {0} order by logtime desc
    </Content>


    <Content Key="UserReport" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Daily'
      SELECT
      dbo.fun_get_Date(FlowUse.UseDate,@SummaryType) AS [Date], --日期
      CargoTypeInfo.CargoTopTypeText AS CargoTopTypeText, --种类
      CargoTypeInfo.CargoTypeKindText AS CargoTypeKindText,--类别
      CargoTypeInfo.CargoTypeText AS CargoTypeText,--无菌物品
      COUNT(FlowUseList.Quantity) AS Qty --数量
      FROM FlowUse
      INNER JOIN FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      INNER JOIN StorageList  on FlowUseList.StorageID = StorageList.StorageID
      INNER JOIN FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      INNER JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      INNER JOIN AC_ORG AS UseArea  on FlowUse.OrgID = UseArea.ID
      INNER JOIN view_CargoType AS CargoTypeInfo ON FlowPackageList.CargoTypeID = CargoTypeInfo.CargoTypeID
      INNER JOIN AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      WHERE 1 = 1
      GROUP BY
      UseArea.Name,
      dbo.fun_get_Date(FlowUse.UseDate,@SummaryType),
      CargoTypeInfo.CargoTypeText,
      CargoTypeInfo.CargoTypeKindText,
      CargoTypeInfo.CargoTopTypeText
      Order By [Date] DESC,CargoTypeText
    </Content>
    <Content Key="UserReport" DataBaseType="Oracle">
      SELECT
      fun_get_Date(FlowUse.UseDate,'Daily') AS UseDate, --日期
      CargoTypeInfo.CargoTopTypeText AS CargoTopTypeText, --种类
      CargoTypeInfo.CargoTypeKindText AS CargoTypeKindText,--类别
      CargoTypeInfo.CargoTypeText AS CargoTypeText,--无菌物品
      COUNT(FlowUseList.Quantity) AS Qty --数量
      FROM FlowUse
      INNER JOIN FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      INNER JOIN StorageList  on FlowUseList.StorageID = StorageList.StorageID
      INNER JOIN FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      INNER JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      INNER JOIN AC_ORG  UseArea  on FlowUse.OrgID = UseArea.ID
      INNER JOIN view_CargoType  CargoTypeInfo ON FlowPackageList.CargoTypeID = CargoTypeInfo.CargoTypeID
      INNER JOIN AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      WHERE 1 = 1
      GROUP BY
      UseArea.Name,
      fun_get_Date(FlowUse.UseDate,'Daily'),
      CargoTypeInfo.CargoTypeText,
      CargoTypeInfo.CargoTypeKindText,
      CargoTypeInfo.CargoTopTypeText
      Order By UseDate DESC,CargoTypeText
    </Content>

    <Content Key="UseSummaryDaily" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Daily'
      SELECT
      UseArea.Name AS UseArea, --区域
      dbo.fun_get_Date(FlowUse.UseDate,@SummaryType) AS [Date], --日期
      CargoTypeInfo.CargoTopTypeText AS CargoTopTypeText, --种类
      CargoTypeInfo.CargoTypeKindText AS CargoTypeKindText,--类别
      CargoTypeInfo.CargoTypeText AS CargoTypeText,--无菌物品
      COUNT(FlowUseList.Quantity) AS Qty --数量
      FROM FlowUse
      INNER JOIN FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      INNER JOIN StorageList  on FlowUseList.StorageID = StorageList.StorageID
      INNER JOIN FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      INNER JOIN PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      INNER JOIN AC_ORG AS UseArea  on FlowUse.OrgID = UseArea.ID
      left JOIN view_CargoType AS CargoTypeInfo ON FlowPackageList.CargoTypeID = CargoTypeInfo.CargoTypeID
      INNER JOIN AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      WHERE 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      GROUP BY
      UseArea.Name,
      dbo.fun_get_Date(FlowUse.UseDate,@SummaryType),
      CargoTypeInfo.CargoTypeText,
      CargoTypeInfo.CargoTypeKindText,
      CargoTypeInfo.CargoTopTypeText
      Order By [Date] DESC,UseArea,CargoTypeText
    </Content>
    <Content Key="UseSummaryDaily" DataBaseType="Oracle">
      SELECT
      UseArea.Name AS UseArea, --区域
      fun_get_Date(FlowUse.UseDate,'Daily') AS UseDate, --日期
      CargoTypeInfo.CargoTopTypeText AS CargoTopTypeText, --种类
      CargoTypeInfo.CargoTypeKindText AS CargoTypeKindText,--类别
      CargoTypeInfo.CargoTypeText AS CargoTypeText,--无菌物品
      COUNT(FlowUseList.Quantity) AS Qty --数量
      FROM FlowUse
      inner join FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      inner join StorageList  on FlowUseList.StorageID = StorageList.StorageID
      inner join FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      inner join PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      inner join AC_ORG AS UseArea  on FlowUse.OrgID = UseArea.ID
      left join view_CargoType  CargoTypeInfo ON FlowPackageList.CargoTypeID = CargoTypeInfo.CargoTypeID
      inner join AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      WHERE 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      GROUP BY
      UseArea.Name,
      fun_get_Date(FlowUse.UseDate,'Daily'),
      CargoTypeInfo.CargoTypeText,
      CargoTypeInfo.CargoTypeKindText,
      CargoTypeInfo.CargoTopTypeText
      Order By UseDate DESC,UseArea,CargoTypeText
    </Content>

    <Content Key="UseSummaryMonthly" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Monthly'
      SELECT
      UseArea.Name AS UseArea, --区域
      dbo.fun_get_Date(FlowUse.UseDate,@SummaryType) AS [Date], --日期
      CargoTypeInfo.CargoTopTypeText AS CargoTopTypeText, --种类
      CargoTypeInfo.CargoTypeKindText AS CargoTypeKindText,--类别
      CargoTypeInfo.CargoTypeText AS CargoTypeText,--无菌物品
      COUNT(FlowUseList.Quantity) AS Qty --数量
      FROM FlowUse
      inner join FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      inner join StorageList  on FlowUseList.StorageID = StorageList.StorageID
      inner join FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      inner join PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      inner join AC_ORG AS UseArea  on FlowUse.OrgID = UseArea.ID
      left join view_CargoType AS CargoTypeInfo ON FlowPackageList.CargoTypeID = CargoTypeInfo.CargoTypeID
      inner join AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      WHERE 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      GROUP BY
      UseArea.Name,
      dbo.fun_get_Date(FlowUse.UseDate,@SummaryType),
      CargoTypeInfo.CargoTypeText,
      CargoTypeInfo.CargoTypeKindText,
      CargoTypeInfo.CargoTopTypeText
      Order By [Date] DESC,UseArea,CargoTypeText
    </Content>
    <Content Key="UseSummaryMonthly" DataBaseType="Oracle">
      SELECT
      UseArea.Name AS UseArea, --区域
      fun_get_Date(FlowUse.UseDate, 'Monthly') AS BeginDate, --日期
      CargoTypeInfo.CargoTopTypeText AS CargoTopTypeText, --种类
      CargoTypeInfo.CargoTypeKindText AS CargoTypeKindText,--类别
      CargoTypeInfo.CargoTypeText AS CargoTypeText,--无菌物品
      COUNT(FlowUseList.Quantity) AS Qty --数量
      FROM FlowUse
      inner join FlowUseList  on FlowUse.UseID = FlowUseList.UseID
      inner join StorageList  on FlowUseList.StorageID = StorageList.StorageID
      inner join FlowPackageList  on FlowPackageList.StorageID = StorageList.StorageID
      inner join PackageType  on FlowPackageList.packagetypeid = PackageType.PTypeID
      inner join AC_ORG  UseArea  on FlowUse.OrgID = UseArea.ID
      left join view_CargoType  CargoTypeInfo ON FlowPackageList.CargoTypeID = CargoTypeInfo.CargoTypeID
      inner join AC_WorkGroup  on FlowUse.OPID = AC_WorkGroup.FID
      WHERE 1 = 1  {0} -- 可能需要震泽及其下属所有科室
      GROUP BY
      UseArea.Name,
      fun_get_Date(FlowUse.UseDate,'Monthly'),
      CargoTypeInfo.CargoTypeText,
      CargoTypeInfo.CargoTypeKindText,
      CargoTypeInfo.CargoTopTypeText
      Order By BeginDate DESC,UseArea,CargoTypeText
    </Content>

    <Content Key="WorkSummaryDaily" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Daily'
      SELECT
      dbo.fun_get_Date(WorkDetail.[Date],@SummaryType) AS [Date]
      --,CargoType.CargoTopTypeText --种类
      --,CargoType.CargoTypeKindText--类别
      --,CargoType.CargoTypeText--无菌物品、器械包
      --,WorkDetail.[CargoTypeID]
      ,SUM([RecycleQty]) AS [RecycleQty]
      ,SUM([PackageQty]) AS [PackageQty]
      ,SUM([SterilizationQty]) AS [SterilizationQty]
      ,SUM([ProvideQty]) AS [ProvideQty]
      ,SUM([UseQty]) AS [UseQty]
      FROM [view_WorkDetail] AS WorkDetail
      --LEFT JOIN view_CargoType AS CargoType
      --ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY dbo.fun_get_Date(WorkDetail.[Date],@SummaryType)--,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.[CargoTypeID]
      ORDER BY [Date] DESC
    </Content>
    <Content Key="WorkSummaryDaily" DataBaseType="Oracle">
      SELECT
      fun_get_Date(WorkDetail.OpDate,'Daily') AS OpDate
      --,CargoType.CargoTopTypeText --种类
      --,CargoType.CargoTypeKindText--类别
      --,CargoType.CargoTypeText--无菌物品、器械包
      --,WorkDetail.CargoTypeID
      ,SUM(RecycleQty) AS RecycleQty
      ,SUM(PackageQty) AS PackageQty
      ,SUM(SterilizationQty) AS SterilizationQty
      ,SUM(ProvideQty) AS ProvideQty
      ,SUM(UseQty) AS UseQty
      FROM view_WorkDetail  WorkDetail
      --LEFT JOIN view_CargoType  CargoType
      --ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY fun_get_Date(WorkDetail.OpDate,'Daily')--,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.CargoTypeID
      ORDER BY OpDate DESC
    </Content>

    <Content Key="WorkSummaryMonthly" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Monthly'
      SELECT
      dbo.fun_get_Date(WorkDetail.[Date],@SummaryType) AS [Date]
      --,CargoType.CargoTopTypeText --种类
      --,CargoType.CargoTypeKindText--类别
      --,CargoType.CargoTypeText--无菌物品、器械包
      --,WorkDetail.[CargoTypeID]
      ,SUM([RecycleQty]) AS [RecycleQty]
      ,SUM([PackageQty]) AS [PackageQty]
      ,SUM([SterilizationQty]) AS [SterilizationQty]
      ,SUM([ProvideQty]) AS [ProvideQty]
      ,SUM([UseQty]) AS [UseQty]
      FROM [view_WorkDetail] AS WorkDetail
      --LEFT JOIN view_CargoType AS CargoType
      --ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY dbo.fun_get_Date(WorkDetail.[Date],@SummaryType)--,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.[CargoTypeID]
      ORDER BY [Date] DESC
    </Content>
    <Content Key="WorkSummaryMonthly" DataBaseType="Oracle">
      SELECT
      fun_get_Date(WorkDetail.OpDate,'Monthly') AS OpDate
      --,CargoType.CargoTopTypeText --种类
      --,CargoType.CargoTypeKindText--类别
      --,CargoType.CargoTypeText--无菌物品、器械包
      --,WorkDetail.CargoTypeID
      ,SUM(RecycleQty) AS RecycleQty
      ,SUM(PackageQty) AS PackageQty
      ,SUM(SterilizationQty) AS SterilizationQty
      ,SUM(ProvideQty) AS ProvideQty
      ,SUM(UseQty) AS UseQty
      FROM view_WorkDetail  WorkDetail
      --LEFT JOIN view_CargoType  CargoType
      --ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY fun_get_Date(WorkDetail.OpDate,'Monthly')--,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.CargoTypeID
      ORDER BY OpDate DESC
    </Content>

    <Content Key="WorkDetailDaily" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Daily'
      SELECT
      dbo.fun_get_Date(WorkDetail.[Date],@SummaryType) AS [Date]
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.[CargoTypeID]
      ,SUM([RecycleQty]) AS [RecycleQty]
      ,SUM([PackageQty]) AS [PackageQty]
      ,SUM([SterilizationQty]) AS [SterilizationQty]
      ,SUM([ProvideQty]) AS [ProvideQty]
      ,SUM([UseQty]) AS [UseQty]
      FROM [view_WorkDetail] AS WorkDetail
      LEFT JOIN view_CargoType AS CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY dbo.fun_get_Date(WorkDetail.[Date],@SummaryType),CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.[CargoTypeID]
      ORDER BY [Date] DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>
    <Content Key="WorkDetailDaily" DataBaseType="Oracle">
      SELECT
      fun_get_Date(WorkDetail.Date,'Daily') AS OpDate
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.CargoTypeID
      ,SUM(RecycleQty) AS RecycleQty
      ,SUM(PackageQty) AS PackageQty
      ,SUM(SterilizationQty) AS SterilizationQty
      ,SUM(ProvideQty) AS ProvideQty
      ,SUM(UseQty) AS UseQty
      FROM view_WorkDetail  WorkDetail
      LEFT JOIN view_CargoType  CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY fun_get_Date(WorkDetail.OpDate,'Daily'),CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.CargoTypeID
      ORDER BY OpDate DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>

    <Content Key="WorkDetailMonthly" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Monthly'
      SELECT
      dbo.fun_get_Date(WorkDetail.[Date],@SummaryType) AS [Date]
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.[CargoTypeID]
      ,SUM([RecycleQty]) AS [RecycleQty]
      ,SUM([PackageQty]) AS [PackageQty]
      ,SUM([SterilizationQty]) AS [SterilizationQty]
      ,SUM([ProvideQty]) AS [ProvideQty]
      ,SUM([UseQty]) AS [UseQty]
      FROM [view_WorkDetail] AS WorkDetail
      LEFT JOIN view_CargoType AS CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY dbo.fun_get_Date(WorkDetail.[Date],@SummaryType),CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.[CargoTypeID]
      ORDER BY [Date] DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>
    <Content Key="WorkDetailMonthly" DataBaseType="Oracle">
      SELECT
      fun_get_Date(WorkDetail.OpDate,'Monthly') AS OpDate
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.CargoTypeID
      ,SUM(RecycleQty) AS RecycleQty
      ,SUM(PackageQty) AS PackageQty
      ,SUM(SterilizationQty) AS SterilizationQty
      ,SUM(ProvideQty) AS ProvideQty
      ,SUM(UseQty) AS UseQty
      FROM view_WorkDetail  WorkDetail
      LEFT JOIN view_CargoType  CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      WHERE 1 = 1 {0}
      GROUP BY dbo.fun_get_Date(WorkDetail.OpDate,'Monthly'),CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.CargoTypeID
      ORDER BY OpDate DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>

    <Content Key="PersonnelDetailMonthly" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
      DECLARE @SummaryType varchar(16)
      SET @SummaryType = 'Monthly'
      SELECT
      dbo.fun_get_Date(WorkDetail.[Date],@SummaryType) AS [Date]
      ,WorkDetail.OPID
      ,Employee.FNames AS UserText
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.[CargoTypeID]
      ,SUM([RecycleQty]) AS [RecycleQty]
      ,SUM([PackageQty]) AS [PackageQty]
      ,SUM([SterilizationQty]) AS [SterilizationQty]
      ,SUM([ProvideQty]) AS [ProvideQty]
      ,SUM([UseQty]) AS [UseQty]
      FROM [view_WorkDetail] AS WorkDetail
      LEFT JOIN view_CargoType AS CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN AC_WorkGroup AS Employee
      ON WorkDetail.OPID = Employee.ID
      WHERE 1 = 1 {0}
      GROUP BY dbo.fun_get_Date(WorkDetail.[Date],@SummaryType),WorkDetail.OPID,Employee.FNames,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.[CargoTypeID]
      ORDER BY [Date] DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>
    <Content Key="PersonnelDetailMonthly" DataBaseType="Oracle">
      SELECT
      fun_get_Date(WorkDetail.OpDate,'Monthly') AS OpDate
      ,WorkDetail.OPID
      ,Employee.FNames AS UserText
      ,CargoType.CargoTopTypeText --种类
      ,CargoType.CargoTypeKindText--类别
      ,CargoType.CargoTypeText--无菌物品、器械包
      ,WorkDetail.CargoTypeID
      ,SUM(RecycleQty) AS RecycleQty
      ,SUM(PackageQty) AS PackageQty
      ,SUM(SterilizationQty) AS SterilizationQty
      ,SUM(ProvideQty) AS ProvideQty
      ,SUM(UseQty) AS UseQty
      FROM view_WorkDetail  WorkDetail
      LEFT JOIN view_CargoType  CargoType
      ON WorkDetail.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN AC_WorkGroup  Employee
      ON WorkDetail.OPID = Employee.ID
      WHERE 1 = 1 {0}
      GROUP BY fun_get_Date(WorkDetail.OpDate,'Monthly'),WorkDetail.OPID,Employee.FNames,CargoType.CargoTopTypeText,CargoType.CargoTypeKindText,CargoType.CargoTypeText,WorkDetail.CargoTypeID
      ORDER BY OpDate DESC,CargoTopTypeText,CargoTypeKindText,CargoTypeText
    </Content>

    <Content Key="QueryFailedPackage" DataBaseType="SqlServer">
      select
      o.Name as Area,
      ck.KindName AS CargoTypeKindText,--类别
      c.CargoTypeName AS CargoTypeText,--包类型
      sl.Barcode,
      pt.PName AS OutPacking,--外包装
      dbo.fun_get_BadFlagReason(fl.BadFlagReason) as BadFlagReason  -- 坏包原因
      from FlowPackageList fl
      inner join FlowPackage f  on fl.FPackageID = f.FPackageID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      inner join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck  on c.CargoTypeKind = ck.ID
      inner join PackageType pt  on fl.PackageTypeID = pt.PTypeID
      inner join Warehouse  w  on w.WarehouseID   = sl.WarehouseID
      inner join AC_Org o   on o.ID=w.OrgID
      where fl.BadFlag = 1 {0}
    </Content>
    <Content Key="QueryFailedPackage" DataBaseType="Oracle">
      select
      o.Name as Area,
      ck.KindName AS CargoTypeKindText,--类别
      c.CargoTypeName AS CargoTypeText,--包类型
      sl.Barcode,
      pt.PName AS OutPacking,--外包装
      fun_get_BadFlagReason(fl.BadFlagReason) as BadFlagReason  -- 坏包原因
      from FlowPackageList fl
      inner join FlowPackage f  on fl.FPackageID = f.FPackageID
      inner join StorageList sl  on fl.StorageID = sl.StorageID
      inner join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      inner join CargoTypeKind ck  on c.CargoTypeKind = ck.ID
      inner join PackageType pt  on fl.PackageTypeID = pt.PTypeID
      inner join Warehouse  w  on w.WarehouseID   = sl.WarehouseID
      inner join AC_Org o   on o.ID=w.OrgID
      where fl.BadFlag = 1 {0}
    </Content>

    <Content Key="ReportRecyclePDASummary" DataBaseType="SqlServer">
      <!--SELECT C.CARGOTYPEID,C.CARGOTYPENAME,1 AS FQTY
      FROM FLOWRECYCLE R WITH (NOLOCK)
      INNER JOIN FLOWRECYCLELIST RL WITH (NOLOCK) ON R.FRECYCLEID = RL.FRECYCLEID
      INNER JOIN FLOWPACKAGELIST PL WITH (NOLOCK) ON RL.PACKAGEID = PL.PACKAGEID
      INNER JOIN STORAGELIST SL WITH (NOLOCK) ON PL.STORAGEID = SL.STORAGEID
      INNER JOIN WAREHOUSE W WITH (NOLOCK) ON SL.WAREHOUSEID = W.WAREHOUSEID
      INNER JOIN CARGOTYPE C WITH (NOLOCK) ON PL.CARGOTYPEID = C.CARGOTYPEID
      WHERE 1=1 {0}
      ORDER BY C.CARGOTYPENAME-->

		SELECT C.CARGOTYPEID,C.CARGOTYPENAME,SUM(sl.Quantity) AS FQTY
		FROM FLOWRECYCLE R WITH (NOLOCK)
		INNER JOIN FLOWRECYCLELIST RL WITH (NOLOCK) ON R.FRECYCLEID = RL.FRECYCLEID
		INNER JOIN FLOWPACKAGELIST PL WITH (NOLOCK) ON RL.PACKAGEID = PL.PACKAGEID
		left JOIN STORAGELIST SL WITH (NOLOCK) ON PL.STORAGEID = SL.STORAGEID
		left JOIN WAREHOUSE W WITH (NOLOCK) ON SL.WAREHOUSEID = W.WAREHOUSEID
		INNER JOIN CARGOTYPE C WITH (NOLOCK) ON PL.CARGOTYPEID = C.CARGOTYPEID
		WHERE 1=1 {0}
		GROUP BY C.CARGOTYPEID,R.RECYCLEDATE,C.CARGOTYPENAME,R.OPID,W.ORGID,SL.CARGOTYPEID,R.FRECYCLEID

	</Content>
    <Content Key="ReportRecyclePDASummary" DataBaseType="Oracle">
      <!--SELECT C.CARGOTYPEID,C.CARGOTYPENAME,1 AS FQTY
      FROM FLOWRECYCLE R
      INNER JOIN FLOWRECYCLELIST RL  ON R.FRECYCLEID = RL.FRECYCLEID
      INNER JOIN FLOWPACKAGELIST PL   ON RL.PACKAGEID = PL.PACKAGEID
      INNER JOIN STORAGELIST SL   ON PL.STORAGEID = SL.STORAGEID
      INNER JOIN WAREHOUSE W  ON SL.WAREHOUSEID = W.WAREHOUSEID
      INNER JOIN CARGOTYPE C  ON PL.CARGOTYPEID = C.CARGOTYPEID
      WHERE 1 = 1 {0}
      ORDER BY C.CARGOTYPENAME-->

		SELECT C.CARGOTYPEID,C.CARGOTYPENAME,SUM(sl.Quantity) AS FQTY
		FROM FLOWRECYCLE R WITH (NOLOCK)
		INNER JOIN FLOWRECYCLELIST RL WITH (NOLOCK) ON R.FRECYCLEID = RL.FRECYCLEID
		INNER JOIN FLOWPACKAGELIST PL WITH (NOLOCK) ON RL.PACKAGEID = PL.PACKAGEID
		left JOIN STORAGELIST SL WITH (NOLOCK) ON PL.STORAGEID = SL.STORAGEID
		left JOIN WAREHOUSE W WITH (NOLOCK) ON SL.WAREHOUSEID = W.WAREHOUSEID
		INNER JOIN CARGOTYPE C WITH (NOLOCK) ON PL.CARGOTYPEID = C.CARGOTYPEID
		WHERE 1=1 {0}
		GROUP BY C.CARGOTYPEID,R.RECYCLEDATE,C.CARGOTYPENAME,R.OPID,W.ORGID,SL.CARGOTYPEID,R.FRECYCLEID

	</Content>


    <Content Key="Report_WorkLoadSummany" Desc="" DataBaseType="SqlServer">
      <![CDATA[
   SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
    with dtemp as
    (
	    select fpl.PackageID
	    from FlowDisinfect fd inner join FlowDisinfectContainerList fdc on fd.FDisinfectID = fdc.FDisinfectID
						      inner join FlowRecycleContainer frc on fd.FDisinfectID = frc.LastFDisinfectID
						      inner join FlowRecycleList frl on frc.FRecycleID = frl.FRecycleID
						      inner join FlowPackageList fpl on frl.PackageID = fpl.PackageID
	    where fd.DisinfectDate between  @begindate  and  @enddate and fpl.FlowOrgID=@floworgid 
	    group by fpl.PackageID
	    having COUNT(fdc.Status) = SUM(case fdc.status when 1 then 1 when 2 then 1 else 0 end)
    )
	 SELECT CK.KINDNAME,C.CARGOTYPENAME,1 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	  from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where fr.RecycleDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid 
   union all
   	 SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,1 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	  from dtemp inner join FlowPackageList pl on dtemp.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	 union all 
	 SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,1 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
    where p.PackageDate between @begindate and @enddate  and istemp = 0  and pl.FlowOrgID = @floworgid
   union all 
	 SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,1 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowPackageList pl	inner join  FlowPackageIn p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
    where p.PackageInDate between @begindate and @enddate  and istemp = 2  and pl.FlowOrgID = @floworgid 
   union all   
     
    SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,1 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where dl.BeginDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid 
    union all
     SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,1 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where dl.BeginDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and pl.badflag = -2
     union all 
    SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,1 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where fp.ProvideDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid 
    union all
    
    SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,1 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where pl.UseDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid 
    union all
    
     SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,1 AS USENOTRECYCLENUM
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join storagelist sl on pl.StorageID = sl.StorageID
	  where pl.UseDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and sl.status = 70
      
	
      ]]>
    </Content>
    <Content Key="Report_WorkLoadSummany" Desc="" DataBaseType="Oracle">
      <![CDATA[
      with dtemp as
    (
	    select fpl.PackageID
	    from FlowDisinfect fd inner join FlowDisinfectContainerList fdc on fd.FDisinfectID = fdc.FDisinfectID
						      inner join FlowRecycleContainer frc on fd.FDisinfectID = frc.LastFDisinfectID
						      inner join FlowRecycleList frl on frc.FRecycleID = frl.FRecycleID
						      inner join FlowPackageList fpl on frl.PackageID = fpl.PackageID
	    where fd.DisinfectDate between  :begindate  and  :enddate and fpl.FlowOrgID=:floworgid 
	    group by fpl.PackageID
	    having COUNT(fdc.Status) = SUM(case fdc.status when 1 then 1 when 2 then 1 else 0 end)
    )
	 SELECT CK.KINDNAME,C.CARGOTYPENAME,1 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	  from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where fr.RecycleDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid 
   union all
   	 SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,1 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	  from dtemp inner join FlowPackageList pl on dtemp.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	 union all 
	 SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,1 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
    where p.PackageDate between :begindate and :enddate  and istemp = 0  and pl.FlowOrgID = :floworgid
   union all 
	 SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,1 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowPackageList pl	inner join  FlowPackageIn p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
    where p.PackageInDate between :begindate and :enddate  and istemp = 2  and pl.FlowOrgID = :floworgid 
   union all   
     
    SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,1 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where dl.BeginDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid 
    union all
     SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,1 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where dl.BeginDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and pl.badflag = -2
     union all 
    SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,1 AS PROVIDENUM,0 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where fp.ProvideDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid 
    union all
    
    SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,1 AS USENUM,0 AS USENOTRECYCLENUM
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
	  where pl.UseDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid 
    union all
    
     SELECT CK.KINDNAME,C.CARGOTYPENAME,0 AS RECYCLENUM,0 AS DISINFECTNUM,0 AS PACKAGENUM,0 AS STERILIZENUM,0 AS STERILIZECHECKNUM,0 AS PROVIDENUM,0 AS USENUM,1 AS USENOTRECYCLENUM
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join storagelist sl on pl.StorageID = sl.StorageID
	  where pl.UseDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and sl.status = 70
     ]]>
    </Content>

    <Content Key="Report_PackageTraceAll" Desc="" DataBaseType="SqlServer">
      <![CDATA[
   SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
  	SELECT '无条码回收' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,fr.RecycleDate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	  from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on fr.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where fr.RecycleDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and pl.istemp = 1
   union all
    SELECT '配包未审核' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,p.PackageDate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
                inner join ac_workgroup aw on P.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
    where p.PackageDate between @begindate and @enddate  and istemp = 0  and pl.FlowOrgID = @floworgid and pl.CheckID is null
   union all   
     
    SELECT '灭菌未审核' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,dl.begindate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on dl.UserID = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where dl.BeginDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and pl.badflag = -2 
    union all
     SELECT '发放未确认' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,fp.ProvideDate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on fp.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where fp.ProvideDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and fpl.status = 0
    union all
    
    SELECT '领取未入库' as WRONGKIND, CK.KINDNAME,C.CARGOTYPENAME,f.fetchdate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join storagelist sl on pl.storageid = sl.storageid
              inner join flowfetchlist fl on fl.packageid = pl.packageid
              inner join flowfetch f on fl.fetchid = f.fetchid and f.fetchtype = 0
              inner join ac_workgroup aw on f.opid = aw.fid
	  where f.fetchdate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and not exists(select 1 from flowfetch inner join flowfetchlist on flowfetch.FetchID = FlowFetchList.FetchID and flowfetchlist.PackageID = pl.packageid and FlowFetch.FetchType = 2)

    union all
    
    SELECT '使用未领取' as WRONGKIND, CK.KINDNAME,C.CARGOTYPENAME,pl.UseDate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on pl.userid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where pl.UseDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and not exists(select 1 from flowfetch inner join flowfetchlist on flowfetch.FetchID = FlowFetchList.FetchID and flowfetchlist.PackageID = pl.packageid and FlowFetch.FetchType = 0 )
    union all
    
     SELECT  '回收未使用' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,fr.RecycleDate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, isnull(w.warehousename,'') + isnull(l.LocationName,'')  as MEMO
	 from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on fr.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
              left join location l on sl.locationid = l.locationid
              left join Warehouse w on sl.WarehouseID = w.WarehouseID
	  where fr.RecycleDate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and pl.istemp = 0 and pl.userid is null
      union all
    SELECT '添加新任务' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,p.PackageDate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
                inner join ac_workgroup aw on P.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
    where p.PackageDate between @begindate and @enddate  and istemp = 0  and pl.FlowOrgID = @floworgid and not exists(select 1 from FlowPackageListDisinfect where FlowPackageListDisinfect.PackageID = pl.PackageID and FlowPackageListDisinfect.FRecycleID<> '00000000-0000-0000-0000-000000000000')
                                                                                                       and (pl.BadFlag < 0  or exists(select 1 from FlowSterilizationList where FlowSterilizationList.PackageID = pl.PackageID))
      ]]>
    </Content>
    <Content Key="Report_PackageTraceAll" Desc="" DataBaseType="Oracle">
      <![CDATA[
      SELECT '无条码回收' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,fr.RecycleDate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	  from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on fr.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where fr.RecycleDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and pl.istemp = 1
   union all
    SELECT '配包未审核' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,p.PackageDate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
                inner join ac_workgroup aw on P.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
    where p.PackageDate between :begindate and :enddate  and istemp = 0  and pl.FlowOrgID = :floworgid and pl.CheckID is null
   union all   
     
    SELECT '灭菌未审核' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,dl.begindate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from DevicesUseLog dl inner join FlowSterilizationList fsl on dl.LogID = fsl.SterilizationLogID
							inner join FlowPackageList pl on fsl.PackageID = pl.PackageID
							inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on dl.UserID = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where dl.BeginDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and pl.badflag = -2 
    union all
     SELECT '发放未确认' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,fp.ProvideDate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowProvide fp inner join FlowProvideList fpl on fp.ProvideID = fpl.ProvideID
						  inner join FlowPackageList pl on fpl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on fp.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where fp.ProvideDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and fpl.status = 0
    union all
    
    SELECT '领取未入库' as WRONGKIND, CK.KINDNAME,C.CARGOTYPENAME,f.fetchdate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join storagelist sl on pl.storageid = sl.storageid
              inner join flowfetchlist fl on fl.packageid = pl.packageid
              inner join flowfetch f on fl.fetchid = f.fetchid and f.fetchtype = 0
              inner join ac_workgroup aw on f.opid = aw.fid
	  where f.fetchdate between  @begindate  and  @enddate and pl.FlowOrgID=@floworgid and fl.packageid not  in  (select flowfetchlist.packageid from flowfetch inner join flowfetchlist on flowfetch.FetchID = FlowFetchList.FetchID  and FlowFetch.FetchType = 2)

    union all
    
    SELECT '使用未领取' as WRONGKIND, CK.KINDNAME,C.CARGOTYPENAME,pl.UseDate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on pl.userid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
	  where pl.UseDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and pl.packageid not  in  (select flowfetchlist.packageid from flowfetch inner join flowfetchlist on flowfetch.FetchID = FlowFetchList.FetchID  and FlowFetch.FetchType = 2)
    union all
    
     SELECT  '回收未使用' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,fr.RecycleDate  as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, nvl(w.warehousename,'') || nvl(l.LocationName,'') as MEMO
	 from FlowRecycle fr inner join FlowRecycleList frl on fr.FRecycleID = frl.FRecycleID
						  inner join FlowPackageList pl on frl.PackageID = pl.PackageID
						  inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
              inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
              inner join ac_workgroup aw on fr.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
              left join location l on sl.locationid = l.locationid
              left join Warehouse w on sl.WarehouseID = w.WarehouseID
	  where fr.RecycleDate between  :begindate  and  :enddate and pl.FlowOrgID=:floworgid and pl.istemp = 0 and pl.userid is null
    union all
    SELECT '添加新任务' as WRONGKIND,CK.KINDNAME,C.CARGOTYPENAME,p.PackageDate as OPDATE,aw.fnames as OPNAME,sl.BARCODE, 1 as NUM, '' as MEMO
	 from FlowPackageList pl	inner join  FlowPackage p on pl.FPackageID = p.FPackageID
								inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
                inner join CargoTypeKind ck on c.CargoTypeKind = ck.ID 
                inner join ac_workgroup aw on P.opid = aw.fid
              inner join storagelist sl on pl.storageid = sl.storageid
    where p.PackageDate between :begindate and :enddate  and istemp = 0  and pl.FlowOrgID = :floworgid and pl.packageid not in (select PackageID from FlowPackageListDisinfect where   FlowPackageListDisinfect.FRecycleID<> '00000000-0000-0000-0000-000000000000')
                                                                                                       and (pl.BadFlag < 0  or pl.packageid in  (select  packageid from FlowSterilizationList))
     ]]>
    </Content>

    <Content Key="ReportFetchInSummary" Desc="入库报表" DataBaseType="SqlServer">
      <![CDATA[
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
        SELECT C.CARGOTYPENAME,FIN.OPID,ACO.NAME OPERATOR, FIN.RECIPIENTID,ACR.NAME RECIPIENT, FIN.FETCHDATE,SL.EXPDATE,FIN.LOCATIONID,L.LOCATIONNAME,W.WAREHOUSENAME,AO.NAME ORGNAME ,COUNT(1) QTY
        FROM FLOWFETCH FIN
        INNER JOIN FLOWFETCHLIST FL ON FL.FETCHID=FIN.FETCHID
        INNER JOIN FLOWPACKAGELIST FPL ON FPL.PACKAGEID=FL.PACKAGEID
        INNER JOIN STORAGELIST SL ON SL.STORAGEID=FPL.STORAGEID
        INNER JOIN CARGOTYPE C ON C.CARGOTYPEID=FPL.CARGOTYPEID
        LEFT JOIN AC_USER ACO ON ACO.ID=FIN.OPID
        LEFT JOIN AC_USER ACR ON ACR.ID=FIN.RECIPIENTID
        LEFT JOIN LOCATION L ON L.LOCATIONID=FIN.LOCATIONID 
        LEFT JOIN WAREHOUSE W ON W.WAREHOUSEID=L.WAREHOUSEID 
        LEFT JOIN AC_ORG AO ON AO.ID=W.ORGID 
        WHERE FIN.FETCHTYPE=2 {0}
        GROUP BY C.CARGOTYPENAME,FIN.OPID,ACO.NAME, FIN.RECIPIENTID,ACR.NAME, FIN.FETCHDATE,SL.EXPDATE,FIN.LOCATIONID,L.LOCATIONNAME,W.WAREHOUSENAME,AO.NAME
        ORDER BY FETCHDATE DESC
      ]]>
    </Content>
    <Content Key="ReportFetchInSummary" Desc="入库报表" DataBaseType="Oracle">
      <![CDATA[
        SELECT C.CARGOTYPENAME,FIN.OPID,ACO.NAME OPERATOR, FIN.RECIPIENTID,ACR.NAME RECIPIENT, FIN.FETCHDATE,SL.EXPDATE,FIN.LOCATIONID,L.LOCATIONNAME,W.WAREHOUSENAME,AO.NAME ORGNAME ,COUNT(1) QTY
        FROM FLOWFETCH FIN
        INNER JOIN FLOWFETCHLIST FL ON FL.FETCHID=FIN.FETCHID
        INNER JOIN FLOWPACKAGELIST FPL ON FPL.PACKAGEID=FL.PACKAGEID
        INNER JOIN STORAGELIST SL ON SL.STORAGEID=FPL.STORAGEID
        INNER JOIN CARGOTYPE C ON C.CARGOTYPEID=FPL.CARGOTYPEID
        LEFT JOIN AC_USER ACO ON ACO.ID=FIN.OPID
        LEFT JOIN AC_USER ACR ON ACR.ID=FIN.RECIPIENTID
        LEFT JOIN LOCATION L ON L.LOCATIONID=FIN.LOCATIONID 
        LEFT JOIN WAREHOUSE W ON W.WAREHOUSEID=L.WAREHOUSEID 
        LEFT JOIN AC_ORG AO ON AO.ID=W.ORGID 
        WHERE FIN.FETCHTYPE=2 {0}
        GROUP BY C.CARGOTYPENAME,FIN.OPID,ACO.NAME, FIN.RECIPIENTID,ACR.NAME, FIN.FETCHDATE,SL.EXPDATE,FIN.LOCATIONID,L.LOCATIONNAME,W.WAREHOUSENAME,AO.NAME
        ORDER BY FETCHDATE DESC
      ]]>
    </Content>
    <Content Key="Query_ReportHistory" DataBaseType="SqlServer">
      SELECT * FROM ReportHistory WHERE 1 = 1 {0}
    </Content>
	<Content Key="Query_ReportHistory" DataBaseType="Oracle">
		  SELECT * FROM ReportHistory WHERE 1 = 1 {0}
	</Content>

    <Content Key="ReportWorkloadSummary" Desc="月份统计工作量及收入统计报表" DataBaseType="SqlServer">
      <![CDATA[
        SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
        declare @FDate varchar(20)
        declare @FProvideQty int
        declare @FSterilizeQty int
        declare @FSterilizeDQty int
        declare @FAccount decimal(18,2)

        select @FDate = CONVERT(varchar(7),@begindate,120)

        select @FProvideQty = COUNT(1),@FAccount = SUM(c.Amount) 
        from 
        (
        select distinct p.PackageID,p.CargoTypeID
        from FlowProvideList fpl inner join FlowProvide fp on fp.ProvideID=fpl.ProvideID
                                  inner join flowpackagelist p on fpl.packageid = p.packageid
        where ProvideDate between @begindate and @enddate 
        ) as t inner join CargoType c on t.CargoTypeID = c.CargoTypeID

        select @FSterilizeQty = COUNT(1)
        from DevicesUseLog du inner join Devices d on du.DeviceID = d.DeviceID
        where BeginDate between @begindate and @enddate and d.DeviceType =4 

        select @FSterilizeDQty = COUNT(1)
        from DevicesUseLog du inner join Devices d on du.DeviceID = d.DeviceID
        where BeginDate between @begindate and @enddate and d.DeviceType =5

        select @FDate as FDate,@FProvideQty as FProvideQty,
		        @FSterilizeQty as FSterilizeQty,
		        @FSterilizeDQty as FSterilizeDQty,
		        @FAccount as FAccount

      ]]>
    </Content>
    <Content Key="ReportWorkloadSummary" Desc="月份统计工作量及收入统计报表" DataBaseType="Oracle">
      <![CDATA[
      declare 
	   vFDate varchar2(20);
       vFProvideQty number;
       vFSterilizeQty number;
       vFSterilizeDQty number;
       vFAccount NUMBER(18,2);
	   o_cursor sys_refcursor;
      begin
		vFDate := to_char(:begindate,'yyyy-mm');

      select  COUNT(1),SUM(c.Amount) into  vFProvideQty,vFAccount
      from 
      (
      select distinct p.PackageID,p.CargoTypeID
      from FlowProvideList fpl inner join FlowProvide fp on fp.ProvideID=fpl.ProvideID
                            inner join flowpackagelist p on fpl.packageid = p.packageid
      where ProvideDate between :begindate and :enddate 
      ) t inner join CargoType c on t.CargoTypeID = c.CargoTypeID;

      select    COUNT(1) into vFSterilizeQty
      from DevicesUseLog du inner join Devices d on du.DeviceID = d.DeviceID
      where BeginDate between :begindate and :enddate and d.DeviceType =4 ;

      select  COUNT(1) into vFSterilizeDQty
      from DevicesUseLog du inner join Devices d on du.DeviceID = d.DeviceID
      where BeginDate between :begindate and :enddate and d.DeviceType =5;

      open o_cursor for select vFDate as FDate,vFProvideQty as FProvideQty,
		      vFSterilizeQty as FSterilizeQty,
		      vFSterilizeDQty as FSterilizeDQty,
		      vFAccount as FAccount from dual;
      end;			  
       
      ]]>
    </Content>

    <Content Key="GetProvideRecycleReport" Desc="回收发放数量" DataBaseType="SqlServer">
      SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
      SELECT
      ORGID,O.NAME AS ORGNAME,T.CARGOTYPEID,C.CARGOTYPENAME,SUM(RECYCLEQTY) AS RECYCLEQTY,SUM(RETURNQTY) AS RETURNQTY,SUM(PROVIDEQTY) AS PROVIDEQTY,SUM(LENDQTY) AS LENDQTY
      FROM
      (
      SELECT
      W.OrgID as ORGID,
      FPL.CargoTypeID as CARGOTYPEID,
      COUNT(distinct RL.PackageID) as RECYCLEQTY,
      0 as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      INNER JOIN Warehouse W ON FPL.LastWarehouseID = W.WarehouseID
      where 1=1 {0}
      GROUP BY W.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FR.OrgID as ORGID,
      RL.CargoTypeID as CARGOTYPEID,
      0 as RECYCLEQTY,
      SUM(ReturnQuantity) as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowProvideLendReturnDetail RL
      INNER JOIN FlowProvideLendReturn FR ON FR.ProvideLendReturnID = RL.ProvideLendReturnID
      where 1=1 {3}
      GROUP BY FR.OrgID,RL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 as RETURNQTY,
      COUNT(distinct FPL.PackageID) AS PROVIDEQTY,
      0 AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 0 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 AS RETURNQTY,
      0 AS PROVIDEQTY,
      COUNT(distinct FPL.PackageID) AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 1 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      ) T
      INNER JOIN CargoType C ON T.CARGOTYPEID = C.CargoTypeID
      INNER JOIN AC_Org O ON T.ORGID = O.ID
      GROUP BY ORGID,O.NAME,T.CARGOTYPEID,C.CARGOTYPENAME
      {2}
    </Content>

    <Content Key="GetProvideRecycleReport" Desc="回收发放数量" DataBaseType="Oracle">
      SELECT
      ORGID,O.NAME AS ORGNAME,T.CARGOTYPEID,C.CARGOTYPENAME,SUM(RECYCLEQTY) AS RECYCLEQTY,SUM(RETURNQTY) AS RETURNQTY,SUM(PROVIDEQTY) AS PROVIDEQTY,SUM(LENDQTY) AS LENDQTY
      FROM
      (
      SELECT
      W.OrgID as ORGID,
      FPL.CargoTypeID as CARGOTYPEID,
      COUNT(distinct RL.PackageID) as RECYCLEQTY,
      0 as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      INNER JOIN Warehouse W ON FPL.LastWarehouseID = W.WarehouseID
      where 1=1 {0}
      GROUP BY W.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FR.OrgID as ORGID,
      RL.CargoTypeID as CARGOTYPEID,
      0 as RECYCLEQTY,
      SUM(ReturnQuantity) as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowProvideLendReturnDetail RL
      INNER JOIN FlowProvideLendReturn FR ON FR.ProvideLendReturnID = RL.ProvideLendReturnID
      where 1=1 {3}
      GROUP BY FR.OrgID,RL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 as RETURNQTY,
      COUNT(distinct FPL.PackageID) AS PROVIDEQTY,
      0 AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 0 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 AS RETURNQTY,
      0 AS PROVIDEQTY,
      COUNT(distinct FPL.PackageID) AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 1 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      ) T
      INNER JOIN CargoType C ON T.CARGOTYPEID = C.CargoTypeID
      INNER JOIN AC_Org O ON T.ORGID = O.ID
      GROUP BY ORGID,O.NAME,T.CARGOTYPEID,C.CARGOTYPENAME
      {2}
    </Content>

    <Content Key="GetProvideRecycleReports" Desc="回收发放数量" DataBaseType="SqlServer">
      <![CDATA[
	  SELECT
      case when SUM(RECYCLEQTY)=0 then 0 else case when SUM(RECYCLEQTY)-SUM(PROVIDEQTY)-SUM(LENDQTY)<0 then 0 else SUM(RECYCLEQTY)-SUM(PROVIDEQTY)-SUM(LENDQTY) end end as notPROVIDEQTY,
	  ISNULL(c.amount,0)*SUM(RECYCLEQTY) as sumPrice,
      oo.Name AS AREANAME,ORGID,O.NAME AS ORGNAME,T.CARGOTYPEID,C.CARGOTYPENAME,SUM(RECYCLEQTY) AS RECYCLEQTY,SUM(RETURNQTY) AS RETURNQTY,SUM(PROVIDEQTY) AS PROVIDEQTY,SUM(LENDQTY) AS LENDQTY,
      isnull(c.amount,0) as AMOUNT
      FROM
      (
      SELECT
      W.OrgID as ORGID,
      FPL.CargoTypeID as CARGOTYPEID,
      COUNT(distinct RL.PackageID) as RECYCLEQTY,
      0 as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      INNER JOIN Warehouse W ON FPL.LastWarehouseID = W.WarehouseID
      where 1=1 {0}
      GROUP BY W.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FR.OrgID as ORGID,
      RL.CargoTypeID as CARGOTYPEID,
      0 as RECYCLEQTY,
      SUM(ReturnQuantity) as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowProvideLendReturnDetail RL
      INNER JOIN FlowProvideLendReturn FR ON FR.ProvideLendReturnID = RL.ProvideLendReturnID
      where 1=1 {3}
      GROUP BY FR.OrgID,RL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 as RETURNQTY,
      COUNT(distinct FPL.PackageID) AS PROVIDEQTY,
      0 AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 0 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 AS RETURNQTY,
      0 AS PROVIDEQTY,
      COUNT(distinct FPL.PackageID) AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 1 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      ) T
      INNER JOIN CargoType C ON T.CARGOTYPEID = C.CargoTypeID
      INNER JOIN AC_Org O ON T.ORGID = O.ID
      left join AC_Org oo on O.PrevID=oo.ID
      where 1=1 {4}
      GROUP BY oo.Name,ORGID,O.NAME,T.CARGOTYPEID,C.CARGOTYPENAME,c.amount
      {2}
	  ]]>	   
    </Content>

    <Content Key="GetProvideRecycleReports" Desc="回收发放数量" DataBaseType="Oracle">
      <![CDATA[
	 	  SELECT
      case when SUM(RECYCLEQTY)=0 then 0 else case when SUM(RECYCLEQTY)-SUM(PROVIDEQTY)-SUM(LENDQTY)<0 then 0 else SUM(RECYCLEQTY)-SUM(PROVIDEQTY)-SUM(LENDQTY) end end as notPROVIDEQTY,
	  nvl(c.amount,0)*SUM(RECYCLEQTY) as sumPrice,
      oo.Name AS AREANAME,ORGID,O.NAME AS ORGNAME,T.CARGOTYPEID,C.CARGOTYPENAME,SUM(RECYCLEQTY) AS RECYCLEQTY,SUM(RETURNQTY) AS RETURNQTY,SUM(PROVIDEQTY) AS PROVIDEQTY,SUM(LENDQTY) AS LENDQTY,
      nvl(c.amount,0) as AMOUNT
      FROM
      (
      SELECT
      W.OrgID as ORGID,
      FPL.CargoTypeID as CARGOTYPEID,
      COUNT(distinct RL.PackageID) as RECYCLEQTY,
      0 as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowRecycleList RL
      INNER JOIN FlowRecycle FR ON FR.FRecycleID = RL.FRecycleID
      INNER JOIN FlowPackageList FPL ON RL.PackageID = FPL.PackageID
      INNER JOIN Warehouse W ON FPL.LastWarehouseID = W.WarehouseID
      where 1=1 {0}
      GROUP BY W.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FR.OrgID as ORGID,
      RL.CargoTypeID as CARGOTYPEID,
      0 as RECYCLEQTY,
      SUM(ReturnQuantity) as RETURNQTY,
      0 as PROVIDEQTY,
      0 as LENDQTY
      FROM FlowProvideLendReturnDetail RL
      INNER JOIN FlowProvideLendReturn FR ON FR.ProvideLendReturnID = RL.ProvideLendReturnID
      where 1=1 {3}
      GROUP BY FR.OrgID,RL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 as RETURNQTY,
      COUNT(distinct FPL.PackageID) AS PROVIDEQTY,
      0 AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 0 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      UNION ALL
      SELECT
      FP.OrgID AS ORGID,
      FPL.CargoTypeID AS CARGOTYPEID,
      0 AS RECYCLEQTY,
      0 AS RETURNQTY,
      0 AS PROVIDEQTY,
      COUNT(distinct FPL.PackageID) AS LENDQTY
      FROM FlowProvideList PL
      INNER JOIN FlowProvide FP ON FP.ProvideID = PL.ProvideID
      INNER JOIN FlowPackageList FPL  ON PL.PackageID = FPL.PackageID
      INNER JOIN AC_ORG AO ON FP.OrgID = AO.ID
      INNER JOIN CargoType CT ON FPL.CargoTypeID=CT.CargoTypeID
      where FPL.LENDFLAG = 1 {1}
      GROUP BY FP.OrgID,FPL.CargoTypeID
      ) T
      INNER JOIN CargoType C ON T.CARGOTYPEID = C.CargoTypeID
      INNER JOIN AC_Org O ON T.ORGID = O.ID
      left join AC_Org oo on O.PrevID=oo.ID
      where 1=1 {4}
      GROUP BY oo.Name,ORGID,O.NAME,T.CARGOTYPEID,C.CARGOTYPENAME,c.amount
      {2}
	  ]]>
    </Content>
    
    <Content Key="ReportProvideMaterialStock" Desc="一次性物品统计" DataBaseType="SqlServer">
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		select CARGOTYPENAME,sum(InQty) as INQTY, sum(OutQty) as OUTQTY, sum(StockQty) as STOCKQTY
		from
		(
		SELECT  c.CargoTypeName, sum(sil.Quantity) as InQty, 0 as OutQty, 0 as StockQty
		From StorageIn si inner join StorageInList sil on si.InID = sil.InID
		inner join CargoType c on sil.CargoTypeID = c.CargoTypeID
		where c.cargotoptype = 2 {0}
		group by c.CargoTypeName
		union all
		SELECT  c.CargoTypeName,0 as InQty,  sum(sol.Quantity) as  OutQty, 0 as StockQty
		From StorageOut so inner join StorageOutList sol on so.OutID = sol.OutID
		inner join CargoType c on sol.CargoTypeID = c.CargoTypeID
		where c.cargotoptype = 2 {1}
		group by c.CargoTypeName
		union all
		select  c.CargoTypeName,0 as InQty,  0 as  OutQty, sum(sl.Quantity) as StockQty
		from StorageList sl inner join CargoType c on sl.CargoTypeID = c.CargoTypeID
		where c.cargotoptype = 2 and sl.Quantity > 0 and CONVERT(varchar(10),SL.EXPDate,120) >CONVERT(varchar(10),GETDATE(),120) {2}
		group by c.CargoTypeName
		)   a
		Group By
		a.CargoTypeName
	</Content>
    <Content Key="ReportProvideMaterialStock" Desc="一次性物品统计" DataBaseType="Oracle">
		select CARGOTYPENAME,sum(InQty) as INQTY, sum(OutQty) as OUTQTY, sum(StockQty) as STOCKQTY
		from
		(
		SELECT  c.CargoTypeName, sum(sil.Quantity) as InQty, 0 as OutQty, 0 as StockQty
		From StorageIn si inner join StorageInList sil on si.InID = sil.InID
		inner join CargoType c on sil.CargoTypeID = c.CargoTypeID
		where c.cargotoptype = 2 {0}
		group by c.CargoTypeName
		union all
		SELECT  c.CargoTypeName,0 as InQty,  sum(sol.Quantity) as  OutQty, 0 as StockQty
		From StorageOut so inner join StorageOutList sol on so.OutID = sol.OutID
		inner join CargoType c on sol.CargoTypeID = c.CargoTypeID
		where c.cargotoptype = 2 {1}
		group by c.CargoTypeName
		union all
		select  c.CargoTypeName,0 as InQty,  0 as  OutQty, sum(sl.Quantity) as StockQty
		from StorageList sl inner join CargoType c on sl.CargoTypeID = c.CargoTypeID
		where c.cargotoptype = 2 and sl.Quantity > 0 and to_char(sl.expdate,'yyyy-mm-dd')>to_char(sysdate,'yyyy-mm-dd') {2}
		group by c.CargoTypeName
		)  a
		Group By
		a.CargoTypeName
	</Content>
    <Content Key="Query_ProvidePreOrderAlarm" Desc="一次性物品预警" DataBaseType="SqlServer">
      select CARGOTYPENAME,sum(StockQty) as STOCKQTY,SafeQuantity
      from
      (
      select  sl.WarehouseID,c.CargoTypeName,sum(sl.Quantity) as StockQty,c.SafeQuantity
      from StorageList sl inner join CargoType c on sl.CargoTypeID = c.CargoTypeID
      where c.cargotoptype in (1,2) and sl.Quantity > 0 and CONVERT(varchar(10),SL.EXPDate,120) >CONVERT(varchar(10),GETDATE(),120) {0}
      group by c.CargoTypeName,c.SafeQuantity,sl.WarehouseID
      )   a where 1=1 {1}
      Group By
      a.CargoTypeName,a.SafeQuantity,a.WarehouseID
    </Content>

    <Content Key="Query_ProvidePreOrderAlarm" Desc="一次性物品预警" DataBaseType="Oracle">
      select CARGOTYPENAME,sum(StockQty) as STOCKQTY,SafeQuantity
      from
      (
      select  sl.WarehouseID,c.CargoTypeName,sum(sl.Quantity) as StockQty,c.SafeQuantity
      from StorageList sl inner join CargoType c on sl.CargoTypeID = c.CargoTypeID
      where c.cargotoptype in (1,2) and sl.Quantity > 0 and to_char(sl.expdate,'yyyy-mm-dd')>to_char(sysdate,'yyyy-mm-dd') {0}
      group by c.CargoTypeName,c.SafeQuantity,sl.WarehouseID
      )   a where 1=1 {1}
      Group By
      a.CargoTypeName,a.SafeQuantity,a.WarehouseID
    </Content>
    <Content Key="ReportFetchSummaryMore" Desc="领取台账" DataBaseType="SqlServer">
		SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
		select  C.CARGOTYPENAME,SL.BARCODE,
		FF.FETCHDATE,FFU.FNAMES AS FETCHUSER,FFA.FNAMES AS FETCHADMIN,
		PL.USEDATE,FUU.FNAMES AS USEUSER,
		JJ.JJDATE,JJ.JJUSER,
		CF.CFDATE,CF.CFUSER,
		FR.RECYCLEDATE,FRU.FNAMES AS RECYCLEUSER
		from FlowFetch ff inner join FlowFetchList ffl on (ff.FetchID = ffl.FetchID and ff.FetchType = 0)
		inner join FlowPackageList pl on ffl.PackageID = pl.PackageID
		inner join StorageList sl on pl.StorageID = sl.StorageID
		inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
		left join AC_WorkGroup ffu on ff.Recipientid = ffu.FID
		left join AC_WorkGroup ffa on ff.opid = ffa.FID
		left join AC_WorkGroup fuu on pl.UserID = fuu.FID
		left join
		(select ffjj.FetchDate as jjdate,ffjju.FNames as jjuser,ffjjl.PackageID
		from  FlowFetch ffjj inner join FlowFetchList ffjjl on (ffjj.FetchID = ffjjl.FetchID and ffjj.FetchType = 3 )
		inner join AC_WorkGroup ffjju on ffjj.OPID = ffjju.FID
		) jj on pl.PackageID = jj.PackageID
		left join
		(select ffcf.FetchDate as cfdate,ffcfu.FNames as cfuser,ffcfl.PackageID
		from  FlowFetch ffcf inner join FlowFetchList ffcfl on (ffcf.FetchID = ffcfl.FetchID and ffcf.FetchType = 1)
		inner join AC_WorkGroup ffcfu on ffcf.OPID = ffcfu.FID
		) cf on pl.PackageID = cf.PackageID
		left join FlowRecycleList frl on frl.PackageID = pl.PackageID
		left join FlowRecycle fr on frl.FRecycleID = fr.FRecycleID
		left join AC_WorkGroup fru on fr.OPID = fru.FID
		WHERE 1=1 {0}
	</Content>
    <Content Key="ReportFetchSummaryMore" Desc="领取台账" DataBaseType="Oracle">
		select  C.CARGOTYPENAME,SL.BARCODE,
		FF.FETCHDATE,FFU.FNAMES AS FETCHUSER,FFA.FNAMES AS FETCHADMIN,
		PL.USEDATE,FUU.FNAMES AS USEUSER,
		JJ.JJDATE,JJ.JJUSER,
		CF.CFDATE,CF.CFUSER,
		FR.RECYCLEDATE,FRU.FNAMES AS RECYCLEUSER
		from FlowFetch ff inner join FlowFetchList ffl on (ff.FetchID = ffl.FetchID and ff.FetchType = 0)
		inner join FlowPackageList pl on ffl.PackageID = pl.PackageID
		inner join StorageList sl on pl.StorageID = sl.StorageID
		inner join CargoType c on pl.CargoTypeID = c.CargoTypeID
		left join AC_WorkGroup ffu on ff.Recipientid = ffu.FID
		left join AC_WorkGroup ffa on ff.opid = ffa.FID
		left join AC_WorkGroup fuu on pl.UserID = fuu.FID
		left join
		(select ffjj.FetchDate as jjdate,ffjju.FNames as jjuser,ffjjl.PackageID
		from  FlowFetch ffjj inner join FlowFetchList ffjjl on (ffjj.FetchID = ffjjl.FetchID and ffjj.FetchType = 3 )
		inner join AC_WorkGroup ffjju on ffjj.OPID = ffjju.FID
		) jj on pl.PackageID = jj.PackageID
		left join
		(select ffcf.FetchDate as cfdate,ffcfu.FNames as cfuser,ffcfl.PackageID
		from  FlowFetch ffcf inner join FlowFetchList ffcfl on (ffcf.FetchID = ffcfl.FetchID and ffcf.FetchType = 1)
		inner join AC_WorkGroup ffcfu on ffcf.OPID = ffcfu.FID
		) cf on pl.PackageID = cf.PackageID
		left join FlowRecycleList frl on frl.PackageID = pl.PackageID
		left join FlowRecycle fr on frl.FRecycleID = fr.FRecycleID
		left join AC_WorkGroup fru on fr.OPID = fru.FID
		WHERE 1=1 {0}
	</Content>

    <Content Key="Query_IsCleaning" Desc="清洗是否合格统计" DataBaseType="SqlServer">
      Select dl.BEGINDATE,d.DEVICEID,d.DEVICENAME,dl.TODAYUSETIMES,ou.FNames NAME ,tp.TYPENAME ISOK,fd.FDISINFECTID,dl.MONITORDATAID,
      CASE ISNULL(Convert(nvarchar(50),dl.MONITORDATAID),'')  WHEN '' THEN '无记录' ELSE '查看监控数据' END AS MONITORLOG,isnull(prule.RULENAME,'') as RULENAME
      ,fd.FISPDADATA
      ,fdl.Status
      ,c.BARCODE
      ,c.CONTAINERNAME
      ,case when   fdl.Status=1 then '合格'  when fdl.Status=-1 then '不合格'  when  fdl.Status=2 then '部分合格'  end as QUALIFIEDTRUE
      ,case when fdl.Status=1 then 1 end as QUALIFIEDTRUETRUE
      ,case when fdl.Status=-1 then 1 end as QUALIFIEDTRUEFALSE
      ,case when fdl.Status=2 then 1 end as QUALIFIEDTRUEPART
      ,Case when fd.FISPDADATA = 0 then '否' when fd.FISPDADATA = 1 then '是' end as PDA,dl.LOGID,D.BARCODE as DEVICEBARCODE,D.DEVICETYPE
      From FlowDisinfect fd
      inner join DevicesUseLog dl  on fd.LogID = dl.Logid
      inner join Devices d  on dl.DeviceID = d.deviceid
      inner join AC_WorkGroup ou  on dl.UserID= ou.FID
      inner join SystemTypeParameter tp  on ( dl.isok = tp.TypeValue and tp.TypeKey = 'ContainerStatus')
      left join DeviceProcessRule prule  on dl.DeviceProcessRuleID = prule.RuleID
      left join  FlowDisinfectContainerList fdl on fdl.FDisinfectID=fd.FDISINFECTID
      left join  Container c on fdl.ContainerID=c.ContainerID
      where 1=1 {0}
    </Content>

    <Content Key="Query_IsCleaning" Desc="清洗是否合格统计" DataBaseType="Oracle">
      Select dl.BEGINDATE,d.DEVICEID,d.DEVICENAME,dl.TODAYUSETIMES,ou.FNames NAME ,tp.TYPENAME ISOK,fd.FDISINFECTID,dl.MONITORDATAID,
      CASE nvl(dl.MONITORDATAID,-1)  WHEN -1 THEN '无记录' ELSE '查看监控数据' END AS MONITORLOG,nvl(prule.RULENAME,'') as RULENAME
      ,fd.FISPDADATA
      ,fdl.Status
      ,c.BARCODE
      ,c.CONTAINERNAME
      ,case when   fdl.Status=1 then '合格'  when fdl.Status=-1 then '不合格'  when  fdl.Status=2 then '部分合格'  end as QUALIFIEDTRUE
      ,case when fdl.Status=1 then 1 end as QUALIFIEDTRUETRUE
      ,case when fdl.Status=-1 then 1 end as QUALIFIEDTRUEFALSE
      ,case when fdl.Status=2 then 1 end as QUALIFIEDTRUEPART
      ,Case when fd.FISPDADATA = 0 then '否' when fd.FISPDADATA = 1 then '是' end as PDA,dl.LOGID,D.BARCODE as DEVICEBARCODE,D.DEVICETYPE
      From FlowDisinfect fd
      inner join DevicesUseLog dl  on fd.LogID = dl.Logid
      inner join Devices d  on dl.DeviceID = d.deviceid
      inner join AC_WorkGroup ou  on dl.UserID= ou.FID
      inner join SystemTypeParameter tp  on ( dl.isok = tp.TypeValue and tp.TypeKey = 'ContainerStatus')
      left join DeviceProcessRule prule  on dl.DeviceProcessRuleID = prule.RuleID
      left join  FlowDisinfectContainerList fdl on fdl.FDisinfectID=fd.FDISINFECTID
      left join  Container c on fdl.ContainerID=c.ContainerID
      where 1=1 {0}
    </Content>

    <Content Key="Query_SumSterilizaTionReason" Desc="灭菌不合格原因统计" DataBaseType="SqlServer">
      select c.CARGOTYPENAME,
      dul.BEGINDATE,
      d.DEVICENAME,
      dpr.RULENAME,
      aw.FNAMES,
      dul.STERILIZATIONREASON,
      1 as FQTY from DevicesUseLog dul
      left join FlowSterilizationList fsl on dul.LogID=fsl.SterilizationLogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join AC_WorkGroup aw on dul.UserID=aw.FID
      left join DeviceProcessRule dpr on dul.DeviceProcessRuleID=dpr.RuleID
      left join FlowPackageList fpl on fsl.PackageID=fpl.PackageID
      inner join StorageList sl  on fpl.StorageID = sl.StorageID
      inner join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      where 1=1 {0}
    </Content>

    <Content Key="Query_SumSterilizaTionReason" Desc="灭菌不合格原因统计" DataBaseType="Oracle">
      select c.CARGOTYPENAME,
      dul.BEGINDATE,
      d.DEVICENAME,
      dpr.RULENAME,
      aw.FNAMES,
      dul.STERILIZATIONREASON,
      1 as FQTY from DevicesUseLog dul
      left join FlowSterilizationList fsl on dul.LogID=fsl.SterilizationLogID
      left join Devices d on dul.DeviceID=d.DeviceID
      left join AC_WorkGroup aw on dul.UserID=aw.FID
      left join DeviceProcessRule dpr on dul.DeviceProcessRuleID=dpr.RuleID
      left join FlowPackageList fpl on fsl.PackageID=fpl.PackageID
      inner join StorageList sl  on fpl.StorageID = sl.StorageID
      inner join CargoType c  on sl.CargoTypeID = c.CargoTypeID
      where 1=1 {0}
    </Content>

    <Content Key="Query_Sterilization" DataBaseType="SqlServer">
      SELECT ct.CargoTypeText,ct.CargoTypeKindText,sl.Barcode,DL.BEGINDATE,d.DEVICEID,dl.MONITORDATAID,CASE ISNULL(Convert(nvarchar(50),dl.MONITORDATAID),'')  WHEN '' THEN '无记录' ELSE '查看监控数据' END AS MONITORLOG,D.DEVICENAME,DL.USETIMES,DL.TODAYUSETIMES,OU.FNames NAME, TP.TYPENAME AS ISOK,DL.LOGID,DL.CPIMGID,isnull(prule.RULENAME,'') as RULENAME,CTP.TYPENAME AS ISCPCDOK,BTP.TYPENAME AS ISBPCDOK,D.BARCODE as DEVICEBARCODE,D.DEVICETYPE,ST.CNT as STERILIZEPACKAGECOUNT,isnull(DL.CPCDBarcode,'') as  CPCDBARCODE,ISBD.TypeName AS ISBDTEST
      FROM DEVICESUSELOG DL  INNER JOIN DEVICES D  ON DL.DEVICEID = D.DEVICEID
      LEFT JOIN AC_WorkGroup OU  ON DL.USERID= OU.FID
      LEFT JOIN SYSTEMTYPEPARAMETER TP  ON ( DL.ISOK = TP.TYPEVALUE AND TP.TYPEKEY = 'IsOK')
      LEFT JOIN SYSTEMTYPEPARAMETER CTP ON ( DL.IsCPCDOK =  CTP.TYPEVALUE AND CTP.TYPEKEY = 'IsOK')
      LEFT JOIN SYSTEMTYPEPARAMETER BTP ON ( DL.IsBPCDOK =  BTP.TYPEVALUE AND BTP.TYPEKEY = 'IsOK')
      LEFT JOIN SYSTEMTYPEPARAMETER ISBD ON ( DL.IsBDTest = ISBD.TYPEVALUE AND ISBD.TYPEKEY = 'YesOrNo')
      left join (SELECT COUNT(*) as cnt,SterilizationLogID,PackageID
      FROM  FlowSterilizationList group by SterilizationLogID,PackageID) ST
      on DL.Logid=ST.SterilizationLogID
      left join DeviceProcessRule prule  on dl.DeviceProcessRuleID = prule.RuleID
      inner join FlowPackageList fl on  ST.PackageID=fl.PackageID
      inner join StorageList sl on fl.StorageID=sl.StorageID
      inner join view_CargoType ct on sl.CargoTypeID=ct.CargoTypeID
      WHERE D.DEVICETYPE >= 4 {0}
      order by ct.CargoTypeKindText desc, ct.CargoTypeText desc
    </Content>

    <Content Key="Query_Sterilization" DataBaseType="Oracle">
      SELECT ct.CargoTypeText,ct.CargoTypeKindText,sl.Barcode,DL.BEGINDATE,d.DEVICEID,dl.MONITORDATAID,CASE nvl(dl.MONITORDATAID,-1)  WHEN -1 THEN '无记录' ELSE '查看监控数据' END AS MONITORLOG,D.DEVICENAME,DL.USETIMES,DL.TODAYUSETIMES,OU.FNames NAME, TP.TYPENAME AS ISOK,DL.LOGID,DL.CPIMGID,nvl(prule.RULENAME,'') as RULENAME,CTP.TYPENAME AS ISCPCDOK,BTP.TYPENAME AS ISBPCDOK,D.BARCODE as DEVICEBARCODE,D.DEVICETYPE,ST.CNT as STERILIZEPACKAGECOUNT,nvl(DL.CPCDBarcode,'') as  CPCDBARCODE,ISBD.TypeName AS ISBDTEST
      FROM DEVICESUSELOG DL  INNER JOIN DEVICES D  ON DL.DEVICEID = D.DEVICEID
      LEFT JOIN AC_WorkGroup OU  ON DL.USERID= OU.FID
      LEFT JOIN SYSTEMTYPEPARAMETER TP  ON ( DL.ISOK = TP.TYPEVALUE AND TP.TYPEKEY = 'IsOK')
      LEFT JOIN SYSTEMTYPEPARAMETER CTP ON ( DL.IsCPCDOK =  CTP.TYPEVALUE AND CTP.TYPEKEY = 'IsOK')
      LEFT JOIN SYSTEMTYPEPARAMETER BTP ON ( DL.IsBPCDOK =  BTP.TYPEVALUE AND BTP.TYPEKEY = 'IsOK')
      LEFT JOIN SYSTEMTYPEPARAMETER ISBD ON ( DL.IsBDTest = ISBD.TYPEVALUE AND ISBD.TYPEKEY = 'YesOrNo')
      left join (SELECT COUNT(*) as cnt,SterilizationLogID,PackageID
      FROM  FlowSterilizationList group by SterilizationLogID,PackageID) ST
      on DL.Logid=ST.SterilizationLogID
      left join DeviceProcessRule prule  on dl.DeviceProcessRuleID = prule.RuleID
      inner join FlowPackageList fl on  ST.PackageID=fl.PackageID
      inner join StorageList sl on fl.StorageID=sl.StorageID
      inner join view_CargoType ct on sl.CargoTypeID=ct.CargoTypeID
      WHERE D.DEVICETYPE >= 4 {0}
      order by ct.CargoTypeKindText desc, ct.CargoTypeText desc
    </Content>
	  <Content Key="Report_PackageLend" DataBaseType="SqlServer">
		  select ap.Name   FPORGNAME,c.CARGOTYPENAME,aup.name PNAME,ISNULL(fp.Recipient,aul.Name) LNAME,fp.PROVIDEDATE,
		  fpl.QUANTITY,fplrd.RETURNQUANTITY,fplr.RETURNDATE,ISNULL(fplr.Recipient,aur.Name) RNAME,aurp.Name RPNAME
		  From FlowProvideLend fpl inner Join FlowProvide fp On fp.ProvideID = fpl.ProvideID
		  Inner Join CargoType c On fpl.CargoTypeID = c.CargoTypeID
		  Left join FlowProvideLendReturnDetail fplrd on fplrd.ProvideID=fp.ProvideID
		  left join FlowProvideLendReturn fplr on fplr.ProvideLendReturnID=fplrd.ProvideLendReturnID
		  left join AC_Org ap on ap.ID=fp.OrgID
		  left join AC_User aup on aup.ID=fp.OPID
		  left join AC_User aul on aul.ID=fp.RecipientID
		  left join AC_User aur on aur.ID=fplr.RecipientID
		  left join AC_User aurp on aurp.ID=fplr.OPID
		  Where 1=1 {0}
		  ORDER BY ProvideDate DESC
	  </Content>
    
    <Content Key="Report_PackageLend_ZDFY" DataBaseType="SqlServer">
      Select CONVERT(CHAR(10),fp.PROVIDEDATE,120) AS PROVIDEDATE,AP.Name As ORGNAME,c.CARGOTYPEKINDTEXT,c.CARGOTYPETEXT,
      fpl.QUANTITY,fpl.RETURNQUANTITY,(fpl.QUANTITY-fpl.RETURNQUANTITY) As ONQUANTITY,
      fp.RECIPIENT
      ,case when (fpl.Quantity-fpl.RETURNQUANTITY)>0
      then case when DATEDIFF(DAY,fp.PROVIDEDATE,getdate())>=2 then (DATEDIFF(DAY,fp.PROVIDEDATE,GETDATE())-1)*c.amount*(fpl.Quantity-fpl.RETURNQUANTITY)
      else c.amount*(fpl.Quantity-fpl.RETURNQUANTITY) end
      else
      c.amount*fpl.Quantity end
      as sumAmount
      From FlowProvideLend fpl
      Inner Join FlowProvide fp On fpl.ProvideID = fp.ProvideID
      left Join view_CargoType c On fpl.CargoTypeID = c.CargoTypeID
      Inner Join AC_Org AP On AP.ID=fp.OrgID
      Where 1=1 {0}
      ORDER BY ProvideDate DESC
    </Content>

	  <Content Key="Report_PackageLend" DataBaseType="Oracle">
		  select ap.Name   FPORGNAME,c.CARGOTYPENAME,aup.name PNAME,nvl(fp.Recipient,aul.Name) LNAME,fp.PROVIDEDATE,
		  fpl.QUANTITY,fplrd.RETURNQUANTITY,fplr.RETURNDATE,nvl(fplr.Recipient,aur.Name) RNAME,aurp.Name RPNAME
		  From FlowProvideLend fpl inner Join FlowProvide fp On fp.ProvideID = fpl.ProvideID
		  Inner Join CargoType c On fpl.CargoTypeID = c.CargoTypeID
		  Left join FlowProvideLendReturnDetail fplrd on fplrd.ProvideID=fp.ProvideID
		  left join FlowProvideLendReturn fplr on fplr.ProvideLendReturnID=fplrd.ProvideLendReturnID
		  left join AC_Org ap on ap.ID=fp.OrgID
		  left join AC_User aup on aup.ID=fp.OPID
		  left join AC_User aul on aul.ID=fp.RecipientID
		  left join AC_User aur on aur.ID=fplr.RecipientID
		  left join AC_User aurp on aurp.ID=fplr.OPID
		  Where 1=1 {0}
		  ORDER BY ProvideDate DESC
	  </Content>

    <Content Key="Query_WorkShareType" Desc="查询分摊工作类型" DataBaseType="SqlServer">
      select * from WorkShare ws
      inner join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      where ws.ShareTypt=@ShareTypt
    </Content>
    <Content Key="Query_WorkShareType" Desc="查询分摊工作类型" DataBaseType="Oracle">
      select * from WorkShare ws
      inner join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      where ws.ShareTypt=:ShareTypt
    </Content>
    <Content Key="Delete_WorkShareUserByShareType" Desc="删除分摊数据" DataBaseType="SqlServer">
      delete from WorkShare where ShareTypt=@ShareTypt
    </Content>
    <Content Key="Delete_WorkShareUserByShareType" Desc="删除分摊数据" DataBaseType="Oracle">
      delete from WorkShare where ShareTypt=:ShareTypt
    </Content>
    <Content Key="Delete_WorkShareUserByShareID" Desc="删除分摊人员明细" DataBaseType="SqlServer">
      delete from WorkShareUser where ShareID=@ShareID
    </Content>
    <Content Key="Delete_WorkShareUserByShareID" Desc="删除分摊人员明细" DataBaseType="Oracle">
      delete from WorkShareUser where ShareID=:ShareID
    </Content>
    
    <Content Key="Report_KMZYYUserWorkReport" Desc="昆明总医院工作量统计" DataBaseType="SqlServer">
      <![CDATA[
      select 'A.回收(数量)'  WORKTYPE,au.Name  USERNAME,t.CargoTypeName  INFONAME,
      d.QUANTITY/u.FNumber QUANTITY,
      w.WarehouseName  INFO1,d.Barcode  INFO2,d.QUANTITY*t.InstrumentsNumber INSTRUMENTSNUMBER
      from FlowRecycle  a   inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join CargoType  t   on d.CargoTypeid = t.CargoTypeid
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID 
      where a.RecycleDate between  @begindate  and  @enddate and a.FlowOrgID=@floworgid
      union all
      select 'B.清洗(数量)'  WORKTYPE,ou.FNames  USERNAME,d.DEVICENAME  INFONAME,
      SUM(1)/ou.FNumber QUANTITY,
      cast(dul.todayusetimes as nvarchar)  INFO1,cast(dul.isok as nvarchar)  INFO2 ,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect fd
      inner join DevicesUseLog dul on fd. LogID = dul.Logid
      inner join Devices d  on dul.DeviceID = d.deviceid
      inner join AC_WorkGroup ou  on dul.UserID= ou.FID
      inner join SystemTypeParameter tp  on ( dul.isok = tp.TypeValue and tp.TypeKey = 'ContainerStatus')
      left join DeviceProcessRule prule  on dul.DeviceProcessRuleID = prule.RuleID
      inner join FlowDisinfectContainerList fcl on fd.FDisinfectID=fcl.FDisinfectID
      left join FlowRecycleList ON fcl.FRecycleID=FlowRecycleList.FRecycleID
      left join FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      where dul.BeginDate between @begindate  and  @enddate  and fd.FlowOrgID=@floworgid 
      group by ou.FNames,ou.FNumber,d.DEVICENAME,dul.todayusetimes
      ,dul.isok
      union all
      select 'C.配包(数量)'  WorkType,isnull(au.Name,wu.FNames) UserName,c.CargoTypeName  InfoName,
      isnull(1/u.FNumber,case when fpi.subPackageQty>0 then fpi.subPackageQty else 1 end) QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      left join FlowPackageIn fpi on a.FPackageID=fpi.FPackageID and fpi.packagerID is not null
      left join AC_WorkGroup wu on fpi.packagerID=wu.FID
      left join CargoType c   on b.CargoTypeID=c.CargoTypeID
      left join FlowPackage d on a.FPackageID = d.FPackageID
      left join AC_WorkGroup u   on d.OPID=u.FID
      left join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      left join AC_User au on uw.FUserID=au.ID
      where d.PackageDate between @begindate  and  @enddate  and istemp = @istempkind  and a.FlowOrgID=@floworgid
      or fpi.PackageInDate between @begindate and @enddate 
      union all
      select 'D.配包审核(数量)'  WorkType,isnull(au.Name,wu.FNames) USERNAME,c.CargoTypeName  InfoName,
      isnull(1/u.FNumber,case when fpi.subPackageQty>0 then fpi.subPackageQty else 1 end) QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      left join FlowPackageIn fpi on a.FPackageID=fpi.FPackageID and fpi.packagerID is not null
      left join AC_WorkGroup wu on fpi.packagerID=wu.FID
      left join CargoType c   on b.CargoTypeID=c.CargoTypeID
      left join FlowPackage d on a.FPackageID = d.FPackageID
      left join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      left join AC_User au on uw.FUserID=au.ID
      where d.PackageDate between @begindate  and  @enddate  and istemp = @istempkind  and a.FlowOrgID=@floworgid
      or fpi.PackageInDate between @begindate and @enddate 
      union all
      select 'E.灭菌(数量)'  WORKTYPE,au.Name  USERNAME,e.DeviceName  INFONAME,
      1/u.FNumber QUANTITY,
      cast(c.TodayUseTimes as nvarchar)  INFO1,''  INFO2 ,1*1 INSTRUMENTSNUMBER
      from  FlowSterilizationList a   inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      where c.BeginDate between @begindate  and @enddate and b.FlowOrgID=@floworgid
      union all
      select 'F.发放(数量)'  WORKTYPE,au.Name  USERNAME,e.CARGOTYPENAME  INFONAME,
      1/u.FNumber QUANTITY,
      g.NAME  INFO1,''  INFO2,1*1 INSTRUMENTSNUMBER
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      where a.ProvideDate between @begindate  and @enddate and a.FlowOrgID=@floworgid
      ]]>
    </Content>
    <Content Key="Report_KMZYYUserWorkReport" Desc="昆明总医院工作量统计" DataBaseType="Oracle">
      <![CDATA[
       select 'A.回收(数量)'  WORKTYPE,au.Name  USERNAME,t.CargoTypeName  INFONAME,
      d.QUANTITY/u.FNumber QUANTITY,
      w.WarehouseName  INFO1,d.Barcode  INFO2,d.QUANTITY*t.InstrumentsNumber INSTRUMENTSNUMBER
      from FlowRecycle  a   inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join CargoType  t   on d.CargoTypeid = t.CargoTypeid
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID 
      where a.RecycleDate between  :begindate  and  :enddate and a.FlowOrgID=:floworgid
      union all
      select 'B.清洗(数量)'  WORKTYPE,ou.FNames  USERNAME,d.DEVICENAME  INFONAME,
      SUM(1)/ou.FNumber QUANTITY,
      cast(dul.todayusetimes as nvarchar)  INFO1,cast(dul.isok as nvarchar)  INFO2 ,1*1 INSTRUMENTSNUMBER
      from FlowDisinfect fd
      inner join DevicesUseLog dul on fd. LogID = dul.Logid
      inner join Devices d  on dul.DeviceID = d.deviceid
      inner join AC_WorkGroup ou  on dul.UserID= ou.FID
      inner join SystemTypeParameter tp  on ( dul.isok = tp.TypeValue and tp.TypeKey = 'ContainerStatus')
      left join DeviceProcessRule prule  on dul.DeviceProcessRuleID = prule.RuleID
      inner join FlowDisinfectContainerList fcl on fd.FDisinfectID=fcl.FDisinfectID
      left join FlowRecycleList ON fcl.FRecycleID=FlowRecycleList.FRecycleID
      left join FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      where dul.BeginDate between :begindate  and  :enddate  and fd.FlowOrgID=:floworgid 
      group by ou.FNames,ou.FNumber,d.DEVICENAME,dul.todayusetimes
      ,dul.isok
      union all
      select 'C.配包(数量)'  WorkType,nvl(au.Name,wu.FNames) UserName,c.CargoTypeName  InfoName,
      nvl(1/u.FNumber,case when fpi.subPackageQty>0 then fpi.subPackageQty else 1 end) QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      left join FlowPackageIn fpi on a.FPackageID=fpi.FPackageID and fpi.packagerID is not null
      left join AC_WorkGroup wu on fpi.packagerID=wu.FID
      left join CargoType c   on b.CargoTypeID=c.CargoTypeID
      left join FlowPackage d on a.FPackageID = d.FPackageID
      left join AC_WorkGroup u   on d.OPID=u.FID
      left join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      left join AC_User au on uw.FUserID=au.ID
      where d.PackageDate between :begindate  and  :enddate  and istemp = :istempkind  and a.FlowOrgID=:floworgid
      or fpi.PackageInDate between :begindate and :enddate 
      union all
      select 'D.配包审核(数量)'  WorkType,nvl(au.Name,wu.FNames) USERNAME,c.CargoTypeName  InfoName,
      nvl(1/u.FNumber,case when fpi.subPackageQty>0 then fpi.subPackageQty else 1 end) QUANTITY,
      cast(b.barcode as nvarchar)  Info1,cast(expdate as nvarchar)  Info2,1*1 INSTRUMENTSNUMBER
      from FlowPackageList a  inner join StorageList b   on a.StorageID=b.StorageID
      left join FlowPackageIn fpi on a.FPackageID=fpi.FPackageID and fpi.packagerID is not null
      left join AC_WorkGroup wu on fpi.packagerID=wu.FID
      left join CargoType c   on b.CargoTypeID=c.CargoTypeID
      left join FlowPackage d on a.FPackageID = d.FPackageID
      left join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      left join AC_User au on uw.FUserID=au.ID
      where d.PackageDate between :begindate  and  :enddate  and istemp = :istempkind  and a.FlowOrgID=:floworgid
      or fpi.PackageInDate between :begindate and :enddate 
      union all
      select 'E.灭菌(数量)'  WORKTYPE,au.Name  USERNAME,e.DeviceName  INFONAME,
      1/u.FNumber QUANTITY,
      cast(c.TodayUseTimes as nvarchar)  INFO1,''  INFO2 ,1*1 INSTRUMENTSNUMBER
      from  FlowSterilizationList a   inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      where c.BeginDate between :begindate  and :enddate and b.FlowOrgID=:floworgid
      union all
      select 'F.发放(数量)'  WORKTYPE,au.Name  USERNAME,e.CARGOTYPENAME  INFONAME,
      1/u.FNumber QUANTITY,
      g.NAME  INFO1,''  INFO2,1*1 INSTRUMENTSNUMBER
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      where a.ProvideDate between :begindate and :enddate and a.FlowOrgID=:floworgid
      ]]>
    </Content>

    <Content Key="Report_RecycleBadReason" Desc="不良情况统计" DataBaseType="SqlServer">
      select bci.CargoTypeID,cc.CargoTypeName as CARGOTYPENAMES
      ,sl.Barcode as BARCODE,c.CargoTypeName as CARGOTYPENAME,
      wg.FNames as FNAMES,u.UseDate as USEDATE,pa.PatientName as PATIENTNAME,
      bciL.BadReason as BADREASON,ad.FCaption as FCAPTION
      ,bciL.Quantity as QUANTITY,rwg.FNames as RFNAME,oo.Name as ORGNAME
      from RecycleBadCheckIn  bci
      inner join FlowPackageList fl  on bci.PackageID=fl.PackageID
      left join FlowRecycleList frl on fl.PackageID=frl.PackageID
      Left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      left join AC_WorkGroup rwg on fr.OPID=rwg.FID
      inner join AC_Org o on fl.FlowOrgID=o.ID
      left join StorageList sl   on fl.StorageID=sl.StorageID
      inner join CargoType c on sl.CargoTypeID=c.CargoTypeID
      inner join CargoType cc on bci.CargoTypeID=cc.CargoTypeID
      inner join RecycleBadCheckInList bciL on bci.RecycleBadCheckInID=bciL.RecycleBadCheckInID
      inner join AssistData ad on bciL.BadReason=ad.FID
      left join FlowUseList ul on sl.StorageID=ul.StorageID
      left join FlowUse u on ul.UseID=u.UseID
      left join PatientList pa on u.PatientID=pa.PatientID
      left join AC_WorkGroup wg on u.OPID=wg.FID
      left join FlowProvideList fpl on fpl.PackageID=fl.PackageID
      left join FlowProvide fp on fp.ProvideID=fpl.ProvideID
      left join AC_Org oo on fp.OrgID=oo.ID
      where 1=1 {0}
    </Content>
    <Content Key="Report_RecycleBadReason" Desc="不良情况统计" DataBaseType="Oracle">
      select bci.CargoTypeID,cc.CargoTypeName as CARGOTYPENAMES
      ,sl.Barcode as BARCODE,c.CargoTypeName as CARGOTYPENAME,
      wg.FNames as FNAMES,u.UseDate as USEDATE,pa.PatientName as PATIENTNAME,
      bciL.BadReason as BADREASON,ad.FCaption as FCAPTION
      ,bciL.Quantity as QUANTITY,rwg.FNames as RFNAME,oo.Name as ORGNAME
      from RecycleBadCheckIn  bci
      inner join FlowPackageList fl  on bci.PackageID=fl.PackageID
      left join FlowRecycleList frl on fl.PackageID=frl.PackageID
      Left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      left join AC_WorkGroup rwg on fr.OPID=rwg.FID
      inner join AC_Org o on fl.FlowOrgID=o.ID
      left join StorageList sl   on fl.StorageID=sl.StorageID
      inner join CargoType c on sl.CargoTypeID=c.CargoTypeID
      inner join CargoType cc on bci.CargoTypeID=cc.CargoTypeID
      inner join RecycleBadCheckInList bciL on bci.RecycleBadCheckInID=bciL.RecycleBadCheckInID
      inner join AssistData ad on bciL.BadReason=ad.FID
      left join FlowUseList ul on sl.StorageID=ul.StorageID
      left join FlowUse u on ul.UseID=u.UseID
      left join PatientList pa on u.PatientID=pa.PatientID
      left join AC_WorkGroup wg on u.OPID=wg.FID
      left join FlowProvideList fpl on fpl.PackageID=fl.PackageID
      left join FlowProvide fp on fp.ProvideID=fpl.ProvideID
      left join AC_Org oo on fp.OrgID=oo.ID
      where 1=1 {0}
    </Content>
    <Content Key="Report_PackageInDisinfectSummary" Desc="外来包消毒费用统计" DataBaseType="SqlServer">
      <![CDATA[
        SELECT  T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
        T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
        T1.RETURNMEMO,O.NAME AS ORGNAME,U.FNames AS OPNAME,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
        ,T5.OPID,T6.FNames FRECYCLER
        ,T7.CARGOTYPENAME
        ,T14.FNames FSTERILIZER
        ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
        ,T10.BEGINDATE FSTERILIZEDATE
        ,T15.FNames FSCHECKER
        ,T16.TYPENAME FSTERILIZERESULT
        ,CASE ISNULL(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END FSTERILIZETYPE
        ,T12.OPID FPROVIDEID,T17.FNames FPROVIDER,T12.PROVIDEDATE,T12.ORGID FPROVIDERORGID,T18.NAME FPROVIDERORG
        ,D.DEVICENAME,FR.OPID ,AWR.FNAMES FRECYCLER,awp.FNames FPACKAGER,awC.FNames FCHECKER,T1.FPACKAGENAME
        ,BTP.TypeName as IsBPCDOK
        ,T1.FPatient
        ,T1.InDisinfectPrice as INDISINFECTPRICE,org.Name as PROVIDENAME,T3.Barcode as INBARCODE
        ,case when T2.SubPackageQty>0 then T2.SubPackageQty else 1 end as SUBPACKAGEQTY
        ,COUNT(1) as QUANTITY
        ,ISNULL(case when T1.IsChecked=1 then '已缴费' else '未缴费' end ,0) as ISCHECKEDS
        ,T1.PackageInCode as PACKAGEINCODE
        FROM FLOWPACKAGEIN T1
        INNER JOIN FLOWPACKAGELIST T2 ON T2.FPACKAGEID=T1.FPACKAGEID
        LEFT JOIN FlowProvideList fpl on T2.PackageID=fpl.PackageID
        LEFT JOIN FlowProvide fp on fpl.ProvideID=fp.ProvideID
        LEFT JOIN AC_Org org on fp.OrgID=org.ID
        LEFT JOIN STORAGELIST T3 ON T3.STORAGEID=T2.STORAGEID
        LEFT JOIN FLOWRECYCLELIST T4 ON T4.PACKAGEID=T2.PACKAGEID
        LEFT JOIN FLOWRECYCLE T5 ON T5.FRECYCLEID=T4.FRECYCLEID
        LEFT JOIN AC_WorkGroup T6 ON T6.FID=T5.OPID
        LEFT JOIN CARGOTYPE T7 ON T7.CARGOTYPEID=T1.CARGOTYPEID
        LEFT JOIN FLOWSTERILIZATIONLIST T9 ON T9.PACKAGEID=T2.PACKAGEID
        LEFT JOIN DEVICESUSELOG T10 ON T10.LOGID=T9.STERILIZATIONLOGID
        LEFT JOIN FLOWPROVIDELIST T11 ON T11.PACKAGEID=T2.PACKAGEID
        LEFT JOIN FLOWPROVIDE T12 ON T12.PROVIDEID=T11.PROVIDEID
        LEFT JOIN AC_WorkGroup T14 ON T14.FID=T10.USERID
        LEFT JOIN AC_WorkGroup T15 ON T15.FID=T10.CHECKID
        LEFT JOIN (SELECT TYPEVALUE,TYPENAME FROM SYSTEMTYPEPARAMETER WHERE TYPEKEY='QualifiedNO') T16 ON T16.TYPEVALUE=T2.BADFLAG
        LEFT JOIN AC_WorkGroup T17 ON T17.FID=T12.OPID
        LEFT JOIN AC_ORG T18 ON T18.ID=T12.ORGID
        LEFT JOIN AC_ORG O ON T1.SENDER = O.ID
        INNER JOIN AC_WorkGroup U ON T1.OPID = U.FID
        Left join Devices d on d.DeviceID=t10.DeviceID
        left join FlowRecycleList frl on frl.PackageID =t2.PackageID
        left join FlowRecycle fr on fr.FRecycleID=frl.FRecycleID
        left join AC_WorkGroup awR on awr.FID=fr.OPID
        left join AC_WorkGroup awP on awp.FID=t1.packagerID
        left join AC_WorkGroup awC on awc.FID=t2.CheckID
        LEFT JOIN SYSTEMTYPEPARAMETER BTP ON ( T10.IsBPCDOK =  BTP.TYPEVALUE AND BTP.TYPEKEY = 'IsOK')
        WHERE 1=1 and t7.IsOEM<>1 and ISNULL(T1.IsDisabled,0)<>1 {0}
        GROUP by T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
        T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
        T1.RETURNMEMO,O.NAME  ,U.FNames ,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
        ,T5.OPID,T6.FNames
        ,T7.CARGOTYPENAME
        ,T14.FNames
        ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
        ,T10.BEGINDATE
        ,T15.FNames
        ,T16.TYPENAME
        ,CASE ISNULL(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END
        ,T12.OPID  ,T17.FNames ,T12.PROVIDEDATE,T12.ORGID  ,T18.NAME
        ,D.DEVICENAME,FR.OPID ,AWR.FNAMES  ,awp.FNames  ,awC.FNames  ,T1.FPACKAGENAME
        ,BTP.TypeName
        ,T1.FPatient,T1.InDisinfectPrice,org.Name,T3.Barcode
        ,T2.SubPackageQty
        ,T1.IsChecked
        ,T1.PackageInCode
        ORDER BY T1.PACKAGEINDATE DESC
      ]]>
    </Content>
    <Content Key="Report_PackageInDisinfectSummary" Desc="外来包消毒费用统计" DataBaseType="Oracle">
      <![CDATA[
        SELECT  T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
        T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
        T1.RETURNMEMO,O.NAME AS ORGNAME,U.FNames AS OPNAME,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
        ,T5.OPID,T6.FNames FRECYCLER
        ,T7.CARGOTYPENAME
        ,T14.FNames FSTERILIZER
        ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
        ,T10.BEGINDATE FSTERILIZEDATE
        ,T15.FNames FSCHECKER
        ,T16.TYPENAME FSTERILIZERESULT
        ,CASE nvl(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END FSTERILIZETYPE
        ,T12.OPID FPROVIDEID,T17.FNames FPROVIDER,T12.PROVIDEDATE,T12.ORGID FPROVIDERORGID,T18.NAME FPROVIDERORG
        ,D.DEVICENAME,FR.OPID ,AWR.FNAMES FRECYCLER,awp.FNames FPACKAGER,awC.FNames FCHECKER,T1.FPACKAGENAME
        ,BTP.TypeName as IsBPCDOK
        ,T1.FPatient
        ,T1.InDisinfectPrice as INDISINFECTPRICE,org.Name as PROVIDENAME,T3.Barcode as INBARCODE
        ,case when T2.SubPackageQty>0 then T2.SubPackageQty else 1 end as SUBPACKAGEQTY
        ,COUNT(1) as QUANTITY
        ,nvl(case when T1.IsChecked=1 then '已缴费' else '未缴费' end ,0) as ISCHECKEDS
        ,T1.PackageInCode as PACKAGEINCODE
        FROM FLOWPACKAGEIN T1
        INNER JOIN FLOWPACKAGELIST T2 ON T2.FPACKAGEID=T1.FPACKAGEID
        LEFT JOIN FlowProvideList fpl on T2.PackageID=fpl.PackageID
        LEFT JOIN FlowProvide fp on fpl.ProvideID=fp.ProvideID
        LEFT JOIN AC_Org org on fp.OrgID=org.ID
        LEFT JOIN STORAGELIST T3 ON T3.STORAGEID=T2.STORAGEID
        LEFT JOIN FLOWRECYCLELIST T4 ON T4.PACKAGEID=T2.PACKAGEID
        LEFT JOIN FLOWRECYCLE T5 ON T5.FRECYCLEID=T4.FRECYCLEID
        LEFT JOIN AC_WorkGroup T6 ON T6.FID=T5.OPID
        LEFT JOIN CARGOTYPE T7 ON T7.CARGOTYPEID=T1.CARGOTYPEID
        LEFT JOIN FLOWSTERILIZATIONLIST T9 ON T9.PACKAGEID=T2.PACKAGEID
        LEFT JOIN DEVICESUSELOG T10 ON T10.LOGID=T9.STERILIZATIONLOGID
        LEFT JOIN FLOWPROVIDELIST T11 ON T11.PACKAGEID=T2.PACKAGEID
        LEFT JOIN FLOWPROVIDE T12 ON T12.PROVIDEID=T11.PROVIDEID
        LEFT JOIN AC_WorkGroup T14 ON T14.FID=T10.USERID
        LEFT JOIN AC_WorkGroup T15 ON T15.FID=T10.CHECKID
        LEFT JOIN (SELECT TYPEVALUE,TYPENAME FROM SYSTEMTYPEPARAMETER WHERE TYPEKEY='QualifiedNO') T16 ON T16.TYPEVALUE=T2.BADFLAG
        LEFT JOIN AC_WorkGroup T17 ON T17.FID=T12.OPID
        LEFT JOIN AC_ORG T18 ON T18.ID=T12.ORGID
        LEFT JOIN AC_ORG O ON T1.SENDER = O.ID
        INNER JOIN AC_WorkGroup U ON T1.OPID = U.FID
        Left join Devices d on d.DeviceID=t10.DeviceID
        left join FlowRecycleList frl on frl.PackageID =t2.PackageID
        left join FlowRecycle fr on fr.FRecycleID=frl.FRecycleID
        left join AC_WorkGroup awR on awr.FID=fr.OPID
        left join AC_WorkGroup awP on awp.FID=t1.packagerID
        left join AC_WorkGroup awC on awc.FID=t2.CheckID
        LEFT JOIN SYSTEMTYPEPARAMETER BTP ON ( T10.IsBPCDOK =  BTP.TYPEVALUE AND BTP.TYPEKEY = 'IsOK')
        WHERE 1=1 and t7.IsOEM<>1 and ISNULL(T1.IsDisabled,0)<>1 {0}
        GROUP by T1.FPACKAGEID,T1.PACKAGEINDATE,T1.OPID,T1.SENDER,T1.BARCODE,T1.MEMO,T1.CARGOTOPTYPE,T1.CARGOTYPEID,
        T1.FLOWORGID,T1.FLOWTYPE,T1.SENDTEXT,T1.RETURNDATE,T1.RETURNOPID,T1.RETURNRECEIVERID,
        T1.RETURNMEMO,O.NAME  ,U.FNames ,T1.RETURNRECEIVER,T1.FPATIENT,T1.FDOCTOR,T1.FSURGERYPART,T1.FSURGERYROOM,T1.FMEASUREMENTS,T1.FINPATIENTAREA,T1.FBEDNO,T1.FHOSPITALIZEDNO
        ,T5.OPID,T6.FNames
        ,T7.CARGOTYPENAME
        ,T14.FNames
        ,T10.TODAYUSETIMES,T10.CHECKDATE,T10.CHECKID
        ,T10.BEGINDATE
        ,T15.FNames
        ,T16.TYPENAME
        ,CASE nvl(FSTERILIZETYPE,0) WHEN 4 THEN '压力蒸汽灭菌' WHEN 5 THEN '等离子灭菌' WHEN 6 THEN '环氧乙烷灭菌' ELSE '' END
        ,T12.OPID  ,T17.FNames ,T12.PROVIDEDATE,T12.ORGID  ,T18.NAME
        ,D.DEVICENAME,FR.OPID ,AWR.FNAMES  ,awp.FNames  ,awC.FNames  ,T1.FPACKAGENAME
        ,BTP.TypeName
        ,T1.FPatient,T1.InDisinfectPrice,org.Name,T3.Barcode
        ,T2.SubPackageQty
        ,T1.IsChecked
        ,T1.PackageInCode
        ORDER BY T1.PACKAGEINDATE DESC
      ]]>
    </Content>
    <Content Key="Report_WorkShareDataSourceReport" Desc="湖北工作量报表" DataBaseType="SqlServer">
      <![CDATA[
      select 'A.手预交接'  WORKTYPE,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity
      ,t.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from FlowRecycleFetch  a   
      inner join FlowRecycleFetchList b   on a.FRecycleFetchID=b.FRecycleFetchID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join CargoType  t  on d.CargoTypeid = t.CargoTypeid
      left join PackageCostLevel pcl on t.FLevel=pcl.FID
      inner join CargoTypeKind ctk on t.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='RecycleHandover')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID 
      where 1=1 and a.RecycleDate between  @begindate  and  @enddate 
      and a.FlowOrgID=@floworgid 
      and a.FetchType='0'
      and (ws.ShareTypt='RecycleFetchHandover' or ws.ShareTypt is null)
      group by au.Name,ws.ShareNumber,t.CargoTypeName,ShareName,ws.FlowOrgID
      ,w.WarehouseName,ws.ShareID,uu.Name,ws.ShareTypt,pcl.FFactor,t.CargoTypeName
      union all
      select 'B.回收交接'  WORKTYPE,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity
      ,t.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from FlowRecycleFetch  a   
      inner join FlowRecycleFetchList b   on a.FRecycleFetchID=b.FRecycleFetchID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join CargoType  t  on d.CargoTypeid = t.CargoTypeid
      left join PackageCostLevel pcl on t.FLevel=pcl.FID
      inner join CargoTypeKind ctk on t.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='RecycleHandover')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID 
      where 1=1 and a.RecycleDate between  @begindate  and  @enddate 
      and a.FlowOrgID=@floworgid 
      and (ws.ShareTypt='RecycleHandover' or ws.ShareTypt is null)
      group by au.Name,ws.ShareNumber,t.CargoTypeName,ShareName,ws.FlowOrgID
      ,w.WarehouseName,ws.ShareID,uu.Name,ws.ShareTypt,pcl.FFactor,t.CargoTypeName
      union all
      select 'C.回收包'  WORKTYPE,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity
      ,t.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from FlowRecycle  a   
      inner join FlowRecycleList b   on a.FRecycleID=b.FRecycleID
      inner join FlowPackageList c  on b.PackageID=c.PackageID
      left join StorageList d   on c.StorageID=d.StorageID
      inner join AC_WorkGroup u   on a.opid = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join CargoType  t  on d.CargoTypeid = t.CargoTypeid
      left join PackageCostLevel pcl on t.FLevel=pcl.FID
      inner join CargoTypeKind ctk on t.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='Recycle')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      left join Warehouse  w   on c.lastwarehouseid = w.WarehouseID 
      where a.RecycleDate between  @begindate  and  @enddate 
      and a.FlowOrgID=@floworgid 
      and (ws.ShareTypt='Recycle' or ws.ShareTypt is null)
      group by au.Name,ws.ShareNumber,t.CargoTypeName,ShareName,ws.FlowOrgID
      ,w.WarehouseName,ws.ShareID,uu.Name,ws.ShareTypt,pcl.FFactor,t.CargoTypeName
      union all
      select 'D.清洗包'  WORKTYPE,case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity
      ,t.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from 
      DevicesUseLog du with (nolock)
      INNER JOIN Devices dv with (nolock)  ON dv.DeviceID =du.DeviceID
      INNER JOIN AC_WorkGroup u with (nolock) ON du.UserID = u.FID
      INNER JOIN AC_UserWorkGroup WG  ON u.FID = WG.FGroupID
      INNER JOIN AC_User AU  ON WG.FUserID = AU.ID
      LEFT JOIN DeviceProcessRule prule  on du.DeviceProcessRuleID = prule.RuleID
      LEFT JOIN FlowDisinfect fd on  du.Logid=fd.LogID
      LEFT JOIN (select distinct FRecycleID,FDisinfectID   from FLOWDISINFECTCONTAINERLIST)  d on fd.FDisinfectID=d.FDisinfectID
      LEFT JOIN FlowRecycle ON d.FRecycleID = FlowRecycle.FRecycleID
      LEFT JOIN FlowRecycleList ON d.FRecycleID = FlowRecycleList.FRecycleID
      LEFT JOIN FlowPackageList fpl ON FlowRecycleList.PackageID = fpl.PackageID
      LEFT JOIN StorageList sl ON fpl.StorageID = sl.StorageID
      inner join CargoType t on sl.CargoTypeID=t.CargoTypeID
      left join PackageCostLevel pcl on t.FLevel=pcl.FID
      inner join CargoTypeKind ctk on t.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='Disinfect')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      left join Warehouse  w   on fpl.lastwarehouseid = w.WarehouseID 
      where du.BeginDate between @begindate  and  @enddate 
      and fd.FlowOrgID=@floworgid
      and (ws.ShareTypt='Disinfect' or ws.ShareTypt is null)
      group by au.Name,ws.ShareNumber,t.CargoTypeName,ShareName,ws.FlowOrgID
      ,w.WarehouseName,ws.ShareID,uu.Name,ws.ShareTypt,pcl.FFactor,t.CargoTypeName
      ,dv.DEVICENAME,u.FNumber,du.todayusetimes,du.isok
      union all
      select 'E.配包'  WorkType,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity,
      c.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,cast(b.barcode as nvarchar)  Info1
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from FlowPackageList a  
      inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      left join PackageCostLevel pcl on c.FLevel=pcl.FID
      left join CargoTypeKind ctk on c.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='Package')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      inner join FlowPackage d on a.FPackageID = d.FPackageID
      inner join AC_WorkGroup u   on d.OPID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      left join Warehouse  w   on a.lastwarehouseid = w.WarehouseID 
      where d.PackageDate between @begindate  and  @enddate  
      and istemp = @istempkind  and a.FlowOrgID=@floworgid 
      and (ws.ShareTypt='Package' or ws.ShareTypt is null)
      group by ws.ShareNumber,c.CargoTypeName,uu.Name,au.Name,ws.ShareTypt
      ,pcl.FFactor,b.barcode,ws.ShareTypt
      union all
      select 'F.配包审核'  WorkType,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity,
      c.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,cast(b.barcode as nvarchar)  Info1
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from FlowPackageList a  
      inner join StorageList b   on a.StorageID=b.StorageID
      inner join CargoType c   on b.CargoTypeID=c.CargoTypeID
      left join PackageCostLevel pcl on c.FLevel=pcl.FID
      inner join CargoTypeKind ctk on c.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='PackageCheck')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      inner join FlowPackage d on a.FPackageID = d.FPackageID
      inner join AC_WorkGroup u   on a.CheckID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      left join Warehouse  w  on a.lastwarehouseid = w.WarehouseID 
      where a.CheckDate between @begindate  and  @enddate  
      and istemp = @istempkind  and a.FlowOrgID=@floworgid 
      and (ws.ShareTypt='PackageCheck' or ws.ShareTypt is null)
      group by ws.ShareNumber,c.CargoTypeName,uu.Name,au.Name,ws.ShareTypt
      ,pcl.FFactor,b.barcode
      union all
      select 'G.灭菌'  WORKTYPE,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity,
      ct.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from  FlowSterilizationList a   
      inner join  FlowPackageList b   on a.PackageID=b.PackageID
      inner join StorageList sl   on b.StorageID=sl.StorageID
      inner join CargoType ct   on sl.CargoTypeID=ct.CargoTypeID
      left join PackageCostLevel pcl on ct.FLevel=pcl.FID
      inner join CargoTypeKind ctk on ct.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='Sterilization')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      inner join  DevicesUseLog c   on a.SterilizationLogID=c.LogID
      inner join  AC_WorkGroup u   on c.UserID=u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      inner join  Devices  e   on c.DeviceID=e.DeviceID
      left join Warehouse  w  on b.lastwarehouseid = w.WarehouseID 
      where c.BeginDate between @begindate  and  @enddate 
      and b.FlowOrgID=@floworgid 
      and (ws.ShareTypt='Sterilization' or ws.ShareTypt is null)
      group by ws.ShareNumber,ct.CargoTypeName,uu.Name,au.Name,ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor
      union all
      select 'H.发放'  WORKTYPE,
      case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as Quantity,
      e.CargoTypeName,case when uu.Name is null then au.Name else uu.Name end as Name,
      ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor*case when ws.ShareNumber is not null then CONVERT(float,COUNT(*))/ws.ShareNumber else COUNT(*)/1 end as QuZhi
      from FlowProvide  a inner join FlowProvideList  b   on a.ProvideID=b.ProvideID
      inner join FlowPackageList  c   on b.PackageID=c.PackageID
      inner join  StorageList  d   on c.StorageID=d.StorageID
      inner join CargoType  e   on d.CargoTypeID=e.CargoTypeID
      left join PackageCostLevel pcl on e.FLevel=pcl.FID
      inner join CargoTypeKind ctk on e.CargoTypeKind=ctk.ID
      left join WorkShare ws on (ctk.ID=ws.CargoTypeKindID and ws.ShareTypt='Provide')
      left join WorkShareUser wsu on ws.ShareID=wsu.ShareID
      left join AC_User uu on wsu.ShareUserID=uu.ID
      inner join AC_OrgUser  f   on a.OPID=f.UserID
      inner join AC_Org  g   on f.OrgID=g.ID
      inner join AC_WorkGroup  u   on a.OPID = u.FID
      inner join AC_UserWorkGroup uw on u.FID=uw.FGroupID
      inner join AC_User au on uw.FUserID=au.ID
      left join Warehouse  w  on c.lastwarehouseid = w.WarehouseID 
      where a.ProvideDate between @begindate  and  @enddate 
      and a.FlowOrgID=@floworgid 
      and (ws.ShareTypt='Provide' or ws.ShareTypt is null)
      group by ws.ShareNumber,e.CargoTypeName,uu.Name,au.Name,ws.ShareTypt,w.WarehouseName
      ,pcl.FFactor
      ]]>
    </Content>
    <Content Key="Report_ProvidePackageOneGoonsDataSourceReport" Desc="包与一次性物品发放统计" DataBaseType="SqlServer">
      select
      '包' as CargoType,
      orgs.Name as OrgNames,
      org.Name as OrgName,
      fp.ProvideDate as DataTime,
      ct.CargoTypeName as CargotypeName,
      isnull(ct.Amount,0.0000) as Amount,
      count(1) as Quantity,
      isnull(ct.Amount,0.0000) * count(FlowProvideList.PackageID) AS SumQuantity
      from FlowProvideList
      inner join FlowProvide fp on fp.ProvideID = FlowProvideList.ProvideID
      inner join FlowPackageList fpl  on FlowProvideList.PackageID = fpl.PackageID
      left join AC_ORG org on fp.OrgID = org.ID
      left join AC_Org orgs on org.PrevID=orgs.ID
      left join CargoType ct on fpl.CargoTypeID = ct.CargoTypeID
      where 1=1 {0}
      group by
      orgs.Name,
      org.Name,
      ct.CargoTypeName,
      fp.ProvideDate,
      ct.Amount
      union all
      select '一次性物品' as CargoType,
      orgs.Name OrgNames,
      ao.Name OrgName,so.OutDate DataTime,ct.CargoTypeName as CargotypeName
      ,isnull(ct.amount,0.0000) as Amount,sol.Quantity as Quantity,
      isnull(ct.amount*sol.Quantity,0.0000) as SumQuantity
      FROM StorageOut so
      inner join AC_Org ao ON ao.ID=so.OrgID
      left join AC_Org orgs on ao.PrevID=orgs.ID
      inner join AC_WorkGroup au ON au.FID=so.OPID
      left join AC_WorkGroup ac on ac.FID = so.RecipientID
      inner join  StorageOutList sol on SO.OutID=sol.OutID
      inner join CargoType ct on ct.CargoTypeID=sol.CargoTypeID
      where so.OutType=6 {1}
    </Content>
    <Content Key="Report_ProvidePackageOneGoonsDataSourceReport" Desc="包与一次性物品发放统计" DataBaseType="Oracle">
      select
      '包' as CargoType,org.Name as OrgName,
      fp.ProvideDate as DataTime,
      ct.CargoTypeName as CargotypeName,
      nvl(ct.Amount,0.0000) as Amount,
      count(1) as Quantity,
      nvl(ct.Amount,0.0000) * count(FlowProvideList.PackageID) AS SumQuantity
      from FlowProvideList
      inner join FlowProvide fp on fp.ProvideID = FlowProvideList.ProvideID
      inner join FlowPackageList fpl  on FlowProvideList.PackageID = fpl.PackageID
      left join AC_ORG org on fp.OrgID = org.ID
      left join CargoType ct on fpl.CargoTypeID = ct.CargoTypeID
      where 1=1 {0}
      group by
      org.Name,
      ct.CargoTypeName,
      fp.ProvideDate,
      ct.Amount
      union all
      select '一次性物品' as CargoType,ao.Name OrgName,so.OutDate DataTime,ct.CargoTypeName as CargotypeName
      ,nvl(ct.amount,0.0000) as Amount,sol.Quantity as Quantity,
      nvl(ct.amount*sol.Quantity,0.0000) as SumQuantity
      FROM StorageOut so
      inner join AC_Org ao ON ao.ID=so.OrgID
      inner join AC_WorkGroup au ON au.FID=so.OPID
      left join AC_WorkGroup ac on ac.FID = so.RecipientID
      inner join  StorageOutList sol on SO.OutID=sol.OutID
      inner join CargoType ct on ct.CargoTypeID=sol.CargoTypeID
      where so.OutType=6 {1}
    </Content>
    <Content Key="Report_StorageDataSource" Desc="一次性物品库存统计" DataBaseType="SqlServer">
      <![CDATA[
    WITH ProvideMaterials(CargoTypeID,StockQty,WarehouseName,PreOrderQty,ProvideQty)
      AS
      ( --1

      SELECT 
      Stock.CargoTypeID
      ,Stock.StockQty
      ,Stock.WarehouseName
      ,PreOrder.PreOrderQty
      ,PreOrder.ProvidedQty
      FROM
      (
      SELECT
      StorageList.CargoTypeID
      ,ISNULL(SUM(StorageList.Quantity),0) AS StockQty
      ,w.WarehouseName
      FROM  StorageList
      left join Warehouse w on StorageList.WarehouseID=w.WarehouseID
      WHERE StorageList.CargoTopType = 2
      AND StorageList.Quantity>0
      AND StorageList.EXPDate>CONVERT(varchar(10),GETDATE(),120)
      {1}
      GROUP BY 
      StorageList.CargoTypeID
      ,w.WarehouseName
      ) Stock

      LEFT JOIN
      (
      SELECT
      FlowPreOrderDetail.CargoTypeID
      ,ISNULL(SUM(FlowPreOrderDetail.PreOrderQty),0) AS PreOrderQty
      ,ISNULL(SUM(FlowPreOrderDetail.ProvidedQty),0) AS ProvidedQty
      FROM  FlowPreOrderDetail
      LEFT JOIN FlowPreOrder
      ON FlowPreOrderDetail.PreOrderID = FlowPreOrder.PreOrderID
      WHERE FlowPreOrderDetail.CargoTopType = 2 
      AND FlowPreOrderDetail.CheckStatus in (1,4)
      AND FlowPreOrderDetail.PreOrderQty - FlowPreOrderDetail.ProvidedQty > 0
      {2}
      GROUP BY 
      FlowPreOrderDetail.CargoTypeID
      ) PreOrder
      ON Stock.CargoTypeID = PreOrder.CargoTypeID
      ) --1 END

      SELECT CargoType.CargoTopType,CargoType.CargoTopTypeText,CargoType.CargoTypeKind,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeID,CargoType.CargoTypeText,WarehouseName,CargoType.Specification
      ,CargoType.Model,m.Name ManufacturerName
      ,ISNULL(StockQty,0) AS StockQty
      ,ISNULL(PreOrderQty,0) AS PreOrderQty
      ,ISNULL(ProvideQty,0) AS ProvideQty
      ,(ISNULL(PreOrderQty,0)-ISNULL(ProvideQty,0)) AS RequiredQty
      ,CargoType.MinUnit
      ,CargoType.Unit,CargoType.SynDataID
      FROM ProvideMaterials
      LEFT JOIN view_CargoType CargoType
      left join Manufacturer m on CargoType.ManufacturerID=m.ManufacturerID
      ON CargoType.CargoTypeID = ProvideMaterials.CargoTypeID
      WHERE 1 = 1 {0}

      ]]>
    </Content>
    <Content Key="Report_StorageDataSource" Desc="一次性物品库存统计" DataBaseType="Oracle">
      <![CDATA[
      WITH ProvideMaterials
      AS
      (
      SELECT 
      Stock.CargoTypeID
      ,Stock.StockQty
      ,PreOrder.PreOrderQty
      ,PreOrder.ProvidedQty as ProvideQty
      FROM
      (
      SELECT
      StorageList.CargoTypeID
      ,nvl(SUM(StorageList.Quantity),0) AS StockQty
      FROM  StorageList
      WHERE StorageList.CargoTopType = 2
      AND StorageList.Quantity>0
      AND StorageList.WarehouseID = :WarehouseID
      AND to_char(StorageList.EXPDate,'yyyy-mm-dd')>to_char(sysdate,'yyyy-mm-dd')
      GROUP BY 
      StorageList.CargoTypeID
      ) Stock

      LEFT JOIN
      (
      SELECT
      FlowPreOrderDetail.CargoTypeID
      ,nvl(SUM(FlowPreOrderDetail.PreOrderQty),0) AS PreOrderQty
      ,nvl(SUM(FlowPreOrderDetail.ProvidedQty),0) AS ProvidedQty
      FROM  FlowPreOrderDetail
      LEFT JOIN FlowPreOrder
      ON FlowPreOrderDetail.PreOrderID = FlowPreOrder.PreOrderID
      WHERE FlowPreOrderDetail.CargoTopType = 2 
      AND FlowPreOrderDetail.CheckStatus in (1,4)
      AND FlowPreOrder.OrgID = :DeptmentID
      AND FlowPreOrderDetail.PreOrderQty - FlowPreOrderDetail.ProvidedQty > 0
      GROUP BY 
      FlowPreOrderDetail.CargoTypeID
      ) PreOrder
      ON Stock.CargoTypeID = PreOrder.CargoTypeID
      ) --1 END

      SELECT CargoType.CargoTopType,CargoType.CargoTopTypeText,CargoType.CargoTypeKind,CargoType.CargoTypeKindText
      ,CargoType.CargoTypeID,CargoType.CargoTypeText
      ,nvl(StockQty,0) AS StockQty
      ,nvl(PreOrderQty,0) AS PreOrderQty
      ,nvl(ProvideQty,0) AS ProvideQty
      ,(nvl(PreOrderQty,0)-nvl(ProvideQty,0)) AS RequiredQty
      ,CargoType.MinUnit
      ,CargoType.Unit,CargoType.SynDataID
      FROM ProvideMaterials
      LEFT JOIN view_CargoType CargoType
      ON CargoType.CargoTypeID = ProvideMaterials.CargoTypeID
      WHERE 1 = 1 {0}
      ]]>
    </Content>
    <Content Key="Query_ClinicalProvideData" Desc="临床发放打印" DataBaseType="SqlServer">
      select a.FETCHID,b.FNames as NAME,c.FNames as RNAME ,org.Name  ORGNAME,a.FISPDADATA,l.LOCATIONNAME,COUNT(1) as FQTY,
      Case when a.FISPDADATA = 0 then '否' when a.FISPDADATA = 1 then '是' end as PDA
      ,a.FETCHDATE as ProvideDate,ct.CargoTypeName,sl.Barcode,ct.amount as Amount
      ,(ct.amount*COUNT(1)) as GroupPrice
      ,pt.PName as OutName,sl.SterilizeDate,sl.EXPDate
      from FlowFetch a
      inner join FlowFetchList t2 on t2.FetchID=a.FetchID
      inner join AC_WorkGroup b  on a.OPID = b.FID
      left join AC_WorkGroup c   on a.RECIPIENTID = c.FID
      left join Location l  on a.Locationid = l.Locationid
      left join AC_User au on au.ID=c.FID
      left join AC_OrgUser ou  on ou.UserID =au.ID
      left join AC_Org org on  org.ID =ou.OrgID

      left join FlowPackageList fpl on t2.PackageID=fpl.PackageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      left join StorageList sl on fpl.StorageID=sl.StorageID
      left join PackageType pt on fpl.PackageTypeID=pt.PTypeID
      where 1=1 {0}
      group by a.FETCHID,b.FNames,a.FETCHDATE,c.FNames ,a.FISPDADATA,l.LOCATIONNAME ,org.Name
      ,ct.CargoTypeName,sl.Barcode,ct.amount,pt.PName,sl.SterilizeDate,sl.EXPDate
    </Content>
    <Content Key="Query_ClinicalProvideData" Desc="临床发放打印" DataBaseType="Oracle">
      select a.FETCHID,b.FNames as NAME,c.FNames as RNAME ,org.Name  ORGNAME,a.FISPDADATA,l.LOCATIONNAME,COUNT(1) as FQTY,
      Case when a.FISPDADATA = 0 then '否' when a.FISPDADATA = 1 then '是' end as PDA
      ,a.FETCHDATE as ProvideDate,ct.CargoTypeName,sl.Barcode,ct.amount as Amount
      ,(ct.amount*COUNT(1)) as GroupPrice
      ,pt.PName as OutName,sl.SterilizeDate,sl.EXPDate
      from FlowFetch a
      inner join FlowFetchList t2 on t2.FetchID=a.FetchID
      inner join AC_WorkGroup b  on a.OPID = b.FID
      left join AC_WorkGroup c   on a.RECIPIENTID = c.FID
      left join Location l  on a.Locationid = l.Locationid
      left join AC_User au on au.ID=c.FID
      left join AC_OrgUser ou  on ou.UserID =au.ID
      left join AC_Org org on  org.ID =ou.OrgID

      left join FlowPackageList fpl on t2.PackageID=fpl.PackageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      left join StorageList sl on fpl.StorageID=sl.StorageID
      left join PackageType pt on fpl.PackageTypeID=pt.PTypeID
      where 1=1 {0}
      group by a.FETCHID,b.FNames,a.FETCHDATE,c.FNames ,a.FISPDADATA,l.LOCATIONNAME ,org.Name
      ,ct.CargoTypeName,sl.Barcode,ct.amount,pt.PName,sl.SterilizeDate,sl.EXPDate
    </Content>

    <Content Key="Query_ProvidePackageData" Desc="手术室器械追溯管理系统计" DataBaseType="SqlServer">
     <![CDATA[
       /*--名称(布包、器械)、供应室发放总数、手术室接收总数、清洗单价、成本合计
      、无菌库实际库存总数、无菌库发放数量(领取)、返还数量(存放)、手术间使用数量、实际使用清洗成本合计
      、其它、备注--*/
      select c.CargoTypeName,
      SUM(T.Quantity) as Quantity, --供应室发放总数
      SUM(T.ReceiveQuantity) as ReceiveQuantity,--手术室接收总数
      c.FDisinfectPrice,--清洗单价
      ISNULL(SUM(T.Quantity)*c.FCostPrice,0.00) as CostSum,--成本合计
      SUM(T.StorageQuantity) as StorageQuantity,--实际库存总数
      SUM(T.ProvideQuantity) as ProvideQuantity,--无菌库发放数量
      SUM(T.ReturnQuantity) as ReturnQuantity,--返还数量
      SUM(T.FlowUseQuantity) as FlowUseQuantity,--使用数量
      ISNULL(SUM(T.FlowUseQuantity)*c.FDisinfectPrice,0.00) DisinfectPriceSum,--实际使用清洗成本合计
      '' as Other,--其它
      '' as Remark --备注
      from
      (
      /*--供应室发放--*/
      select fp.OrgID as FlowOrgID,ct.CargoTypeID,COUNT(1)as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice from FlowProvideList fpl
      inner join FlowProvide fp on fpl.ProvideID=fp.ProvideID
      inner join FlowPackageList f on fpl.PackageID=f.PackageID
      inner join StorageList sl on f.StorageID=sl.StorageID
      left join CargoType ct on f.CargoTypeID=ct.CargoTypeID
      where 1=1 {0}
      group by ct.CargoTypeID,ct.FDisinfectPrice,fp.OrgID
      union all
      /*--手术室接收总数--*/
      select fp.OrgID as FlowOrgID,ct.CargoTypeID,0 as Quantity,COUNT(1) ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowProvideList fpl
      inner join FlowProvide fp on fpl.ProvideID=fp.ProvideID
      inner join FlowProvideConfirm fpc on fpl.ProvideConfirmID=fpc.ProvideConfirmID
      inner join FlowPackageList fl on fpl.PackageID=fl.PackageID
      left join CargoType ct on fl.CargoTypeID=ct.CargoTypeID
      where 1=1 {1}
      group by ct.CargoTypeID,ct.FDisinfectPrice,fp.OrgID
      union all
      /*--库存统计--*/
      select null as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,COUNT(1) StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowPackageList fpl
      inner join View_StorageList sl on fpl.StorageID=sl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      where Quantity>0 AND sl.WarehouseID = '96525293-F717-4408-98DC-3C5C2B36D806'
      AND ((ct.CargoTopType = 16 AND STATUS IN (40,50,60))-- 灭菌包 & 已发放
      OR ct.CargoTopType <> 16) and sl.EXPDate>=GETDATE()
      group by fpl.CargoTypeID,ct.FDisinfectPrice
      union all
      /*--无菌库发放(领取)--*/
      select ou.OrgID as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,COUNT(1) ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowFetch ff
      inner join FlowFetchList ffl on ff.FetchID=ffl.FetchID
      inner join FlowPackageList fpl on ffl.PackageID=fpl.PackageID
      inner join StorageList sl on fpl.StorageID=sl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      left join AC_OrgUser ou on ff.OPID=ou.UserID
      /*--begin--*/
      LEFT JOIN AC_WorkGroup WG ON FF.OPID=WG.FID
      LEFT JOIN AC_WorkGroup AW ON FF.RecipientID=AW.FID
      LEFT JOIN AC_OrgUser on AC_OrgUser.UserID =AW .FID
      LEFT JOIN AC_Org on AC_Org .ID =AC_OrgUser .OrgID
      LEFT JOIN Location L ON FF.LocationID=L.LocationID
      LEFT JOIN Location L1 ON FPL.lastLocationID=L1.LocationID
      left join FlowRecycleList frl on fpl.PackageID= frl.PackageID
      left join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
      /*--end--*/
      where ff.FetchType=0 {2}
      group by fpl.CargoTypeID,ct.FDisinfectPrice,ou.OrgID
      ,CONVERT(varchar(30),fr.RecycleDate,111)
      union all
      /*--返还数量(存放)--*/
      select ou.OrgID as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,COUNT(1) ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowFetch ff
      inner join FlowFetchList ffl on ff.FetchID=ffl.FetchID
      inner join FlowPackageList fpl on ffl.PackageID=fpl.PackageID
      inner join StorageList sl on fpl.StorageID=sl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      left join AC_OrgUser ou on ff.OPID=ou.UserID
      where ff.FetchType=1 {2}
      group by fpl.CargoTypeID,ct.FDisinfectPrice,ou.OrgID
      /*--使用数量--*/
      union all
      select fu.OrgID as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      COUNT(ful.Quantity) FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowUse fu
      inner join FlowUseList ful on fu.UseID=ful.UseID
      inner join StorageList sl on ful.StorageID=sl.StorageID
      inner join FlowPackageList fpl on sl.StorageID=fpl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      where 1=1 {3}
      group by fpl.CargoTypeID,ct.FDisinfectPrice,fu.OrgID
      )T
      left join CargoType c on T.CargoTypeID=c.CargoTypeID
      where 1=1 {4}
      group by c.CargoTypeName,c.FDisinfectPrice,c.FCostPrice
     ]]>
    </Content>
    <Content Key="Query_ProvidePackageData" Desc="手术室器械追溯管理系统计" DataBaseType="Oracle">
      /*--名称(布包、器械)、供应室发放总数、手术室接收总数、清洗单价、成本合计
      、无菌库实际库存总数、无菌库发放数量(领取)、返还数量(存放)、手术间使用数量、实际使用清洗成本合计
      、其它、备注--*/
      select c.CargoTypeName,
      SUM(T.Quantity) as Quantity, --供应室发放总数
      SUM(T.ReceiveQuantity) as ReceiveQuantity,--手术室接收总数
      c.FDisinfectPrice,--清洗单价
      nvl(SUM(T.Quantity)*c.FCostPrice,0.00) as CostSum,--成本合计
      SUM(T.StorageQuantity) as StorageQuantity,--实际库存总数
      SUM(T.ProvideQuantity) as ProvideQuantity,--无菌库发放数量
      SUM(T.ReturnQuantity) as ReturnQuantity,--返还数量
      SUM(T.FlowUseQuantity) as FlowUseQuantity,--使用数量
      nvl(SUM(T.FlowUseQuantity)*c.FDisinfectPrice,0.00) DisinfectPriceSum,--实际使用清洗成本合计
      '' as Other,--其它
      '' as Remark --备注
      from
      (
      /*--供应室发放--*/
      select fp.FlowOrgID as FlowOrgID,ct.CargoTypeID,COUNT(1)as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice from FlowProvideList fpl
      inner join FlowProvide fp on fpl.ProvideID=fp.ProvideID
      inner join FlowPackageList f on fpl.PackageID=f.PackageID
      inner join StorageList sl on f.StorageID=sl.StorageID
      left join CargoType ct on f.CargoTypeID=ct.CargoTypeID
      where 1=1 {0}
      group by ct.CargoTypeID,ct.FDisinfectPrice,fp.FlowOrgID
      union all
      /*--手术室接收总数--*/
      select fp.OrgID as FlowOrgID,ct.CargoTypeID,0 as Quantity,COUNT(1) ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowProvideList fpl
      inner join FlowProvide fp on fpl.ProvideID=fp.ProvideID
      inner join FlowProvideConfirm fpc on fpl.ProvideConfirmID=fpc.ProvideConfirmID
      inner join FlowPackageList fl on fpl.PackageID=fl.PackageID
      left join CargoType ct on fl.CargoTypeID=ct.CargoTypeID
      where 1=1 {1}
      group by ct.CargoTypeID,ct.FDisinfectPrice,fp.OrgID
      union all
      /*--库存统计--*/
      select null as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,COUNT(1) StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowPackageList fpl
      inner join StorageList sl on fpl.StorageID=sl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      where sl.Status in(50,60) and sl.CargoTopType=16
      group by fpl.CargoTypeID,ct.FDisinfectPrice
      union all
      /*--无菌库发放(领取)--*/
      select ou.OrgID as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,COUNT(1) ProvideQuantity,0 ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowFetch ff
      inner join FlowFetchList ffl on ff.FetchID=ffl.FetchID
      inner join FlowPackageList fpl on ffl.PackageID=fpl.PackageID
      inner join StorageList sl on fpl.StorageID=sl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      left join AC_OrgUser ou on ff.RecipientID=ou.OrgID
      where ff.FetchType=0 {2}
      group by fpl.CargoTypeID,ct.FDisinfectPrice,ou.OrgID
      union all
      /*--返还数量(存放)--*/
      select ou.OrgID as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,COUNT(1) ReturnQuantity,
      0 FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowFetch ff
      inner join FlowFetchList ffl on ff.FetchID=ffl.FetchID
      inner join FlowPackageList fpl on ffl.PackageID=fpl.PackageID
      inner join StorageList sl on fpl.StorageID=sl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      left join AC_OrgUser ou on ff.OPID=ou.OrgID
      where ff.FetchType=1 {2}
      group by fpl.CargoTypeID,ct.FDisinfectPrice,ou.OrgID
      /*--使用数量--*/
      union all
      select fu.OrgID as FlowOrgID,fpl.CargoTypeID,0 as Quantity,0 ReceiveQuantity,ct.FDisinfectPrice,
      0 CostSum,0 StorageQuantity,0 ProvideQuantity,0 ReturnQuantity,
      COUNT(ful.Quantity) FlowUseQuantity,0 FlowUseDisinfectPrice
      from FlowUse fu
      inner join FlowUseList ful on fu.UseID=ful.UseID
      inner join StorageList sl on ful.StorageID=sl.StorageID
      inner join FlowPackageList fpl on sl.StorageID=fpl.StorageID
      left join CargoType ct on fpl.CargoTypeID=ct.CargoTypeID
      where 1=1 {3}
      group by fpl.CargoTypeID,ct.FDisinfectPrice,fu.OrgID
      )T
      left join CargoType c on T.CargoTypeID=c.CargoTypeID
      where 1=1 {4}
      group by c.CargoTypeName,c.FDisinfectPrice,c.FCostPrice
      having SUM(T.Quantity)>0
    </Content>
    <Content Key="Query_ClinicalStorageData" Desc="临床入库统计" DataBaseType="SqlServer">

      select a.FETCHID,b.FNames as NAME,a.FETCHDATE,c.FNames as RNAME ,org.Name  ORGNAME,a.FISPDADATA,l.LOCATIONNAME,COUNT(1) as FQTY,
      Case when a.FISPDADATA = 0 then '否' when a.FISPDADATA = 1 then '是' end as PDA
      ,ct.CargoTypeName
      from FlowFetch a
      inner join FlowFetchList t2 on t2.FetchID=a.FetchID
      left join FlowPackageList fpl on t2.PackageID=fpl.PackageID
      left join CargoType ct  on fpl.CargoTypeID = ct.CargoTypeID
      left join  Storagelist sl  on sl.StorageID = fpl.StorageID
      inner join AC_WorkGroup b  on a.OPID = b.FID
      left join AC_WorkGroup c   on a.RECIPIENTID = c.FID
      left join Location l  on a.Locationid = l.Locationid
      left join AC_User au on au.ID=c.FID
      left join AC_OrgUser ou  on ou.UserID =au.ID
      left join AC_Org org on  org.ID =ou.OrgID
      where 1=1 {0}
      group by a.FETCHID,b.FNames,a.FETCHDATE,c.FNames ,a.FISPDADATA,l.LOCATIONNAME ,org.Name
      ,ct.CargoTypeName
    </Content>
    <Content Key="Query_ClinicalStorageData" Desc="临床入库统计" DataBaseType="Oracle">
    </Content>
    <Content Key="Report_PreOrderProvideRecycleDataSource" Desc="科室预订综合报表" DataBaseType="SqlServer">
      WITH PreOrder(
      PROVIDEAREATEXT
      ,CARGOTOPTYPETEXT    --种类
      ,CARGOTYPEKINDTEXT   --类别
      ,CARGOTYPETEXT       --无菌物品、器械包
      ,CARGOTYPEID
      ,APPLYQTY            --申请数量
      ,PROVIDEQTY          --发放数量
      ,RECYCLEQTY          --回收数量
      ,CHECKSTATUS)
      AS
      ( --1
      SELECT
      ApplyQ.Name AS PROVIDEAREATEXT
      ,ApplyQ.CargoTopTypeText AS CARGOTOPTYPETEXT   --种类
      ,ApplyQ.CargoTypeKindText AS CARGOTYPEKINDTEXT --类别
      ,ApplyQ.CargoTypeText AS CARGOTYPETEXT         --无菌物品、器械包
      ,ApplyQ.CargoTypeID AS CARGOTYPEID
      ,ApplyQ.ApplyQty AS APPLYQTY                   --申请数量
      ,Provide.ProvideQty AS PROVIDEQTY              --发放数量
      ,recycle.RECYCLEQTY as RECYCLEQTY              --回收数量
      ,ApplyQ.CheckStatus AS CHECKSTATUS
      FROM
      (
      SELECT    --预订信息
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,FD.CargoTypeID
      ,isnull(SUM(PreOrderQty),0) ApplyQty  -- 申请数量
      ,FO.CheckStatus
      FROM FlowPreOrder FO
      INNER JOIN FlowPreOrderDetail FD ON FO.PreOrderID = FD.PreOrderID
      LEFT JOIN view_CargoType CT  ON FD.CargoTypeID = CT.CargoTypeID
      LEFT JOIN AC_Org  AO  ON AO.ID = FO.OrgID
      where 1=1 and FO.CheckStatus not in(2,3) {0}
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,FD.CargoTypeID,FO.CheckStatus
      ) ApplyQ
      left join
      (
      select         --发放信息
      AO.Name
      ,CT.CargoTopTypeText  --种类
      ,CT.CargoTypeKindText --类别
      ,CT.CargoTypeText     --无菌物品、器械包
      ,CT.CargoTypeID
      ,isnull(SUM(SL.Quantity),0) ProvideQty  -- 发放数量
      FROM FlowProvide FP
      INNER JOIN FlowProvideList FL ON FP.ProvideID=FL.ProvideID
      INNER JOIN FlowPackageList PA ON FL.PackageID=PA.PackageID
      INNER JOIN StorageList SL ON PA.StorageID=SL.StorageID
      LEFT JOIN view_CargoType CT ON SL.CargoTypeID=CT.CargoTypeID
      LEFT JOIN AC_Org AO ON FP.OrgID=AO.ID
      where 1=1 {1}
      GROUP BY AO.Name,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,CT.CargoTypeID
      ) Provide
      ON ApplyQ.CargoTypeID = Provide.CargoTypeID and ApplyQ.NAME = Provide.NAME
      left join
      (
      select  --回收信息
      RecycleOrg.Name
      ,CargoType.CargoTypeName AS CARGOTYPETEXT
      ,SUM(StorageList.Quantity) as RECYCLEQTY
      ,CargoType.CargoTypeID
      ,CargoType.CargoTypeName
      FROM FlowRecycleList
      INNER JOIN FlowRecycle ON FlowRecycle.FRecycleID = FlowRecycleList.FRecycleID
      INNER JOIN FlowPackageList ON FlowRecycleList.PackageID = FlowPackageList.PackageID
      left join FlowPackageIn fpi on FlowPackageList.FPackageID=fpi.FPackageID
      INNER JOIN CargoType ON FlowPackageList.CargoTypeID = CargoType.CargoTypeID
      INNER JOIN CargoTypeKind CK ON CargoType.CargoTypeKind = CK.ID
      INNER JOIN SystemTypeParameter CST ON CargoType.CargoTopType = CST.TypeValue AND CST.TypeKey = 'CargoTopType'
      INNER JOIN StorageList ON FlowPackageList.StorageID = StorageList.StorageID
      LEFT JOIN Warehouse ON StorageList.WarehouseID = Warehouse.WarehouseID
      LEFT JOIN AC_Org AS RecycleOrg ON Warehouse.OrgID = RecycleOrg.ID
      LEFT JOIN AC_WorkGroup AS RecycleUser ON FlowRecycle.OPID = RecycleUser.FID
      LEFT JOIN AC_WorkGroup AS SenderUser  ON FlowRecycle.SENDERID = SenderUser.FID
      where 1=1 {2}
      group by CargoType.CargoTypeName ,CargoType.CargoTypeID,RecycleOrg.Name
      )recycle
      on ApplyQ.CargoTypeID=recycle.CargoTypeID and recycle.Name=Provide.Name
      )
      SELECT
      PROVIDEAREATEXT
      ,CT.CARGOTOPTYPETEXT
      ,CT.CARGOTYPEKINDTEXT
      ,CT.CARGOTYPETEXT
      ,CT.CARGOTYPEID
      ,isnull(APPLYQTY,0) APPLYQTY
      ,isnull(PROVIDEQTY,0) PROVIDEQTY
      ,isnull(RECYCLEQTY,0) as RECYCLEQTY
      FROM PreOrder
      left JOIN view_CargoType CT ON CT.CargoTypeID=PreOrder.CARGOTYPEID
      WHERE 1=1 {3}
      GROUP BY PROVIDEAREATEXT,CT.CargoTopTypeText,CT.CargoTypeKindText,CT.CargoTypeText,CT.CargoTypeID,
      APPLYQTY,PROVIDEQTY,RECYCLEQTY
      ORDER BY PROVIDEAREATEXT,CT.CargoTypeText
    </Content>
    <Content Key="ReportProvideHighMaterialSummary" Desc="高值耗材报表" DataBaseType="SqlServer">
      select
      ao.Name ORGNAME,so.OutDate as OUTDATE,ct.CargoTypeName as CARGOTYPENAME
      ,isnull(ct.amount,0.0000) as AMOUNT,sol.Quantity as QUANTITY,
      isnull(ct.amount*sol.Quantity,0.0000) as SUMQUANTITY
      ,sl.LotNumber as LOTNUMBER,ct.MinUnit as MINUNIT,ct.Unit as UNIT
      ,ctk.KindName as KINDNAME
      FROM StorageOut so
      inner join AC_Org ao ON ao.ID=so.OrgID
      inner join AC_WorkGroup au ON au.FID=so.OPID
      left join AC_WorkGroup ac on ac.FID = so.RecipientID
      inner join  StorageOutList sol on so.OutID=sol.OutID
      Left join StorageList sl on sl.StorageID = sol.StorageID
      inner join CargoType ct on ct.CargoTypeID=sol.CargoTypeID
      left join CargoTypeKind ctk on ct.CargoTypeKind=ctk.ID
      left join AC_WorkGroup wg on so.OPID=wg.FID
      left join AC_WorkGroup wg1 on so.RecipientID=wg1.FID
      where so.OutType=6 {0}
    </Content>
    <Content Key="ReportProvideHighMaterialSummary" Desc="高值耗材报表" DataBaseType="Oracle">
      select
      ao.Name ORGNAME,so.OutDate as OUTDATE,ct.CargoTypeName as CARGOTYPENAME
      ,isnull(ct.amount,0.0000) as AMOUNT,sol.Quantity as QUANTITY,
      isnull(ct.amount*sol.Quantity,0.0000) as SUMQUANTITY
      ,sl.LotNumber as LOTNUMBER,ct.MinUnit as MINUNIT,ct.Unit as UNIT
      ,ctk.KindName as KINDNAME
      FROM StorageOut so
      inner join AC_Org ao ON ao.ID=so.OrgID
      inner join AC_WorkGroup au ON au.FID=so.OPID
      left join AC_WorkGroup ac on ac.FID = so.RecipientID
      inner join  StorageOutList sol on so.OutID=sol.OutID
      Left join StorageList sl on sl.StorageID = sol.StorageID
      inner join CargoType ct on ct.CargoTypeID=sol.CargoTypeID
      left join CargoTypeKind ctk on ct.CargoTypeKind=ctk.ID
      left join AC_WorkGroup wg on so.OPID=wg.FID
      left join AC_WorkGroup wg1 on so.RecipientID=wg1.FID
      where so.OutType=6 {0}
    </Content>

    <Content Key="Print_PackageDetailPrintDataGD" Desc="包组成" DataBaseType="SqlServer">
      <![CDATA[
           /*--select 
        '其它' as KINDNAME,
        t2.CargoTypeName CARGOTYPENAMEC,NONUMBER=Row_Number() OVER(ORDER BY PackageSetting.CargoTopType,PackageSetting.FOrder), 
        CargoType.CargoTypeName as CARGOTYPENAME,
        CargoType.Specification as SPECIFICATION,
        CargoType.Model as MODEL,
        CargoType.Remark as REMARK,
        FlowPackageCargoList.Quantity / FlowPackage.Quantity as QUANTITY,
        IsNull(t2.IsPrintContents,0) IsPrintContents
        ,u.FNames AS PACKAGER,cu.FNames as CHECKER
        ,con.BarCode as CONTAINERBARCODE
        from FlowPackageList inner join StorageList on FlowPackageList.StorageID = StorageList.StorageID
        inner join FlowPackageCargoList on FlowPackageList.FPackageID = FlowPackageCargoList.FPackageID
        inner join FlowPackage on FlowPackage.FPackageID = FlowPackageCargoList.FPackageID
        inner join PackageSetting on (FlowPackageCargoList.CargoTypeID = PackageSetting.CargoTypeID and FlowPackageList.CargoTypeID = PackageSetting.PackageTypeID)
        inner join CargoType on FlowPackageCargoList.CargoTypeID = CargoType.CargoTypeID
        inner join CargoType t2 On t2.CargoTypeID=PackageSetting.PackageTypeID
        inner join CargoTypeKind ctk on t2.CargoTypeKind=ctk.ID
        inner join AC_WorkGroup u    on FlowPackage.opid = u.FID
        left join AC_WorkGroup cu  on FlowPackageList.checkid = cu.FID
        left join Container con on FlowPackageList.ContainerID=con.ContainerID
        where StorageList.Barcode =@barcode
        and CargoType.CargoTopType<>1
        union all--*/
        select 
        '器械类' as KINDNAME,
        t2.CargoTypeName CARGOTYPENAMEC,NONUMBER=Row_Number() OVER(ORDER BY PackageSetting.CargoTopType,PackageSetting.FOrder), 
        CargoType.OfficialName as CARGOTYPENAME,
        CargoType.Specification as SPECIFICATION,
        CargoType.Model as MODEL,
        fpr.Remark as REMARK,
        FlowPackageCargoList.Quantity / FlowPackage.Quantity as QUANTITY,
        IsNull(t2.IsPrintContents,0) IsPrintContents
        ,u.FNames AS PACKAGER,cu.FNames as CHECKER
        ,con.BarCode as CONTAINERBARCODE
        from FlowPackageList inner join StorageList on FlowPackageList.StorageID = StorageList.StorageID
        inner join FlowPackageCargoList on FlowPackageList.FPackageID = FlowPackageCargoList.FPackageID
        inner join FlowPackage on FlowPackage.FPackageID = FlowPackageCargoList.FPackageID
        inner join PackageSetting on (FlowPackageCargoList.CargoTypeID = PackageSetting.CargoTypeID and FlowPackageList.CargoTypeID = PackageSetting.PackageTypeID)
        inner join CargoType on FlowPackageCargoList.CargoTypeID = CargoType.CargoTypeID
        inner join CargoType t2 On t2.CargoTypeID=PackageSetting.PackageTypeID
        inner join CargoTypeKind ctk on t2.CargoTypeKind=ctk.ID
        inner join AC_WorkGroup u    on FlowPackage.opid = u.FID
        left join AC_WorkGroup cu  on FlowPackageList.checkid = cu.FID
        left join Container con on FlowPackageList.ContainerID=con.ContainerID
        left join FlowPackageRemark fpr on fpr.FPackageID=FlowPackage.FPackageID and fpr.CargoTypeID=CargoType.CargoTypeID
        where StorageList.Barcode = @barcode
        and CargoType.CargoTopType=1
     ]]>
    </Content>

    <Content Key="Print_PackageDetailPrintDataGD" Desc="包组成" DataBaseType="Oracle">
      <![CDATA[
        /*--select 
        '其它' as KINDNAME,
        t2.CargoTypeName CARGOTYPENAMEC,Row_Number() OVER(ORDER BY PackageSetting.CargoTopType,PackageSetting.FOrder) NONUMBER, 
        CargoType.CargoTypeName as CARGOTYPENAME,
        CargoType.Specification as SPECIFICATION,
        CargoType.Model as MODEL,
        fpr.Remark as REMARK,
        FlowPackageCargoList.Quantity / FlowPackage.Quantity as QUANTITY,
        nvl(t2.IsPrintContents,0) IsPrintContents
        ,u.FNames AS PACKAGER,cu.FNames as CHECKER
        ,con.BarCode as CONTAINERBARCODE
        from FlowPackageList inner join StorageList on FlowPackageList.StorageID = StorageList.StorageID
        inner join FlowPackageCargoList on FlowPackageList.FPackageID = FlowPackageCargoList.FPackageID
        inner join FlowPackage on FlowPackage.FPackageID = FlowPackageCargoList.FPackageID
        inner join PackageSetting on (FlowPackageCargoList.CargoTypeID = PackageSetting.CargoTypeID and FlowPackageList.CargoTypeID = PackageSetting.PackageTypeID)
        inner join CargoType on FlowPackageCargoList.CargoTypeID = CargoType.CargoTypeID
        inner join CargoType t2 On t2.CargoTypeID=PackageSetting.PackageTypeID
        inner join CargoTypeKind ctk on t2.CargoTypeKind=ctk.ID
        inner join AC_WorkGroup u    on FlowPackage.opid = u.FID
        left join AC_WorkGroup cu  on FlowPackageList.checkid = cu.FID
        left join Container con on FlowPackageList.ContainerID=con.ContainerID
        where StorageList.Barcode = :barcode
        and CargoType.CargoTopType<>1
        union all--*/
        select 
        '器械类' as KINDNAME,
        t2.CargoTypeName CARGOTYPENAMEC,Row_Number() OVER(ORDER BY PackageSetting.CargoTopType,PackageSetting.FOrder) NONUMBER, 
        CargoType.OfficialName as CARGOTYPENAME,
        CargoType.Specification as SPECIFICATION,
        CargoType.Model as MODEL,
        fpr.Remark as REMARK,
        FlowPackageCargoList.Quantity / FlowPackage.Quantity as QUANTITY,
        nvl(t2.IsPrintContents,0) IsPrintContents
        ,u.FNames AS PACKAGER,cu.FNames as CHECKER
        ,con.BarCode as CONTAINERBARCODE
        from FlowPackageList inner join StorageList on FlowPackageList.StorageID = StorageList.StorageID
        inner join FlowPackageCargoList on FlowPackageList.FPackageID = FlowPackageCargoList.FPackageID
        inner join FlowPackage on FlowPackage.FPackageID = FlowPackageCargoList.FPackageID
        inner join PackageSetting on (FlowPackageCargoList.CargoTypeID = PackageSetting.CargoTypeID and FlowPackageList.CargoTypeID = PackageSetting.PackageTypeID)
        inner join CargoType on FlowPackageCargoList.CargoTypeID = CargoType.CargoTypeID
        inner join CargoType t2 On t2.CargoTypeID=PackageSetting.PackageTypeID
        inner join CargoTypeKind ctk on t2.CargoTypeKind=ctk.ID
        inner join AC_WorkGroup u    on FlowPackage.opid = u.FID
        left join AC_WorkGroup cu  on FlowPackageList.checkid = cu.FID
        left join Container con on FlowPackageList.ContainerID=con.ContainerID
        left join FlowPackageRemark fpr on fpr.FPackageID=FlowPackage.FPackageID and fpr.CargoTypeID=CargoType.CargoTypeID
        where StorageList.Barcode = :barcode
        and CargoType.CargoTopType=1
     ]]>
    </Content>
    <Content Key="Print_PackageDetailPrintDataByIDGD" Desc="包组成" DataBaseType="SqlServer">
      <![CDATA[
         Select P.PACKAGESETTINGID
         ,P.CARGOTYPENAME as CARGOTYPENAMECC
      ,P.PACKAGETYPEID
      ,P.CARGOTYPEID
      ,c.OfficialName as CARGOTYPENAME 
      ,Cargotype.Cargotypename as CARGOTYPENAMEC
      ,c.CargoTypeName as CARGOTYPENAMEQX
         ,Row_Number() OVER(order by p.CARGOTOPTYPE,p.FOrder) as NONUMBER
      ,P.CARGOTOPTYPE
      ,P.QUANTITY
      ,P.ISTRACK,
      p.ISDYNAMIC
      ,CASE WHEN P.ISTRACK = 1 THEN 0 ELSE P.QUANTITY END AS COUNTER
      ,P.FORDER
      ,ISNULL(p.IsLightChecks,0) AS IsLightChecks
      ,c.OfficialName as OFFICIALNAME
      ,c.Specification as SPECIFICATION
      ,c.Model as MODEL
      ,c.Remark as REMARK
      ,0 as EDITQUANTITY
      FROM PACKAGESETTING P    
      INNER JOIN CARGOTYPE C     ON P.CARGOTYPEID = C.CARGOTYPEID 
      left join Cargotype on p.PACKAGETYPEID=Cargotype.Cargotypeid
      WHERE P.PACKAGETYPEID=@CargoTypeID
      and P.CARGOTOPTYPE=1
      order by p.CARGOTOPTYPE,p.FOrder
     ]]>
    </Content>
    <Content Key="Print_PackageDetailPrintDataByIDGD" Desc="包组成" DataBaseType="Oracle">
      <![CDATA[
           Select P.PACKAGESETTINGID
        ,P.CARGOTYPENAME as CARGOTYPENAMECC
      ,P.PACKAGETYPEID
      ,P.CARGOTYPEID
      ,c.OfficialName as CARGOTYPENAME
      ,Cargotype.Cargotypename as CARGOTYPENAMEC
      ,c.CargoTypeName as CARGOTYPENAMEQX
      ,Row_Number() OVER(order by p.CARGOTOPTYPE,p.FOrder) as NONUMBER
      ,P.CARGOTOPTYPE
      ,P.QUANTITY
      ,P.ISTRACK,
      p.ISDYNAMIC
      ,CASE WHEN P.ISTRACK = 1 THEN 0 ELSE P.QUANTITY END AS COUNTER
      ,P.FORDER
      ,nvl(p.IsLightChecks,0) AS IsLightChecks
      ,c.OfficialName as OFFICIALNAME
      ,c.Specification as SPECIFICATION
      ,c.Model as MODEL
      ,c.Remark as REMARK
      ,0 as EDITQUANTITY
      FROM PACKAGESETTING P    
      INNER JOIN CARGOTYPE C     ON P.CARGOTYPEID = C.CARGOTYPEID 
      left join Cargotype on p.PACKAGETYPEID=Cargotype.Cargotypeid
      WHERE P.PACKAGETYPEID=:CargoTypeID
      and P.CARGOTOPTYPE=1
      order by p.CARGOTOPTYPE,p.FOrder
     ]]>
    </Content>
    <Content Key="Report_RecycleLostListDataSourceReport" Desc="器械丢失报埙统计" DataBaseType="SqlServer">
      <![CDATA[
        select 
        ct.CargoTypeName,  --名称
        ct.Specification,  --规格
        ct.amount as Amount,         --单价
        isnull(d.Quantity,0) as InitialQuantity, --期初数量
        ((ISNULL(b.StockQuantity,0)+a.LotQuantity)-ISNULL(c.StorageInQuantity,0))*ct.amount as InitialAmount,--期末金额
        ISNULL(c.StorageInQuantity,0) as StorageInQuantity, --入库数量
        ISNULL(c.StorageInQuantity,0)*ct.amount as StorageInAmount,   --收入金额
        a.LotQuantity,    --支出数量
        a.LotQuantity*ct.amount as LotAmount,  --支出金额
        ISNULL(b.StockQuantity,0) as StockQuantity,   --期末数量
        ISNULL(b.StockQuantity,0)*ct.amount as StockAmount --期末金额
        ,ctk.KindName
        from 
        (
            /*--器械丢失，坏埙数量--*/
	        select 
	        ct.CargoTypeID,ct.CargoTypeName
	        ,sum(frl.Quantity) as LotQuantity
	        --,case when frl.RegisterType=1 then '器械丢失' else '器械坏埙' end as RegisterType
	        from FlowRecycleLostList frl
	        inner join FlowRecycle fr on frl.FRecycleID=fr.FRecycleID
	        inner join CargoType ct on frl.CargoTypeID=ct.CargoTypeID
	        where 1=1 {0}
	        --fr.RecycleDate>='2014-10-16'
	        --and fr.RecycleDate<'2014-10-17'
	        group by ct.CargoTypeID,ct.CargoTypeName
        )a
        left join 
        (
	        /*--期末库存 CSSD暂存库--*/
            select  
	        StorageList.CargoTypeID,ct.CargoTypeName
	        ,ISNULL(SUM(cast(StorageList.Quantity as bigint)),0) AS StockQuantity
	        FROM  StorageList
	        inner join CargoType ct on StorageList.CargoTypeID=ct.CargoTypeID
	        inner join AC_Org o on StorageList.WarehouseID=o.InstrumentTempWarehouseID
	        left join Warehouse w on StorageList.WarehouseID=w.WarehouseID
	        WHERE StorageList.CargoTopType = 1
	        and StorageList.Quantity>0
	        and StorageList.Status=10 
	        and w.WarehouseName like '%暂存库%'
	        GROUP BY
	        StorageList.CargoTypeID
	        ,ct.CargoTypeName
        ) b on a.CargoTypeID=b.CargoTypeID
        left join 
        (
           /*--入库数量--*/
           select ct.CargoTypeID,ct.CargoTypeName
           ,SUM(sl.Quantity) as StorageInQuantity
           from StorageIn si
           inner join StorageList sl on si.InID=sl.InID
           inner join CargoType ct on sl.CargoTypeID=ct.CargoTypeID
           inner join Warehouse w on sl.WarehouseID=w.WarehouseID
           where sl.CargoTopType=1 and w.WarehouseName like '%暂存库%'
           {1}
           --and si.InDate>='2014-10-16'
           --and si.InDate<'2014-10-17' 
           group by ct.CargoTypeID,ct.CargoTypeName
        )c on a.CargoTypeID=c.CargoTypeID
        left join 
        (
			  /*--期初数量--*/
			  select CargoTypeID,Quantity from StockCheckList
			  where CheckID =(select top 1 CheckID from StockCheck order by CheckDate desc)
        )d on a.CargoTypeID=d.CargoTypeID
        inner join CargoType ct on a.CargoTypeID=ct.CargoTypeID
        left join CargoTypeKind ctk on ct.CargoTypeKind=ctk.ID
        where 1=1 {2} 
        --ctk.KindName='镊子'
        --and ct.CargoTypeID=''
     ]]>
    </Content>

    <Content Key="Query_PreOrderMergeOrgDataSource" DataBaseType="SqlServer">
      SELECT
      FLOWPREORDERDETAIL.*
      , CargoType.CargoTopTypeText
      , CargoType.CARGOTYPEText
      , CargoType.CARGOTYPEKindText
      , CargoType.MINUNIT
      , CargoType.UNIT
      , aog.Name
      ,fpo.RequiredDate
      ,ISNULL(CargoType.AMOUNT,0) AMOUNT,ISNULL(CargoType.AMOUNT*PreOrderQty,0) GroupPrice
      ,CheckStatus.TypeName  CheckStatusName
      FROM FLOWPREORDERDETAIL  WITH (NOLOCK)
      LEFT JOIN view_CargoType AS CargoType
      ON FLOWPREORDERDETAIL.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN SystemTypeParameter CheckStatus on(CheckStatus.TypeKey='PreOrderCheck' and FLOWPREORDERDETAIL.CheckStatus=CheckStatus.TypeValue)
      left join FlowPreOrder fpo on fpo.PreOrderID = FLOWPREORDERDETAIL.PreOrderID
      left join AC_Org aog on aog.ID=fpo.OrgID
      where 1=1 {0}
      ORDER BY CargoTopTypeText,CARGOTYPEKindText,CARGOTYPEText,aog.Name;
    </Content>
    <Content Key="Query_PreOrderMergeOrgDataSource" DataBaseType="Oracle">
      SELECT
      FLOWPREORDERDETAIL.*
      , CargoType.CargoTopTypeText
      , CargoType.CARGOTYPEText
      , CargoType.CARGOTYPEKindText
      , CargoType.MINUNIT
      , CargoType.UNIT
      , aog.Name
      ,fpo.RequiredDate
      ,nvl(CargoType.AMOUNT,0) AMOUNT,nvl(CargoType.AMOUNT*PreOrderQty,0) GroupPrice
      ,CheckStatus.TypeName  CheckStatusName
      FROM FLOWPREORDERDETAIL  
      LEFT JOIN view_CargoType  CargoType
      ON FLOWPREORDERDETAIL.CargoTypeID = CargoType.CargoTypeID
      LEFT JOIN SystemTypeParameter CheckStatus on(CheckStatus.TypeKey='PreOrderCheck' and FLOWPREORDERDETAIL.CheckStatus=CheckStatus.TypeValue)
      left join FlowPreOrder fpo on fpo.PreOrderID = FLOWPREORDERDETAIL.PreOrderID
      left join AC_Org aog on aog.ID=fpo.OrgID
      where 1=1 {0}
      ORDER BY CargoTopTypeText,CARGOTYPEKindText,CARGOTYPEText,aog.Name;
    </Content>
  </Contents>
</SqlConfig>
